"use strict";var t=require("obsidian");function e(t,e,i,o){return new(i||(i=Promise))((function(n,s){function a(t){try{l(o.next(t))}catch(t){s(t)}}function r(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((o=o.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const i=["Custom","editingToolbar","editingToolbarSub","editingToolbarAdd","editingToolbarDelete","editingToolbarReload","codeblock-glyph","underline-glyph","superscript-glyph","subscript-glyph","bot-glyph","header-1","header-2","header-3","header-4","header-5","header-6","header-n","obsidian","obsidian-new","accessibility","activity","air-vent","airplay","alarm-check","alarm-clock-off","alarm-clock","alarm-minus","alarm-plus","album","alert-circle","alert-octagon","alert-triangle","align-center-horizontal","align-center-vertical","align-center","align-end-horizontal","align-end-vertical","align-horizontal-distribute-center","align-horizontal-distribute-end","align-horizontal-distribute-start","align-horizontal-justify-center","align-horizontal-justify-end","align-horizontal-justify-start","align-horizontal-space-around","align-horizontal-space-between","align-justify","align-left","align-right","align-start-horizontal","align-start-vertical","align-vertical-distribute-center","align-vertical-distribute-end","align-vertical-distribute-start","align-vertical-justify-center","align-vertical-justify-end","align-vertical-justify-start","align-vertical-space-around","align-vertical-space-between","anchor","angry","annoyed","aperture","apple","archive-restore","archive","armchair","arrow-big-down","arrow-big-left","arrow-big-right","arrow-big-up","arrow-down-circle","arrow-down-left","arrow-down-right","arrow-down","arrow-left-circle","arrow-left-right","arrow-left","arrow-right-circle","arrow-right","arrow-up-circle","arrow-up-left","arrow-up-right","arrow-up","asterisk","at-sign","award","axe","axis-3d","baby","backpack","baggage-claim","banana","banknote","bar-chart-2","bar-chart-3","bar-chart-4","bar-chart-horizontal","bar-chart","baseline","bath","battery-charging","battery-full","battery-low","battery-medium","battery","beaker","bed-double","bed-single","bed","beer","bell-minus","bell-off","bell-plus","bell-ring","bell","bike","binary","bitcoin","bluetooth-connected","bluetooth-off","bluetooth-searching","bluetooth","bold","bomb","bone","book-open","book","bookmark-minus","bookmark-plus","bookmark","bot","box-select","box","boxes","briefcase","brush","bug","building-2","building","bus","cake","calculator","calendar-check-2","calendar-check","calendar-clock","calendar-days","calendar-heart","calendar-minus","calendar-off","calendar-plus","calendar-range","calendar-search","calendar-x2","calendar-x","calendar","camera-off","camera","car","carrot","cast","check-circle-2","check-circle","check-square","check","chef-hat","cherry","chevron-down","chevron-first","chevron-last","chevron-left","chevron-right","chevron-up","chevrons-down-up","chevrons-down","chevrons-left-right","chevrons-left","chevrons-right-left","chevrons-right","chevrons-up-down","chevrons-up","chrome","cigarette-off","cigarette","circle-dot","circle-ellipsis","circle-slashed","circle","citrus","clapperboard","clipboard-check","clipboard-copy","clipboard-edit","clipboard-list","clipboard-signature","clipboard-type","clipboard-x","clipboard","clock-1","clock-10","clock-11","clock-12","clock-2","clock-3","clock-4","clock-5","clock-6","clock-7","clock-8","clock-9","clock","cloud-cog","cloud-drizzle","cloud-fog","cloud-hail","cloud-lightning","cloud-moon-rain","cloud-moon","cloud-off","cloud-rain-wind","cloud-rain","cloud-snow","cloud-sun-rain","cloud-sun","cloud","cloudy","clover","code-2","code","codepen","codesandbox","coffee","cog","coins","columns","command","compass","component","contact","contrast","cookie","copy","copyleft","copyright","corner-down-left","corner-down-right","corner-left-down","corner-left-up","corner-right-down","corner-right-up","corner-up-left","corner-up-right","cpu","credit-card","croissant","crop","cross","crosshair","crown","cup-soda","curly-braces","currency","database","delete","diamond","dice-1","dice-2","dice-3","dice-4","dice-5","dice-6","dices","diff","disc","divide-circle","divide-square","divide","dollar-sign","download-cloud","download","dribbble","droplet","droplets","drumstick","edit-2","edit-3","edit","egg-fried","egg","equal-not","equal","eraser","euro","expand","external-link","eye-off","eye","facebook","factory","fast-forward","feather","figma","file-archive","file-audio-2","file-audio","file-axis-3d","file-badge-2","file-badge","file-bar-chart-2","file-bar-chart","file-box","file-check-2","file-check","file-clock","file-code","file-cog-2","file-cog","file-diff","file-digit","file-down","file-edit","file-heart","file-image","file-input","file-json-2","file-json","file-key-2","file-key","file-line-chart","file-lock-2","file-lock","file-minus-2","file-minus","file-output","file-pie-chart","file-plus-2","file-plus","file-question","file-scan","file-search-2","file-search","file-signature","file-spreadsheet","file-symlink","file-terminal","file-text","file-type-2","file-type","file-up","file-video-2","file-video","file-volume-2","file-volume","file-warning","file-x2","file-x","file","files","film","filter","fingerprint","flag-off","flag-triangle-left","flag-triangle-right","flag","flame","flashlight-off","flashlight","flask-conical","flask-round","flip-horizontal-2","flip-horizontal","flip-vertical-2","flip-vertical","flower-2","flower","focus","folder-archive","folder-check","folder-clock","folder-closed","folder-cog-2","folder-cog","folder-down","folder-edit","folder-heart","folder-input","folder-key","folder-lock","folder-minus","folder-open","folder-output","folder-plus","folder-search-2","folder-search","folder-symlink","folder-tree","folder-up","folder-x","folder","folders","form-input","forward","frame","framer","frown","fuel","function-square","gamepad-2","gamepad","gauge","gavel","gem","ghost","gift","git-branch-plus","git-branch","git-commit","git-compare","git-fork","git-merge","git-pull-request-closed","git-pull-request-draft","git-pull-request","github","gitlab","glass-water","glasses","globe-2","globe","grab","graduation-cap","grape","grid","grip-horizontal","grip-vertical","hammer","hand-metal","hand","hard-drive","hard-hat","hash","haze","headphones","heart-crack","heart-handshake","heart-off","heart-pulse","heart","help-circle","hexagon","highlighter","history","home","hourglass","ice-cream","image-minus","image-off","image-plus","image","import","inbox","indent","indian-rupee","infinity","info","inspect","instagram","italic","japanese-yen","joystick","key","keyboard","lamp-ceiling","lamp-desk","lamp-floor","lamp-wall-down","lamp-wall-up","lamp","landmark","languages","laptop-2","laptop","lasso-select","lasso","laugh","layers","layout-dashboard","layout-grid","layout-list","layout-template","layout","leaf","library","life-buoy","lightbulb-off","lightbulb","line-chart","link-2off","link-2","link","linkedin","list-checks","list-end","list-minus","list-music","list-ordered","list-plus","list-start","list-video","list-x","list","loader-2","loader","locate-fixed","locate-off","locate","lock","log-in","log-out","luggage","magnet","mail-check","mail-minus","mail-open","mail-plus","mail-question","mail-search","mail-warning","mail-x","mail","mails","map-pin-off","map-pin","map","martini","maximize-2","maximize","medal","megaphone-off","megaphone","meh","menu","message-circle","message-square","mic-2","mic-off","mic","microscope","milestone","minimize-2","minimize","minus-circle","minus-square","minus","monitor-off","monitor-speaker","monitor","moon","more-horizontal","more-vertical","mountain-snow","mountain","mouse-pointer-2","mouse-pointer-click","mouse-pointer","mouse","move-3d","move-diagonal-2","move-diagonal","move-horizontal","move-vertical","move","music-2","music-3","music-4","music","navigation-2off","navigation-2","navigation-off","navigation","network","newspaper","octagon","option","outdent","package-2","package-check","package-minus","package-open","package-plus","package-search","package-x","package","paint-bucket","paintbrush-2","paintbrush","palette","palmtree","paperclip","party-popper","pause-circle","pause-octagon","pause","pen-tool","pencil","percent","person-standing","phone-call","phone-forwarded","phone-incoming","phone-missed","phone-off","phone-outgoing","phone","pie-chart","piggy-bank","pin-off","pin","pipette","pizza","plane","play-circle","play","plug-zap","plus-circle","plus-square","plus","pocket","podcast","pointer","pound-sterling","power-off","power","printer","puzzle","qr-code","quote","radio-receiver","radio","recycle","redo-2","redo","refresh-ccw","refresh-cw","regex","repeat-1","repeat","reply-all","reply","rewind","rocket","rocking-chair","rotate-3d","rotate-ccw","rotate-cw","rss","ruler","russian-ruble","save","scale-3d","scale","scaling","scan-face","scan-line","scan","scissors","screen-share-off","screen-share","scroll","search","send","separator-horizontal","separator-vertical","server-cog","server-crash","server-off","server","settings-2","settings","share-2","share","sheet","shield-alert","shield-check","shield-close","shield-off","shield","shirt","shopping-bag","shopping-cart","shovel","shrink","shrub","shuffle","sidebar-close","sidebar-open","sidebar","sigma","signal-high","signal-low","signal-medium","signal-zero","signal","siren","skip-back","skip-forward","skull","slack","slash","slice","sliders-horizontal","sliders","smartphone-charging","smartphone","smile-plus","smile","snowflake","sofa","sort-asc","sort-desc","speaker","sprout","square","star-half","star-off","star","stethoscope","sticker","sticky-note","stop-circle","stretch-horizontal","stretch-vertical","strikethrough","subscript","sun-dim","sun-medium","sun-moon","sun-snow","sun","sunrise","sunset","superscript","swiss-franc","switch-camera","sword","swords","syringe","table-2","table","tablet","tag","tags","target","tent","terminal-square","terminal","text-cursor-input","text-cursor","thermometer-snowflake","thermometer-sun","thermometer","thumbs-down","thumbs-up","ticket","timer-off","timer-reset","timer","toggle-left","toggle-right","tornado","toy-brick","train","trash-2","trash","tree-deciduous","tree-pine","trees","trello","trending-down","trending-up","triangle","trophy","truck","tv-2","tv","twitch","twitter","type","umbrella","underline","undo-2","undo","unlink-2","unlink","unlock","upload-cloud","upload","usb","user-check","user-cog","user-minus","user-plus","user-x","user","users","utensils-crossed","utensils","venetian-mask","verified","vibrate-off","vibrate","video-off","video","view","voicemail","volume-1","volume-2","volume-x","volume","wallet","wand-2","wand","watch","waves","webcam","webhook","wifi-off","wifi","wind","wine","wrap-text","wrench","x-circle","x-octagon","x-square","x","youtube","zap-off","zap","zoom-in","zoom-out","create-new","trash","search","right-triangle","document","folder","pencil","left-arrow","right-arrow","three-horizontal-bars","dot-network","audio-file","image-file","pdf-file","gear","documents","blocks","go-to-file","presentation","cross-in-box","microphone","microphone-filled","two-columns","link","popup-open","checkmark","hashtag","left-arrow-with-tail","right-arrow-with-tail","up-arrow-with-tail","down-arrow-with-tail","lines-of-text","vertical-three-dots","pin","magnifying-glass","info","horizontal-split","vertical-split","calendar-with-checkmark","folder-minus","sheets-in-box","up-and-down-arrows","broken-link","cross","any-key","reset","star","crossed-star","dice","filled-pin","enter","help","vault","open-vault","paper-plane","bullet-list","uppercase-lowercase-a","star-list","expand-vertically","languages","switch","pane-layout","install","sync","check-in-circle","sync-small","check-small","paused","forward-arrow","stacked-levels","bracket-glyph","note-glyph","tag-glyph","price-tag-glyph","heading-glyph","bold-glyph","italic-glyph","strikethrough-glyph","highlight-glyph","code-glyph","quote-glyph","link-glyph","bullet-list-glyph","number-list-glyph","checkbox-glyph","undo-glyph","redo-glyph","up-chevron-glyph","down-chevron-glyph","left-chevron-glyph","right-chevron-glyph","percent-sign-glyph","keyboard-glyph","double-up-arrow-glyph","double-down-arrow-glyph","image-glyph","wrench-screwdriver-glyph","clock","plus-with-circle","minus-with-circle","indent-glyph","unindent-glyph","fullscreen","exit-fullscreen","cloud","run-command","compress-glyph","enlarge-glyph","scissors-glyph","up-curly-arrow-glyph","down-curly-arrow-glyph","plus-minus-glyph","links-going-out","links-coming-in","add-note-glyph","duplicate-glyph","clock-glyph","calendar-glyph","command-glyph","dice-glyph","file-explorer-glyph","graph-glyph","import-glyph","navigate-glyph","open-elsewhere-glyph","presentation-glyph","paper-plane-glyph","question-mark-glyph","restore-file-glyph","search-glyph","star-glyph","play-audio-glyph","stop-audio-glyph","tomorrow-glyph","wand-glyph","workspace-glyph","yesterday-glyph","box-glyph","merge-files-glyph","merge-files","two-blank-pages","scissors","paste","paste-text","split","select-all-text","wand","github-glyph","reading-glasses","user-manual-filled","discord-filled","chat-bubbles-filled","experiment-filled","bracket-glyph","box-glyph","check-small","dice-glyph","dice","discord","right-triangle","heading-glyph","help","keyboard-toggle","broken-link","experiment","left-arrow","link","link-glyph","links-coming-in","links-going-out","open-vault","paused","question-mark-glyph","right-arrow","sidebar-left","sidebar-right","sheets-in-box","star-list","sync-small","tabs","uppercase-lowercase-a","vault","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","distribute-space-horizontal","distribute-space-vertical"];function o(t){let e=Date.now().toString(36);return e+=Math.random().toString(36).substr(3,t),e}function n(t,e,i){let o,n={index:-1,subindex:-1},s=t.settings.menuCommands;return i?s.forEach(((t,i)=>{if("SubmenuCommands"in t&&(o=t.SubmenuCommands.findIndex((t=>t.id==e.id)),o>=0))return n={index:i,subindex:o},n})):(o=s.findIndex((t=>t.id==e.id)),n={index:o,subindex:-1}),n}function s(t,e){let i,o=e.getLine(e.getCursor().line),n="";const s=/^(\>*(\[[!\w]+\])?\s*)#+\s/;let a;const r=o.match(s);r&&(a=r[0].trim()),t==a||""==t?i=o.replace(s,"$1"):(i=o.replace(/^\s*(#*|\>|\-|\d+\.)\s*/m,""),i=t+" "+i),n=""!=i?e.getRange(e.getCursor(),{line:e.getCursor().line,ch:o.length}):e.getRange(e.getCursor(),{line:e.getCursor().line,ch:0}),e.setLine(e.getCursor().line,i),e.setCursor({line:e.getCursor().line,ch:Number(i.length-n.length)})}function a(t,e){if(!e)return;const i=e.getSelection();if(!i||""===i.trim())return;const o=/<font\s+color=["']?[^"'>]+["']?>(.*?)<\/font>/gms,n=o.test(i);if(s=i,new RegExp(`^<font\\s+color=["']?${t}["']?>(.+)<\\/font>$`,"ms").test(s.trim()))return;var s;const a=i.replace(o,((e,i)=>i.split("\n").map((e=>e.trim()?`<font color="${t}">${e}</font>`:e)).join("\n"))),r=a===i?i.split("\n").map((e=>e.trim()?`<font color="${t}">${e}</font>`:e)).join("\n"):a,l=e.listSelections().map((e=>{const i=n?0:`<font color="${t}"></font>`.length;return e.anchor.line<e.head.line||e.anchor.line===e.head.line&&e.anchor.ch<e.head.ch?{anchor:{line:e.anchor.line,ch:e.anchor.ch},head:{line:e.head.line,ch:e.head.ch+i}}:{anchor:{line:e.anchor.line,ch:e.anchor.ch+i},head:{line:e.head.line,ch:e.head.ch}}}));e.replaceSelection(r),e.setSelections(l)}function r(t,e){if(!e)return;const i=e.getSelection();if(!i||""===i.trim())return;const o=/<span\s+style=["']?background:(?:#[0-9a-fA-F]{3,6}|rgba?\([^)]+\))["']?>([\s\S]*?)<\/span>/g.test(i);if(((t,e)=>{const i=e.replace(/([()[{*+.$^\\|?])/g,"\\$1");return new RegExp(`^<span\\s+style=["']?background:${i}["']?>([sS]+)<\\/span>$`).test(t.trim())})(i,t))return;let n;n=o?i.replace(/(background:)(?:#[0-9a-fA-F]{3,6}|rgba?\([^)]+\))/gi,`$1${t}`):i.split("\n").map((e=>e.trim()?`<span style="background:${t}">${e}</span>`:e)).join("\n");const s=e.listSelections().map((e=>{const i=o?0:`<span style="background:${t}"></span>`.length;return e.anchor.line<e.head.line||e.anchor.line===e.head.line&&e.anchor.ch<e.head.ch?{anchor:{line:e.anchor.line,ch:e.anchor.ch},head:{line:e.head.line,ch:e.head.ch+i}}:{anchor:{line:e.anchor.line,ch:e.anchor.ch+i},head:{line:e.head.line,ch:e.head.ch}}}));e.replaceSelection(n),e.setSelections(s)}let l;const c=e=>{l=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;let i=l.getElementById("editingToolbarModalBar");i&&(i.style.visibility=0==e?"hidden":"visible")},d=e=>{l=t.requireApiVersion("0.15.0")?activeWindow.document:window.document,l.documentElement.style.setProperty("--toolbar-vertical-offset",`${e.verticalPosition}px`);let i=l.getElementById("editingToolbarModalBar");i&&"fixed"==e.positionStyle&&i.setAttribute("style",`left: calc(50% - calc(${28*e.cMenuNumRows}px / 2)); bottom: 4.25em; grid-template-columns: repeat(${e.cMenuNumRows}, 28px)`)},h=e=>{l=t.requireApiVersion("0.15.0")?activeWindow.document:window.document,l.documentElement.style.setProperty("--toolbar-horizontal-offset",`${e.horizontalPosition}px`)};var u={"Editing Toolbar append method":"Editing Toolbar append method","Choose where Editing Toolbar will append upon regeneration. To see the change, hit the refresh button below, or in the status bar menu.":"Choose where Editing Toolbar will append upon regeneration. To see the change, hit the refresh button below, or in the status bar menu.","Editing Toolbar aesthetic":"Editing Toolbar aesthetic","Choose between a glass morphism ,tiny and default style for Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.":"Choose between a glass morphism ,tiny and default style for Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.","Editing Toolbar position":"Editing Toolbar position","Choose between fixed position or cursor following mode.":"Choose between fixed position , cursor following  or Top mode .","Editing Toolbar columns":"Editing Toolbar columns","Choose the number of columns per row to display on Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.":"Choose the number of columns per row to display on Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.","Editing Toolbar refresh":"Editing Toolbar refresh","Editing Toolbar commands":"Editing Toolbar commands","Add a command onto Editing Toolbar from Obsidian's commands library. To reorder the commands, drag and drop the command items. To delete them, use the delete buttom to the right of the command item. Editing Toolbar will not automaticaly refresh after reordering commands. Use the refresh button above.":"Add a command onto Editing Toolbar from Obsidian's commands library. To reorder the commands, drag and drop the command items. To delete them, use the delete buttom to the right of the command item. Editing Toolbar will not automaticaly refresh after reordering commands. Use the refresh button above.","Format Brush Off!":"Format Brush Off!","Hide & Show":"Hide & Show","Editing Toolbar will only refresh automatically after you have either added or deleted a command from it. To see UI changes to editingToolbar (above settings changes) use the refresh button. If you forget to refresh in settings, no worries. There is also a refresh button in the editingToolbar status bar menu.":"Editing Toolbar will only refresh automatically after you have either added or deleted a command from it. To see UI changes to editingToolbar (above settings changes) use the refresh button. If you forget to refresh in settings, no worries. There is also a refresh button in the editingToolbar status bar menu.","Font-Color formatting brush ON!":"Font-Color formatting brush ON!",More:"More","Font Colors":"Font Colors","Format Brush":"Format Brush","Background color":"Background color",Refresh:"Refresh",Add:"Add",Delete:"Delete","Change Command name":"Change Command name","Add submenu":"Add submenu","add hr":"add hr","Enter the icon code, it looks like <svg>.... </svg> format":"Enter the icon code, it looks like <svg>.... </svg> format","Please enter a new nameï¼š":"Please enter a new nameï¼š","Drag the slider to move the position":"Drag the slider to move the position","Plugin Settings":"Plugin Settings","Background-color formatting brush ON!":"Background-color formatting brush ON!\nClick the  mouse middle or right key to close the formatting-brush","Clear formatting brush ON!":"Clear formatting brush ON!","Clear formatting brush ON!\nClick the  mouse middle or right key to close the formatting-brush":"Clear formatting brush ON!\nClick the  mouse middle or right key to close the formatting-brush","The toolbar is displayed when the mouse moves over it, otherwise it is automatically hidden":"The toolbar is displayed when the mouse moves over it, otherwise it is automatically hidden","Editing Toolbar Auto-hide":"Editing Toolbar Auto-hide","Custom Backgroud Color":"Custom Backgroud Color","Custom Font Color":"Custom Font Color","ğŸ¨ Set custom background":"ğŸ¨ Set custom background","ğŸ–Œï¸ Set custom font color":"ğŸ–Œï¸ Set custom font color","Click on the picker to adjust the colour":"Click on the picker to adjust the colour","Mobile enabled or not":"Mobile enabled or not","Whether to enable the plugin for the mobile client, the default is enabled.":"Whether to enable the plugin for the mobile client, the default is enabled.","Whether to enable on mobile devices with device width less than 768px, the default is disable.":"Whether to enable on mobile devices with device width less than 768px, the default is disable.",Reset:"Reset",Fix:"Fix","Fix Editing Toolbar":"Fix Editing Toolbar",General:"General",Appearance:"Appearance",Commands:"Commands","Choose between fixed position or cursor following mode":"Choose between fixed position , cursor following  or Top mode .","Add and manage commands":"Add and manage commands","Choose where Editing Toolbar will append upon regeneration.":"Choose where Editing Toolbar will append upon regeneration.","Whether to enable on mobile devices with device width less than 768px":"Whether to enable on mobile devices with device width less than 768px","Choose between a glass morphism, tiny and default style":"Choose between a glass morphism, tiny and default style","Refresh Toolbar":"Refresh Toolbar","Add Command":"Add Command",Settings:"Settings","Position Style":"Position Style",Columns:"Columns","Drag to Adjust Position":"Drag to Adjust Position","Vertical Position":"Vertical Position","Horizontal Position":"Horizontal Position","Toolbar Position":"Toolbar Position","Choose an icon":"Choose an icon","Search for an icon...":"Search for an icon...",All:"All",Obsidian:"Obsidian",Glyph:"Glyph",Custom:"Custom","Choose a command":"Choose a command","The command":"The command","already exists":"already exists","Enter the icon code, format as <svg>.... </svg>":"Enter the icon code, format as <svg>.... </svg>","No matching icons found":"No matching icons found","Custom Commands":"Custom Commands","Toolbar Commands":"Toolbar Commands",ID:"ID",Prefix:"Prefix",Suffix:"Suffix","Custom Format Commands":"Custom Format Commands","Add, edit or delete custom format commands":"Add, edit or delete custom format commands",Edit:"Edit","Command ID":"Command ID",'Unique identifier, no spaces, e.g.: "my-custom-format"':'Unique identifier, no spaces, e.g.: "my-custom-format"',"Displayed name in toolbar and menu":"Displayed name in toolbar and menu","Add content before selected text":"Add content before selected text","Add content after selected text":"Add content after selected text","Character offset of cursor after formatting":"Character offset of cursor after formatting","Line offset of cursor after formatting":"Line offset of cursor after formatting","Whether to insert at the beginning of the next line":"Whether to insert at the beginning of the next line","Command icon (click to select)":"Command icon (click to select)","Choose Icon":"Choose Icon",Save:"Save",Cancel:"Cancel","Edit Custom Command":"Edit Custom Command","Add Custom Command":"Add Custom Command","Command ID and command name cannot be empty":"Command ID and command name cannot be empty","Command ID cannot contain spaces":"Command ID cannot contain spaces",'Command ID "${this.commandId}" already exists':'Command ID "${this.commandId}" already exists',"Cursor Position Offset":"Cursor Position Offset","Line Offset":"Line Offset","Line Head Format":"Line Head Format",Icon:"Icon","Command Name":"Command Name","Are you sure you want to restore all settings to default? This will lose all your custom configurations.":"Are you sure you want to restore all settings to default? This will lose all your custom configurations.","Restore default":"Restore default","Restore default settings":"Restore default settings","ğŸ”„Restore default settings":"ğŸ”„Restore default settings","ğŸ”§Data repair":"ğŸ”§Data repair","Command IDs have been successfully repaired!":"Command IDs have been successfully repaired!","No command IDs need to be repaired":"No command IDs need to be repaired","Error repairing command IDs, please check the console for details":"Error repairing command IDs, please check the console for details","Error restoring default settings, please check the console for details":"Error restoring default settings, please check the console for details","Successfully restored default settings!":"Successfully restored default settings!",Close:"Close",Tips:"Tips","This update changed the ID of some commands, please click this button to repair the commands to ensure the toolbar works properly":"This update changed the ID of some commands, please click this button to repair the commands to ensure the toolbar works properly","Repair command ID":"Repair command ID","This will reset all your custom configurations":"This will reset all your custom configurations","Notice:":"Notice:","This update rebuilds the entire code, reducing resource consumption":"This update rebuilds the entire code, reducing resource consumption","Optimized mobile usage, added canvas support, and added custom commands":"Optimized mobile usage, added canvas support, and added custom commands","âš ï¸This update is not compatible with some old version command ids, please click [Repair command] to be compatible":"âš ï¸This update is not compatible with some old version command ids, please click [Repair command] to be compatible","âš ï¸If you want to restore the default settings, please click [Restore default settings]":"âš ï¸If you want to restore the default settings, please click [Restore default settings]","Please execute a editingToolbar format command first, then enable the format brush":"Please execute a editingToolbar format command first, then enable the format brush","Format brush ON! Select text to applyã€":"Format brush ON! Select text to applyã€","ã€‘format":"ã€‘format\nClick the mouse middle or right key to close the formatting-brush","Add to Toolbar":"Add to Toolbar","This command is already in the toolbar":"This command is already in the toolbar","Command added to toolbar":"Command added to toolbar","Add this command to the toolbar":"Add this command to the toolbar","Callout Type":"Callout Type",Title:"Title","Optional, leave blank for default title":"Optional, leave blank for default title","Input title":"Input title","Collapse State":"Collapse State",Open:"Open",Closed:"Closed",Content:"Content",Insert:"Insert",Default:"Default","Input content":"Input content","Link Text":"Link Text","Link Alias":"Link Alias","Link URL":"Link URL","Embed Content":"Embed Content","Image Size":"Image Size","Insert New Line":"Insert New Line","Paste and Parse":"Paste and Parse","URL Format Error":"URL Format Error","Image Width":"Image Width","Image Height":"Image Height","If it is an image, turn on":"If it is an image, turn on","Insert a link on the next line":"Insert a link on the next line","Link Alias(optional)":"Link Alias(optional)",Alias:"Alias",Optional:"Optional","Default 0, format will keep the text selected":"Default 0, format will keep the text selected","to insert":"to insert","Latest Changes":"Latest Changes","ğŸ“‹View full changelog":"ğŸ“‹View full changelog","Open changelog":"Open changelog","Loading changelog...":"Loading changelog...","Open the complete changelog in your browser":"Open the complete changelog in your browser"};const p={ar:{},cs:{},da:{},de:{},en:u,"en-gb":{},es:{},fr:{},hi:{},id:{},it:{},ja:{},ko:{},nl:{},nn:{},pl:{},pt:{},"pt-br":{},ro:{},ru:{},tr:{},"zh-cn":{"Editing Toolbar append method":"å·¥å…·æ çš„é™„åŠ æ–¹æ³•ã€‚","Choose where Editing Toolbar will append upon regeneration. To see the change, hit the refresh button below, or in the status bar menu.":"å·¥å…·æ åœ¨Obsidianä¸­çš„è¿½åŠ çš„ä½ç½®ï¼Œåªå¯¹å›ºå®šå’Œè·Ÿéšæ¨¡å¼æœ‰æ•ˆã€‚å¦‚æœä½ é‡åˆ°å·¥å…·æ æ˜¾ç¤ºé—®é¢˜ï¼Œå¯ä»¥é€‰æ‹©bodyè¯•è¯•ã€‚è¯·ç‚¹å‡»ä¸‹é¢æˆ–è€…çŠ¶æ€æ èœå•ä¸­çš„åˆ·æ–°æŒ‰é’®ç”Ÿæ•ˆã€‚","Editing Toolbar aesthetic":"å·¥å…·æ æ ·å¼","Choose between a glass morphism ,tiny and default style for Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.":"æ ·å¼æœ‰æ¯›ç»ç’ƒ,ç®€çº¦å’Œé»˜è®¤é£æ ¼é€‰æ‹©ã€‚è¯·ç‚¹å‡»ä¸‹é¢æˆ–è€…çŠ¶æ€æ èœå•ä¸­çš„åˆ·æ–°æŒ‰é’®ç”Ÿæ•ˆã€‚","Editing Toolbar position":"å·¥å…·æ ä½ç½®","Choose between fixed position or cursor following mode.":"åœ¨å›ºå®šä½ç½®,å…‰æ ‡è·Ÿéšæ¨¡å¼æˆ–è€…ç½®é¡¶æ¨¡å¼ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚","Editing Toolbar columns":"å·¥å…·æ æ ç›®æ•°","Choose the number of columns per row to display on Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.":"é€‰æ‹©åœ¨Editing Toolbarä¸Šæ˜¾ç¤ºçš„æ¯è¡Œçš„åˆ—æ•°ã€‚","Editing Toolbar refresh":"åˆ·æ–°å·¥å…·æ ","Editing Toolbar commands":"åœ¨å·¥å…·æ ä¸­æ·»åŠ å‘½ä»¤","Add a command onto Editing Toolbar from Obsidian's commands library. To reorder the commands, drag and drop the command items. To delete them, use the delete buttom to the right of the command item. Editing Toolbar will not automaticaly refresh after reordering commands. Use the refresh button above.":"ä»Obsidiançš„å‘½ä»¤åº“ä¸­æ·»åŠ ä¸€ä¸ªå‘½ä»¤åˆ°å·¥å…·æ ã€‚è¦é‡æ–°æ’åˆ—å‘½ä»¤ï¼Œå¯ä»¥æ‹–æ”¾å‘½ä»¤é¡¹ã€‚è¦åˆ é™¤å®ƒä»¬ï¼Œè¯·ä½¿ç”¨å‘½ä»¤é¡¹å³è¾¹çš„åˆ é™¤æŒ‰é’®ã€‚å›¾æ ‡é€‰æ‹©Customå¯ä»¥è‡ªå®šä¹‰å›¾æ ‡","Format Brush Off!":"å…³é—­æ ¼å¼åˆ·ï¼","Hide & Show":"éšè— & æ˜¾ç¤º","Editing Toolbar will only refresh automatically after you have either added or deleted a command from it. To see UI changes to editingToolbar (above settings changes) use the refresh button. If you forget to refresh in settings, no worries. There is also a refresh button in the editingToolbar status bar menu.":"å¯¹å¤–è§‚çš„æ›´æ”¹ç”Ÿæ•ˆéœ€è¦ä½¿ç”¨åˆ·æ–°æŒ‰é’®ã€‚å¦‚æœä½ å¿˜è®°åœ¨è®¾ç½®ä¸­åˆ·æ–°ï¼Œåœ¨çŠ¶æ€æ èœå•ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåˆ·æ–°æŒ‰é’®ã€‚","Font-Color formatting brush ON!":"å­—ä½“é¢œè‰²æ ¼å¼åˆ·å¼€å¯\nç‚¹å‡»é¼ æ ‡ä¸­é”®æˆ–è€…å³é”®å…³é—­æ ¼å¼åˆ·",More:"æ›´å¤š","Font Colors":"å­—ä½“é¢œè‰²","Format Brush":"æ ¼å¼åˆ·","Background color":"èƒŒæ™¯é¢œè‰²",Refresh:"åˆ·æ–°",Add:"æ·»åŠ ",Delete:"åˆ é™¤","Change Command name":"æ›´æ”¹å‘½ä»¤åç§°","Add submenu":"æ·»åŠ å­èœå•","add hr":"æ·»åŠ åˆ†å‰²çº¿","Enter the icon code, it looks like <svg>.... </svg> format":"è¾“å…¥å›¾æ ‡ä»£ç ï¼Œç±»ä¼¼<svg>.... </svg>æ ¼å¼","Please enter a new nameï¼š":"è¯·è¾“å…¥æ–°åç§°ï¼š","Drag the slider to move the position":"æ‹–åŠ¨æ»‘å—æ¥ç§»åŠ¨ä½ç½®","Plugin Settings":"æ’ä»¶è®¾ç½®","Background-color formatting brush ON!":"å¼€å¯èƒŒæ™¯è‰²æ ¼å¼åˆ·","Clear formatting brush ON!":"æ¸…é™¤æ ¼å¼åˆ·å·²å¼€å¯","Clear formatting brush ON!\nClick the  mouse middle or right key to close the formatting-brush":"æ¸…é™¤æ ¼å¼åˆ·å·²å¼€å¯\nç‚¹å‡»é¼ æ ‡ä¸­é”®æˆ–è€…å³é”®å…³é—­æ ¼å¼åˆ·","The toolbar is displayed when the mouse moves over it, otherwise it is automatically hidden":"å½“é¼ æ ‡ç§»åˆ°å·¥å…·æ ä¸Šæ–¹æ—¶ï¼Œå·¥å…·æ æ˜¾ç¤ºï¼Œå¦åˆ™è‡ªåŠ¨éšè—","Editing Toolbar Auto-hide":"å·¥å…·æ æ˜¯å¦è‡ªåŠ¨éšè—","Custom Backgroud Color":"è®¾ç½®è‡ªå®šä¹‰èƒŒæ™¯è‰²","Custom Font Color":"è®¾ç½®è‡ªå®šä¹‰å­—ä½“é¢œè‰²","ğŸ¨ Set custom background":"ğŸ¨ è®¾ç½®è‡ªå®šä¹‰èƒŒæ™¯","ğŸ–Œï¸ Set custom font color":"ğŸ–Œï¸ è®¾ç½®è‡ªå®šä¹‰å­—ä½“é¢œè‰²","Click on the picker to adjust the colour":"ç‚¹å‡»é€‰å–å™¨æ¥è°ƒæ•´é¢œè‰²","Mobile enabled or not":"æ˜¯å¦åœ¨ç§»åŠ¨ç«¯å¯ç”¨","Whether to enable on mobile devices with device width less than 768px, the default is disable.":"æ˜¯å¦åœ¨è®¾å¤‡å®½åº¦å°äº768çš„ç§»åŠ¨è®¾å¤‡å¯ç”¨ã€‚é»˜è®¤ä¸å¯ç”¨",Reset:"é‡ç½®",Fix:"ä¿®å¤","Fix Editing Toolbar":"ä¿®å¤å·¥å…·æ ",General:"å¸¸è§„",Appearance:"å¤–è§‚",Commands:"å‘½ä»¤","Choose between fixed position or cursor following mode":"é€‰æ‹©å›ºå®šä½ç½®æˆ–è€…å…‰æ ‡è·Ÿéšæ¨¡å¼","Add and manage commands":"æ·»åŠ å’Œç®¡ç†å‘½ä»¤","Choose where Editing Toolbar will append upon regeneration.":"é€‰æ‹©å·¥å…·æ åœ¨Obsidianä¸­çš„è¿½åŠ çš„ä½ç½®ã€‚","Whether to enable on mobile devices with device width less than 768px":"æ˜¯å¦åœ¨ç§»åŠ¨è®¾å¤‡ä¸­å¯ç”¨ã€‚é»˜è®¤ä¸å¯ç”¨","Choose between a glass morphism, tiny and default style":"é€‰æ‹©æ¯›ç»ç’ƒ,ç®€çº¦å’Œé»˜è®¤é£æ ¼","Refresh Toolbar":"åˆ·æ–°å·¥å…·æ ","Add Command":"æ·»åŠ å‘½ä»¤",Settings:"è®¾ç½®","Adjust Toolbar Position[Fixed mode]":"è°ƒæ•´å·¥å…·æ ä½ç½®[å›ºå®šæ¨¡å¼]","Position Style":"ä½ç½®æ ·å¼",Columns:"åˆ—æ•°","Drag to Adjust Position":"æ‹–åŠ¨è°ƒæ•´ä½ç½®","Vertical Position":"å‚ç›´ä½ç½®","Horizontal Position":"æ°´å¹³ä½ç½®","Toolbar Position":"å·¥å…·æ ä½ç½®","Choose an icon":"é€‰æ‹©ä¸€ä¸ªå›¾æ ‡","Search for an icon...":"æœç´¢å›¾æ ‡...",All:"å…¨éƒ¨",Obsidian:"Obsidian",Glyph:"Glyph",Custom:"è‡ªå®šä¹‰","Choose a command":"é€‰æ‹©ä¸€ä¸ªå‘½ä»¤","The command":"å‘½ä»¤","already exists":"å·²å­˜åœ¨","Enter the icon code, format as <svg>.... </svg>":"è¾“å…¥å›¾æ ‡ä»£ç ï¼Œæ ¼å¼ä¸º <svg>.... </svg>","No matching icons found":"æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å›¾æ ‡","Custom Commands":"è‡ªå®šä¹‰å‘½ä»¤","Toolbar Commands":"å·¥å…·æ å‘½ä»¤",ID:"ID",Prefix:"å‰ç¼€",Suffix:"åç¼€","Custom Format Commands":"è‡ªå®šä¹‰æ ¼å¼å‘½ä»¤","Add, edit or delete custom format commands":"æ·»åŠ ã€ç¼–è¾‘æˆ–åˆ é™¤è‡ªå®šä¹‰æ ¼å¼å‘½ä»¤",Edit:"ç¼–è¾‘","Command ID":"å‘½ä»¤ID",'Unique identifier, no spaces, e.g.: "my-custom-format"':'å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¸åŒ…å«ç©ºæ ¼ï¼Œä¾‹å¦‚ï¼š"my-custom-format"',"Displayed name in toolbar and menu":"åœ¨å·¥å…·æ å’Œèœå•ä¸­æ˜¾ç¤ºçš„åç§°","Add content before selected text":"åœ¨é€‰ä¸­çš„æ–‡æœ¬å‰æ·»åŠ å†…å®¹","Add content after selected text":"åœ¨é€‰ä¸­çš„æ–‡æœ¬åæ·»åŠ å†…å®¹","Character offset of cursor after formatting":"æ ¼å¼åŒ–åå…‰æ ‡çš„å­—ç¬¦åç§»é‡","Line offset of cursor after formatting":"æ ¼å¼åŒ–åå…‰æ ‡çš„è¡Œåç§»é‡","Whether to insert at the beginning of the next line":"æ˜¯å¦åœ¨ä¸‹ä¸€è¡Œé¦–æ’å…¥","Command icon (click to select)":"å‘½ä»¤å›¾æ ‡ï¼ˆç‚¹å‡»é€‰æ‹©ï¼‰","Choose Icon":"é€‰æ‹©å›¾æ ‡",Save:"ä¿å­˜",Cancel:"å–æ¶ˆ","Edit Custom Command":"ç¼–è¾‘è‡ªå®šä¹‰å‘½ä»¤","Add Custom Command":"æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤","Command ID and command name cannot be empty":"å‘½ä»¤IDå’Œå‘½ä»¤åç§°ä¸èƒ½ä¸ºç©º","Command ID cannot contain spaces":"å‘½ä»¤IDä¸èƒ½åŒ…å«ç©ºæ ¼",'Command ID "${this.commandId}" already exists':'å‘½ä»¤ID "${this.commandId}" å·²å­˜åœ¨',"Command Name":"å‘½ä»¤åç§°","Cursor Position Offset":"å…‰æ ‡ä½ç½®åç§»é‡","Line Offset":"è¡Œåç§»é‡","Line Head Format":"è¡Œé¦–æ ¼å¼",Icon:"å›¾æ ‡","Are you sure you want to restore all settings to default? This will lose all your custom configurations.":"ç¡®å®šè¦æ¢å¤æ‰€æœ‰è®¾ç½®ä¸ºé»˜è®¤å€¼å—ï¼Ÿè¿™å°†ä¸¢å¤±æ‚¨çš„æ‰€æœ‰è‡ªå®šä¹‰é…ç½®ã€‚","Restore default":"æ¢å¤é»˜è®¤å€¼","Restore default settings":"æ¢å¤é»˜è®¤è®¾ç½®","ğŸ”„Restore default settings":"ğŸ”„æ¢å¤é»˜è®¤è®¾ç½®","ğŸ”§Data repair":"ğŸ”§æ•°æ®ä¿®å¤","Command IDs have been successfully repaired!":"å‘½ä»¤IDå·²æˆåŠŸä¿®å¤ï¼","No command IDs need to be repaired":"æ²¡æœ‰å‘½ä»¤IDéœ€è¦ä¿®å¤","Error repairing command IDs, please check the console for details":"ä¿®å¤å‘½ä»¤IDæ—¶å‡ºé”™ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°äº†è§£è¯¦æƒ…","Error restoring default settings, please check the console for details":"æ¢å¤é»˜è®¤è®¾ç½®æ—¶å‡ºé”™ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°äº†è§£è¯¦æƒ…","Successfully restored default settings!":"å·²æˆåŠŸæ¢å¤é»˜è®¤è®¾ç½®ï¼",Close:"å…³é—­",Tips:"æç¤º","This update changed the ID of some commands, please click this button to repair the commands to ensure the toolbar works properly":"æ­¤æ¬¡æ›´æ–°æ›´æ”¹äº†éƒ¨åˆ†å‘½ä»¤çš„IDï¼Œè¯·ç‚¹å‡»æ­¤æŒ‰é’®ä¿®å¤å‘½ä»¤ä»¥ç¡®ä¿å·¥å…·æ æ­£å¸¸å·¥ä½œ","Repair command ID":"ä¿®å¤å‘½ä»¤ID","This will reset all your custom configurations":"è¿™å°†é‡ç½®æ‚¨çš„æ‰€æœ‰è‡ªå®šä¹‰é…ç½®","Notice:":"æ³¨æ„","This update rebuilds the entire code, reducing resource consumption":"æ­¤æ¬¡æ›´æ–°é‡æ„äº†å…¨éƒ¨ä»£ç ï¼Œé™ä½äº†èµ„æºå ç”¨","Optimized mobile usage, added canvas support, and added custom commands":"ä¼˜åŒ–äº†ç§»åŠ¨ç«¯ï¼Œå¢åŠ äº†å¯¹canvasæ”¯æŒï¼Œå¢åŠ äº†è‡ªå®šä¹‰å‘½ä»¤","âš ï¸This update is not compatible with some old version command ids, please click [Repair command] to be compatible":"âš ï¸æ­¤æ¬¡æ›´æ–°ä¸å…¼å®¹éƒ¨åˆ†æ—§ç‰ˆæœ¬å‘½ä»¤idï¼Œè¯·ç‚¹å‡»ã€ä¿®å¤å‘½ä»¤ã€‘è¿›è¡Œå…¼å®¹","âš ï¸If you want to restore the default settings, please click [Restore default settings]":"âš ï¸å¦‚æœæƒ³æ¢å¤é»˜è®¤è®¾ç½®ï¼Œè¯·ç‚¹å‡»ã€æ¢å¤é»˜è®¤è®¾ç½®ã€‘","Please execute a editingToolbar format command first, then enable the format brush":"è¯·å…ˆæ‰§è¡Œä¸€ä¸ªæ ¼å¼å‘½ä»¤ï¼Œç„¶åå†å¯ç”¨æ ¼å¼åˆ·","Format brush ON! Select text to applyã€":"æ ¼å¼åˆ·å·²å¼€å¯\né€‰ä¸­æ–‡æœ¬åº”ç”¨ã€","ã€‘format":"ã€‘æ ¼å¼\nç‚¹å‡»é¼ æ ‡ä¸­é”®æˆ–è€…å³é”®å…³é—­æ ¼å¼åˆ·","Add to Toolbar":"æ·»åŠ åˆ°å·¥å…·æ ","This command is already in the toolbar":"è¯¥å‘½ä»¤å·²å­˜åœ¨äºå·¥å…·æ ä¸­","Command added to toolbar":"å‘½ä»¤å·²æ·»åŠ åˆ°å·¥å…·æ ","Add this command to the toolbar":"æ·»åŠ è¯¥å‘½ä»¤åˆ°å·¥å…·æ ","Callout Type":"Callout ç±»å‹",Title:"æ ‡é¢˜","Optional, leave blank for default title":"å¯é€‰ï¼Œç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤æ ‡é¢˜","Input title":"è¾“å…¥æ ‡é¢˜","Collapse State":"æŠ˜å çŠ¶æ€",Open:"å±•å¼€",Closed:"æŠ˜å ",Content:"å†…å®¹",Insert:"æ’å…¥",Default:"é»˜è®¤","Input content":"è¾“å…¥å†…å®¹","Link Text":"é“¾æ¥æ–‡æœ¬","Link Alias":"é“¾æ¥åˆ«å","Link URL":"é“¾æ¥åœ°å€","Embed Content":"åµŒå…¥å†…å®¹","Image Size":"å›¾ç‰‡å°ºå¯¸","Insert New Line":"æ’å…¥æ–°è¡Œ","Paste and Parse":"ç²˜è´´å¹¶è§£æ","URL Format Error":"URLæ ¼å¼é”™è¯¯","Image Width":"å›¾ç‰‡å®½åº¦","Image Height":"å›¾ç‰‡é«˜åº¦","Insert a link on the next line":"åœ¨ä¸‹ä¸€è¡Œæ’å…¥é“¾æ¥","If it is an image, turn on":"å¦‚æœæ˜¯å›¾ç‰‡ï¼Œè¯·å¼€å¯","Link Alias(optional)":"é“¾æ¥åˆ«å(å¯é€‰)",Alias:"åˆ«å",Optional:"å¯é€‰","Default 0, format will keep the text selected":"é»˜è®¤0ï¼Œæ ¼å¼åŒ–å°†ä¿æŒæ–‡æœ¬é€‰ä¸­","to insert":"æ’å…¥","Latest Changes":"æœ€æ–°æ›´æ–°","ğŸ“‹View full changelog":"ğŸ“‹æŸ¥çœ‹å®Œæ•´æ›´æ–°æ—¥å¿—","Open changelog":"æ‰“å¼€æ›´æ–°æ—¥å¿—","Loading changelog...":"åŠ è½½æ›´æ–°æ—¥å¿—...","Open the complete changelog in your browser":"åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å®Œæ•´æ›´æ–°æ—¥å¿—"},"zh-tw":{}}[t.moment.locale()];function g(t){return p&&p[t]||u[t]}class m extends t.FuzzySuggestModal{constructor(t,e,i=!1,o){super(t.app),this.customCallback=null,this.plugin=t,this.command=e,this.issub=i,this.customCallback=o||null,this.setPlaceholder(g("Choose an icon"))}capitalJoin(t){return t.split(" ").map((t=>t[0].toUpperCase()+t.substring(1))).join(" ")}getItems(){return i}getItemText(t){return this.capitalJoin(t.replace("feather-","").replace("remix-","").replace("bx-","").replace(/([A-Z])/g," $1").trim().replace(/-/gi," "))}renderSuggestion(e,i){const o=createSpan({cls:"editingToolbarIconPick"});i.appendChild(o),t.setIcon(o,e.item),super.renderSuggestion(e,i)}onChooseItem(t){return e(this,void 0,void 0,(function*(){if("Custom"===t)return this.customCallback?void new f(this.app,this.plugin,{id:this.command.id,name:this.command.name,icon:""},this.issub,(t=>{this.customCallback(t)})).open():void new f(this.app,this.plugin,this.command,this.issub).open();if(this.customCallback)this.customCallback(t);else{if(this.command.icon){let e=n(this.plugin,this.command,this.issub);this.issub?this.plugin.settings.menuCommands[e.index].SubmenuCommands[e.subindex].icon=t:this.plugin.settings.menuCommands[e.index].icon=t}else this.command.icon=t,this.plugin.settings.menuCommands.push(this.command);yield this.plugin.saveSettings(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100),console.log(`%cå‘½ä»¤ '${this.command.name}' å·²æ·»åŠ åˆ°ç¼–è¾‘å·¥å…·æ `,"color: Violet")}}))}}class f extends t.Modal{constructor(t,e,i,o,n){super(t),this.customCallback=null,this.plugin=e,this.item=i,this.issub=o,this.customCallback=n||null,this.containerEl.addClass("editingToolbar-Modal"),this.containerEl.addClass("customicon")}onOpen(){const{contentEl:t}=this;t.createEl("b",{text:g("Enter the icon code, format as <svg>.... </svg>")});const i=document.createElement("textarea");i.className="wideInputPromptInputEl",i.placeholder="",i.value=this.item.icon||"",i.style.width="100%",i.style.height="200px",t.appendChild(i),i.addEventListener("input",(()=>e(this,void 0,void 0,(function*(){const t=i.value;if(this.customCallback)return void(this.item.icon=t);this.item.icon=t;const e=n(this.plugin,this.item,this.issub);if(this.issub){let i=e.subindex;-1===i?this.plugin.settings.menuCommands[e.index].SubmenuCommands.push(this.item):this.plugin.settings.menuCommands[e.index].SubmenuCommands[i].icon=t}else{let t=e.index;-1===t?this.plugin.settings.menuCommands.push(this.item):this.plugin.settings.menuCommands[t].icon=this.item.icon}yield this.plugin.saveSettings()})))),this.submitEnterCallback&&i.addEventListener("keydown",this.submitEnterCallback)}onClose(){const{contentEl:t}=this;t.empty(),this.customCallback?this.customCallback(this.item.icon||""):setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100)}}class b extends t.FuzzySuggestModal{constructor(t){super(t.app),this.plugin=t,this.app,this.setPlaceholder(g("Choose a command"))}getItems(){return app.commands.listCommands()}getItemText(t){return t.name}onChooseItem(i){return e(this,void 0,void 0,(function*(){this.plugin.settings.menuCommands.findIndex((t=>t.id==i.id))>-1?new t.Notice(g("The command")+i.name+g("already exists"),3e3):i.icon?(this.plugin.settings.menuCommands.push(i),yield this.plugin.saveSettings(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100),console.log(`%cå‘½ä»¤ '${i.name}' å·²æ·»åŠ åˆ°ç¼–è¾‘å·¥å…·æ `,"color: Violet")):new m(this.plugin,i,!1).open()}))}}class v extends t.Modal{constructor(t,e,i,o){super(e.app),this.plugin=e,this.item=i,this.issub=o,this.containerEl.addClass("editingToolbar-Modal"),this.containerEl.addClass("changename")}onOpen(){var i;const{contentEl:o}=this;o.createEl("b",{text:g("Please enter a new nameï¼š")});const s=new t.TextComponent(o);s.inputEl.classList.add("InputPromptInputEl"),s.setPlaceholder("").setValue(null!==(i=this.item.name)&&void 0!==i?i:"").onChange(t.debounce((t=>e(this,void 0,void 0,(function*(){let e=n(this.plugin,this.item,this.issub);if(this.item.name=t,this.issub){let i=e.subindex;-1===i?this.plugin.settings.menuCommands[e.index].SubmenuCommands.push(this.item):this.plugin.settings.menuCommands[e.index].SubmenuCommands[i].name=t}else{let t=e.index;-1===t?this.plugin.settings.menuCommands.push(this.item):this.plugin.settings.menuCommands[t].name=this.item.name}yield this.plugin.saveSettings()}))),100,!0)).inputEl.addEventListener("keydown",this.submitEnterCallback)}onClose(){const{contentEl:t}=this;t.empty(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100)}}class y extends t.Modal{constructor(t,e){super(e.app),this.needSave=!1,this.plugin=e,this.containerEl.addClass("editingToolbar-Modal")}onOpen(){const{contentEl:i}=this;i.createEl("p",{text:g("Drag the slider to move the position")});const o=i.createDiv({cls:"slider-container"}),n=o.createDiv({cls:"vertical-slider-container"});n.createEl("p",{text:g("Vertical Position")});const s=o.createDiv({cls:"horizontal-slider-container"});s.createEl("p",{text:g("Horizontal Position")});const a=o.createDiv({cls:"columns-slider-container"});a.createEl("p",{text:g("Editing Toolbar columns")});const r=document.body.clientHeight,l=document.body.clientWidth,c=Math.floor(r/3),u=-Math.floor(r),p=Math.floor(l/2),m=-Math.floor(l/2),f=new t.SliderComponent(n).setLimits(u,c,5).setValue(this.plugin.settings.verticalPosition||0).onChange(t.debounce((t=>{this.needSave=!0,this.plugin.settings.verticalPosition=t,d(this.plugin.settings)}),100,!0)).setDynamicTooltip(),b=new t.SliderComponent(s).setLimits(m,p,10).setValue(this.plugin.settings.horizontalPosition||0).onChange(t.debounce((t=>{this.needSave=!0,this.plugin.settings.horizontalPosition=t,h(this.plugin.settings)}),100,!0)).setDynamicTooltip(),v=new t.SliderComponent(a).setLimits(1,32,1).setValue(this.plugin.settings.cMenuNumRows||12).onChange(t.debounce((t=>e(this,void 0,void 0,(function*(){this.needSave=!0,this.plugin.settings.cMenuNumRows=t,yield this.plugin.saveSettings(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100)}))),100,!0)).setDynamicTooltip();o.createDiv({cls:"reset-container"}).createEl("button",{text:g("Reset"),cls:"reset-button"}).addEventListener("click",(()=>{this.needSave=!0,f.setValue(0),b.setValue(0),v.setValue(12),this.plugin.settings.verticalPosition=0,this.plugin.settings.horizontalPosition=0,this.plugin.settings.cMenuNumRows=12,d(this.plugin.settings),h(this.plugin.settings)}))}onClose(){return e(this,void 0,void 0,(function*(){const{contentEl:t}=this;t.empty(),this.needSave&&(yield this.plugin.saveSettings())}))}}const w=["body","workspace"],C=["glass","default","tiny"],k=["fixed","following","top"],x={lastVersion:"0.0.0",aestheticStyle:"default",positionStyle:"top",menuCommands:[{id:"editing-toolbar:editor-undo",name:"Undo editor",icon:"undo-glyph"},{id:"editing-toolbar:editor-redo",name:"Redo editor",icon:"redo-glyph"},{id:"editing-toolbar:toggle-format-brush",name:"Format Brush",icon:"paintbrush"},{id:"editing-toolbar:format-eraser",name:"Clear text formatting",icon:"eraser"},{id:"editing-toolbar:header2-text",name:"Header 2",icon:"header-2"},{id:"editing-toolbar:header3-text",name:"Header 3",icon:"header-3"},{id:"SubmenuCommands-header",name:"submenu",icon:"header-n",SubmenuCommands:[{id:"editing-toolbar:header1-text",name:"Header 1",icon:"header-1"},{id:"editing-toolbar:header4-text",name:"Header 4",icon:"header-4"},{id:"editing-toolbar:header5-text",name:"Header 5",icon:"header-5"},{id:"editing-toolbar:header6-text",name:"Header 6",icon:"header-6"}]},{id:"editing-toolbar:toggle-bold",name:"Bold",icon:"bold-glyph"},{id:"editing-toolbar:toggle-italics",name:"Italics",icon:"italic-glyph"},{id:"editing-toolbar:toggle-strikethrough",name:"Strikethrough",icon:"strikethrough-glyph"},{id:"editing-toolbar:underline",name:"Underline",icon:"underline-glyph"},{id:"editing-toolbar:toggle-highlight",name:"==Highlight==",icon:"highlight-glyph"},{id:"SubmenuCommands-lucdf3en5",name:"submenu",icon:"edit",SubmenuCommands:[{id:"editing-toolbar:editor-copy",name:"Copy",icon:"lucide-copy"},{id:"editing-toolbar:editor-cut",name:"Cut",icon:"lucide-scissors"},{id:"editing-toolbar:editor-paste",name:"Paste",icon:"lucide-clipboard-type"},{id:"editing-toolbar:editor:swap-line-down",name:"Swap line down",icon:"lucide-corner-right-down"},{id:"editing-toolbar:editor:swap-line-up",name:"Swap line up",icon:"lucide-corner-right-up"}]},{id:"editing-toolbar:editor:attach-file",name:"Attach file",icon:"lucide-paperclip"},{id:"editing-toolbar:editor:insert-table",name:"Insert Table",icon:"lucide-table"},{id:"editing-toolbar:editor:cycle-list-checklist",name:"Cycle list checklist",icon:"check-circle"},{id:"SubmenuCommands-luc8efull",name:"submenu",icon:"message-square",SubmenuCommands:[{id:"editing-toolbar:editor:toggle-blockquote",name:"Blockquote",icon:"lucide-text-quote"},{id:"editing-toolbar:insert-callout",name:"Insert Callout ",icon:"lucide-quote"}]},{id:"SubmenuCommands-mdcmder",name:"submenu",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M464 608 l0 -568 q0 -3 -2.5 -5.5 q-2.5 -2.5 -5.5 -2.5 l-80 0 q-3 0 -5.5 2.5 q-2.5 2.5 -2.5 5.5 l0 568 l-232 0 q-3 0 -5.5 2.5 q-2.5 2.5 -2.5 5.5 l0 80 q0 3 2.5 5.5 q2.5 2.5 5.5 2.5 l560 0 q3 0 5.5 -2.5 q2.5 -2.5 2.5 -5.5 l0 -80 q0 -3 -2.5 -5.5 q-2.5 -2.5 -5.5 -2.5 l-232 0 ZM864 696 q17 0 28.5 11.5 q11.5 11.5 11.5 28.5 q0 17 -11.5 28.5 q-11.5 11.5 -28.5 11.5 q-17 0 -28.5 -11.5 q-11.5 -11.5 -11.5 -28.5 q0 -17 11.5 -28.5 q11.5 -11.5 28.5 -11.5 ZM864 640 q-40 0 -68 28 q-28 28 -28 68 q0 40 28 68 q28 28 68 28 q40 0 68 -28 q28 -28 28 -68 q0 -40 -28 -68 q-28 -28 -68 -28 ZM576 322 l0 -63 q0 -3 2 -5 l89 -70 l-89 -70 q-2 -2 -2 -5 l0 -63 q0 -4 3.5 -5.5 q3.5 -1.5 6.5 0.5 l170 133 q4 3 4.5 8.5 q0.5 5.5 -2.5 9.5 l-2 2 l-170 133 q-3 2 -6.5 0.5 q-3.5 -1.5 -3.5 -5.5 ZM256 322 l0 -63 q0 -3 -2 -5 l-89 -70 l89 -70 q2 -2 2 -5 l0 -63 q0 -4 -3.5 -5.5 q-3.5 -1.5 -6.5 0.5 l-170 133 q-4 3 -4.5 8.5 q-0.5 5.5 2.5 9.5 l2 2 l170 133 q3 2 6.5 0.5 q3.5 -1.5 3.5 -5.5 Z"></path></g></svg>',SubmenuCommands:[{id:"editing-toolbar:superscript",name:"Superscript",icon:"superscript-glyph"},{id:"editing-toolbar:subscript",name:"Subscript",icon:"subscript-glyph"},{id:"editing-toolbar:editor:toggle-code",name:"Inline code",icon:"code-glyph"},{id:"editing-toolbar:codeblock",name:"Code block",icon:"codeblock-glyph"},{id:"editing-toolbar:editor:insert-wikilink",name:"Insert wikilink [[]]",icon:'<svg width="15" height="15" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M306 134 l91 0 q1 0 1 -8 l0 -80 q0 -8 -1 -8 l-91 0 q-1 0 -1 7 q0 -8 -5 -8 l-45 0 q-5 0 -5 8 l0 784 q0 8 5 8 l45 0 q5 0 5 -8 q0 8 1 8 l91 0 q1 0 1 -8 l0 -80 q0 -8 -1 -8 l-91 0 q-1 0 -1 8 l0 -623 q0 8 1 8 ZM139 134 l91 0 q1 0 1 -8 l0 -80 q0 -8 -1 -8 l-91 0 q-1 0 -1 7 q0 -8 -5 -8 l-45 0 q-5 0 -5 8 l0 784 q0 8 5 8 l45 0 q5 0 5 -8 q0 8 1 8 l91 0 q1 0 1 -8 l0 -80 q0 -8 -1 -8 l-91 0 q-1 0 -1 8 l0 -623 q0 8 1 8 ZM711 134 q1 0 1 -8 l0 623 q0 -8 -1 -8 l-91 0 q-1 0 -1 8 l0 80 q0 8 1 8 l91 0 q1 0 1 -8 q0 8 4 8 l46 0 q4 0 4 -8 l0 -784 q0 -8 -4 -8 l-46 0 q-4 0 -4 8 q0 -7 -1 -7 l-91 0 q-1 0 -1 8 l0 80 q0 8 1 8 l91 0 ZM878 134 q1 0 1 -8 l0 623 q0 -8 -1 -8 l-91 0 q-1 0 -1 8 l0 80 q0 8 1 8 l91 0 q1 0 1 -8 q0 8 5 8 l45 0 q4 0 4 -8 l0 -784 q0 -8 -4 -8 l-45 0 q-5 0 -5 8 q0 -7 -1 -7 l-91 0 q-1 0 -1 8 l0 80 q0 8 1 8 l91 0 Z"></path></g></svg>'},{id:"editing-toolbar:editor:insert-embed",name:"Insert embed ![[]]",icon:"note-glyph"},{id:"editing-toolbar:editor:insert-link",name:"Insert link []()",icon:"link-glyph"},{id:"editing-toolbar:hrline",name:"Horizontal divider",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M912 424 l0 -80 q0 -3 -2.5 -5.5 q-2.5 -2.5 -5.5 -2.5 l-784 0 q-3 0 -5.5 2.5 q-2.5 2.5 -2.5 5.5 l0 80 q0 3 2.5 5.5 q2.5 2.5 5.5 2.5 l784 0 q3 0 5.5 -2.5 q2.5 -2.5 2.5 -5.5 Z"></path></g></svg>'},{id:"editing-toolbar:editor:toggle-inline-math",name:"Inline math",icon:"lucide-sigma"},{id:"editing-toolbar:editor:insert-mathblock",name:"MathBlock",icon:"lucide-sigma-square"}]},{id:"SubmenuCommands-list",name:"submenu-list",icon:"bullet-list-glyph",SubmenuCommands:[{id:"editing-toolbar:editor:toggle-checklist-status",name:"Checklist",icon:"checkbox-glyph"},{id:"editing-toolbar:toggle-numbered-list",name:"Numbered list",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M860 424 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-457 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l457 0 ZM860 756 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-457 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l457 0 ZM860 92 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-457 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l457 0 ZM264 136 l-3 -3 l-51 -57 l56 0 q14 0 24.5 -10 q10.5 -10 11.5 -25 l0 -1 q0 -15 -10.5 -25.5 q-10.5 -10.5 -24.5 -10.5 l-137 0 q-15 0 -25 10 q-10 10 -11 24.5 q-1 14.5 9 25.5 l63 70 l49 54 q7 7 7 16.5 q0 9.5 -7.5 16.5 q-7.5 7 -18.5 7 q-11 0 -18.5 -6.5 q-7.5 -6.5 -8.5 -16.5 l0 0 q0 -15 -10.5 -25.5 q-10.5 -10.5 -25.5 -10.5 q-15 0 -25.5 10.5 q-10.5 10.5 -10.5 25.5 q0 26 13.5 47.5 q13.5 21.5 36 34.5 q22.5 13 49 13 q26.5 0 49.5 -13 q23 -13 36 -34.5 q13 -21.5 13 -47.5 q0 -20 -7.5 -37.5 q-7.5 -17.5 -21.5 -30.5 l-1 -1 ZM173 794 q11 11 25 10.5 q14 -0.5 24.5 -10.5 q10.5 -10 10.5 -25 l0 -293 q0 -15 -10 -25.5 q-10 -10.5 -25 -10.5 q-15 0 -25.5 10 q-10.5 10 -11.5 25 l0 211 q-10 -8 -23.5 -7 q-13.5 1 -22.5 11 l-1 0 q-10 11 -9.5 25.5 q0.5 14.5 10.5 24.5 l58 54 Z"></path></g></svg>'},{id:"editing-toolbar:toggle-bullet-list",name:"Bullet list",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M860 424 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-477 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l477 0 ZM860 756 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-477 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l477 0 ZM860 92 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-477 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l477 0 ZM176 716 l0 0 ZM112 716 q0 -27 18.5 -45.5 q18.5 -18.5 45.5 -18.5 q27 0 45.5 18.5 q18.5 18.5 18.5 45.5 q0 27 -18.5 45.5 q-18.5 18.5 -45.5 18.5 q-27 0 -45.5 -18.5 q-18.5 -18.5 -18.5 -45.5 ZM176 384 l0 0 ZM112 384 q0 -27 18.5 -45.5 q18.5 -18.5 45.5 -18.5 q27 0 45.5 18.5 q18.5 18.5 18.5 45.5 q0 27 -18.5 45.5 q-18.5 18.5 -45.5 18.5 q-27 0 -45.5 -18.5 q-18.5 -18.5 -18.5 -45.5 ZM176 52 l0 0 ZM112 52 q0 -27 18.5 -45.5 q18.5 -18.5 45.5 -18.5 q27 0 45.5 18.5 q18.5 18.5 18.5 45.5 q0 27 -18.5 45.5 q-18.5 18.5 -45.5 18.5 q-27 0 -45.5 -18.5 q-18.5 -18.5 -18.5 -45.5 Z"></path></g></svg>'},{id:"editing-toolbar:undent-list",name:"Unindent-list",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M872 302 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-429 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l429 0 ZM872 542 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-429 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l429 0 ZM872 784 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM872 62 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM244 534 l-123 -122 q-8 -7 -8 -18 q0 -11 8 -18 l123 -122 q8 -7 19 -7 q11 0 18.5 7.5 q7.5 7.5 7.5 18.5 l0 242 q0 11 -7.5 18.5 q-7.5 7.5 -18.5 7.5 q-11 0 -19 -7 Z"></path></g></svg>'},{id:"editing-toolbar:indent-list",name:"Indent list",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M872 302 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-429 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l429 0 ZM872 542 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-429 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l429 0 ZM872 784 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM872 62 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM158 534 l124 -122 q7 -7 7 -18 q0 -11 -7 -18 l-124 -122 q-7 -7 -18 -7 q-11 0 -19 7.5 q-8 7.5 -8 18.5 l0 242 q0 11 8 18.5 q8 7.5 19 7.5 q11 0 18 -7 Z"></path></g></svg>'}]},{id:"SubmenuCommands-aligin",name:"submenu-aligin",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M724 304 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 540 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM724 776 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 68 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 Z"></path></g></svg>',SubmenuCommands:[{id:"editing-toolbar:justify",name:'<p aligin="justify"></p>',icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M112 736 l0 0 ZM120 736 l784 0 q8 0 8 -8 l0 -80 q0 -8 -8 -8 l-784 0 q-8 0 -8 8 l0 80 q0 8 8 8 ZM112 331 l0 0 ZM120 331 l784 0 q8 0 8 -8 l0 -80 q0 -8 -8 -8 l-784 0 q-8 0 -8 8 l0 80 q0 8 8 8 ZM112 128 l0 0 ZM120 128 l784 0 q8 0 8 -8 l0 -80 q0 -8 -8 -8 l-784 0 q-8 0 -8 8 l0 80 q0 8 8 8 ZM112 533 l0 0 ZM120 533 l784 0 q8 0 8 -8 l0 -80 q0 -8 -8 -8 l-784 0 q-8 0 -8 8 l0 80 q0 8 8 8 Z"></path></g></svg>'},{id:"editing-toolbar:left",name:'<p aligin="left"></p>',icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M572 304 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 540 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM572 776 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 68 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 Z"></path></g></svg>'},{id:"editing-toolbar:center",name:"<center>",icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M724 304 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 540 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM724 776 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 68 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 Z"></path></g></svg>'},{id:"editing-toolbar:right",name:'<p aligin="right"></p>',icon:'<svg width="18" height="18" focusable="false" fill="currentColor"  viewBox="0 0 1024 1024"><g transform="scale(1, -1) translate(0, -896) scale(0.9, 0.9) "><path class="path" d="M872 304 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 540 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 ZM872 776 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-421 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l421 0 ZM872 68 q17 0 28.5 -11.5 q11.5 -11.5 11.5 -28 q0 -16.5 -11.5 -28.5 q-11.5 -12 -27.5 -12 l-721 0 q-17 0 -28.5 11.5 q-11.5 11.5 -11.5 28 q0 16.5 11.5 28.5 q11.5 12 27.5 12 l721 0 Z"></path></g></svg>'}]},{id:"editing-toolbar:change-font-color",name:"Change font color[html]",icon:'<svg width="24" height="24" focusable="false" fill="currentColor"><g fill-rule="evenodd"><path id="change-font-color-icon" d="M3 18h18v3H3z" style="fill:#2DC26B"></path><path d="M8.7 16h-.8a.5.5 0 01-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 01-.5.6h-.8a.5.5 0 01-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 00.5.6h1.6a.5.5 0 00.5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z"></path></g></svg>'},{id:"editing-toolbar:change-background-color",name:"Change Backgroundcolor[html]",icon:'<svg width="18" height="24" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg"><g   stroke="none" stroke-width="1" fill="currentColor" fill-rule="evenodd"><g  ><g fill="currentColor"><g transform="translate(119.502295, 137.878331) rotate(-135.000000) translate(-119.502295, -137.878331) translate(48.002295, 31.757731)" ><path d="M100.946943,60.8084699 L43.7469427,60.8084699 C37.2852111,60.8084699 32.0469427,66.0467383 32.0469427,72.5084699 L32.0469427,118.70847 C32.0469427,125.170201 37.2852111,130.40847 43.7469427,130.40847 L100.946943,130.40847 C107.408674,130.40847 112.646943,125.170201 112.646943,118.70847 L112.646943,72.5084699 C112.646943,66.0467383 107.408674,60.8084699 100.946943,60.8084699 Z M93.646,79.808 L93.646,111.408 L51.046,111.408 L51.046,79.808 L93.646,79.808 Z" fill-rule="nonzero"></path><path d="M87.9366521,16.90916 L87.9194966,68.2000001 C87.9183543,69.4147389 86.9334998,70.399264 85.7187607,70.4 L56.9423078,70.4 C55.7272813,70.4 54.7423078,69.4150264 54.7423078,68.2 L54.7423078,39.4621057 C54.7423078,37.2523513 55.5736632,35.1234748 57.0711706,33.4985176 L76.4832996,12.4342613 C78.9534987,9.75382857 83.1289108,9.5834005 85.8093436,12.0535996 C87.1658473,13.303709 87.9372691,15.0644715 87.9366521,16.90916 Z" fill-rule="evenodd"></path><path d="M131.3,111.241199 L11.7,111.241199 C5.23826843,111.241199 0,116.479467 0,122.941199 L0,200.541199 C0,207.002931 5.23826843,212.241199 11.7,212.241199 L131.3,212.241199 C137.761732,212.241199 143,207.002931 143,200.541199 L143,122.941199 C143,116.479467 137.761732,111.241199 131.3,111.241199 Z M124,130.241 L124,193.241 L19,193.241 L19,130.241 L124,130.241 Z" fill-rule="nonzero"></path></g></g><path d="M51,218 L205,218 C211.075132,218 216,222.924868 216,229 C216,235.075132 211.075132,240 205,240 L51,240 C44.9248678,240 40,235.075132 40,229 C40,222.924868 44.9248678,218 51,218 Z" id="change-background-color-icon" style="fill:#FA541C"></path></g></g></svg>'},{id:"editing-toolbar:fullscreen-focus",name:"Fullscreen focus mode",icon:"fullscreen"},{id:"editing-toolbar:workplace-fullscreen-focus",name:"Workplace-Fullscreen ",icon:"exit-fullscreen"}],appendMethod:"workspace",shouldShowMenuOnSelect:!1,cMenuVisibility:!0,cMenuBottomValue:4.25,cMenuNumRows:12,cMenuWidth:610,cMenuFontColor:"#2DC26B",cMenuBackgroundColor:"#d3f8b6",autohide:!1,custom_bg1:"#FFB78B8C",custom_bg2:"#CDF4698C",custom_bg3:"#A0CCF68C",custom_bg4:"#F0A7D88C",custom_bg5:"#ADEFEF8C",custom_fc1:"#D83931",custom_fc2:"#DE7802",custom_fc3:"#245BDB",custom_fc4:"#6425D0",custom_fc5:"#646A73",isLoadOnMobile:!1,horizontalPosition:0,verticalPosition:0,formatBrushes:{},customCommands:[]};class T{static isAllowedViewType(t,e){if(!t)return!1;const i=["markdown","canvas","thino_view","meld-encrypted-view","excalidraw"];return"markdown"===t.getViewType()||i.includes(t.getViewType())}static isSourceMode(t){var e;return!!t&&"source"===(null===(e=t.getMode)||void 0===e?void 0:e.call(t))}}let E;function S(){E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;const e=E.getElementById("editingToolbarModalBar");e&&e.remove();const i=function(){const e=[];e.push(app.workspace.rootSplit);const i=app.workspace.floatingSplit;return null==i||i.children.forEach((i=>{i instanceof t.WorkspaceWindow&&e.push(i)})),e}();i&&i.forEach((t=>{(null==t?void 0:t.containerEl)&&(t=>{let e=t.querySelectorAll("#editingToolbarModalBar"),i=t.querySelectorAll("#editingToolbarPopoverBar");e.forEach((t=>{t&&(t.firstChild&&t.removeChild(t.firstChild),t.remove())})),i.forEach((t=>{t&&(t.firstChild&&t.removeChild(t.firstChild),t.remove())}))})(null==t?void 0:t.containerEl)}))}function q(e,i){var o,n;E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;let s="top"==i.positionStyle?null===(n=null===(o=e.workspace.activeLeaf)||void 0===o?void 0:o.view.containerEl)||void 0===n?void 0:n.querySelector("#editingToolbarModalBar"):E.getElementById("editingToolbarModalBar");return s||null}const _=(t,e)=>e.reduce(((t,e)=>t&&"undefined"!==t[e]?t[e]:void 0),t);function M(t,e){return t&&void 0!==t[1][0]?e+t.flat(2).join("+").replace("Mod","Ctrl")+e:e+"â€“"+e}function A(t,e,i=!0){let o=t.commands.findCommand(e),n=i?"*":"";if(o){let e=o.hotkeys?[[_(o.hotkeys,[0,"modifiers"])],[_(o.hotkeys,[0,"key"])]]:void 0,i=t.hotkeyManager.customKeys[o.id];var s=i?[[_(i,[0,"modifiers"])],[_(i,[0,"key"])]]:void 0;return s?M(s,n):M(e,"")}return"â€“"}function B(t){return/<[^>]+>/g.test(t)}function I(e,i,o){E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;const n=i.commandsManager.getActiveEditor();let s=q(e,i.settings),l=null==s?void 0:s.querySelector("#"+o);if(l){let t=l.rows,e=t.length;for(let s=1;s<e;s++){let e=t[s].cells;for(let t=0;t<e.length;t++)e[t].onclick=function(){let t=this.style.backgroundColor;if(""!=t){if(t=D(t),"x-color-picker-table"==o){i.settings.cMenuFontColor=t,a(t,n),E.querySelectorAll("#change-font-color-icon").forEach((e=>{e.style.fill=t}))}else if("x-backgroundcolor-picker-table"==o){i.settings.cMenuBackgroundColor=t,r(t,n),E.querySelectorAll("#change-background-color-icon").forEach((e=>{e.style.fill=t}))}i.saveSettings()}}}}}const D=function(t){let e=t;if(/^(rgb|RGB)/.test(e)){let t=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),i="#";for(let e=0;e<t.length;e++){let o=Number(t[e]).toString(16);"0"===o&&(o+=o),1==o.length&&(o="0"+o),i+=o}return 7!==i.length&&(i=e),i}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e))return e;{let t=e.replace(/#/,"").split("");if(6===t.length)return e;if(3===t.length){let e="#";for(let i=0;i<t.length;i+=1)e+=t[i]+t[i];return e}}};function L(t){t.quiteAllFormatBrushes()}function N(t,e){let i=e.getSelection();if(!i||""===i.trim())return;if(i.match(/^>\s*\[\![\w\s]*\]/m)){let t=i.split("\n"),o=[],n=!1,s=0,a=!1;for(let e=0;e<t.length;e++){let i=t[e],r=i.match(/^(>+)\s*\[\!([\w\s]*)\]\s*(.*?)$/);if(!r||a)if(n){let t=i.match(/^(>+)\s*/);if(t&&t[1].length>=s){let t=i.replace(new RegExp(`^>{${s}}\\s*`),"");o.push(t)}else n=!1,o.push(i)}else o.push(i);else s=r[1].length,a=!0,r[3].trim()&&o.push(r[3].trim()),n=!0}return void e.replaceSelection(o.join("\n"))}i=i.replace(/(^#+\s|^#(?=\s)|^\>|^\- \[( |x)\]|^\+ |\<[^\<\>]+?\>|^1\. |^\s*\- |^\-+$|^\*+$)/gm,""),i=i.replace(/^[ ]+|[ ]+$/gm,""),i=i.replace(/\!?\[\[([^\[\]\|]*\|)*([^\(\)\[\]]+)\]\]/g,"$2"),i=i.replace(/\!?\[+([^\[\]\(\)]+)\]+\(([^\(\)]+)\)/g,"$1"),i=i.replace(/`([^`]+)`/g,"$1"),i=i.replace(/_([^_]+)_/g,"$1"),i=i.replace(/==([^=]+)==/g,"$1"),i=i.replace(/\*\*\*([^\*]+)\*\*\*/g,"$1"),i=i.replace(/\*\*?([^\*]+)\*\*?/g,"$1"),i=i.replace(/~~([^~]+)~~/g,"$1"),e.replaceSelection(i)}function O(e,i,o){var n,s,a,r;let l=q(e,i);const c=e.workspace.getActiveViewOfType(t.ItemView);if(T.isAllowedViewType(c))if(T.isSourceMode(c)){if(l&&(l.style.visibility=o.somethingSelected()?"visible":"hidden",l.style.height="tiny"===i.aestheticStyle?"30px":"40px",l.addClass("editingToolbarFlex"),l.removeClass("editingToolbarGrid"),"visible"===l.style.visibility)){const t=o.containerEl.getBoundingClientRect(),e=l.offsetWidth,i=l.offsetHeight,c=(t=>{var e,i,o;let n,s=t.getCursor("head");if(t.getCursor("head").ch!==t.getCursor("from").ch&&(s.ch=Math.max(0,s.ch-1)),t.cursorCoords)n=t.cursorCoords(!0,"window");else{if(!t.coordsAtPos)return;{const a=t.posToOffset(s);n=null!==(o=null===(i=(e=t.cm).coordsAtPos)||void 0===i?void 0:i.call(e,a))&&void 0!==o?o:t.coordsAtPos(a)}}return n})(o),d=o.getCursor("head").ch==o.getCursor("from").ch,h=12,u=(null!==(s=null===(n=E.getElementsByClassName("mod-left-split")[0])||void 0===n?void 0:n.clientWidth)&&void 0!==s?s:0)+(null!==(r=null===(a=E.getElementsByClassName("side-dock-ribbon mod-left")[0])||void 0===a?void 0:a.clientWidth)&&void 0!==r?r:0);let p=c.left-u;p+e+h>=t.right&&(p=Math.max(0,t.right-e-u-h));let g=0;d?(g=c.top-i-10,g<=t.top&&(g=t.top+i)):(g=c.top+25,g>=t.bottom-i&&(g=t.bottom-2*i)),l.style.left=p+"px",l.style.top=g+"px"}}else l.style.visibility="hidden";else l&&(l.style.visibility="hidden")}function F(e,i){let o=i.settings;E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document,function(){const n=()=>{var n,s;let a=0,r=0,l=createEl("div");l&&("top"==o.positionStyle?(l.setAttribute("style","position: relative; grid-template-columns: repeat(auto-fit, minmax(28px, 1fr));"),l.className+=" top",o.autohide&&(l.className+=" autohide")):"following"==o.positionStyle&&(l.style.visibility="hidden")),l.setAttribute("id","editingToolbarModalBar");let c=createEl("div");if(c.addClass("editingToolbarpopover"),c.addClass("editingToolbarTinyAesthetic"),c.setAttribute("id","editingToolbarPopoverBar"),c.style.visibility="hidden",c.style.height="0","default"==o.aestheticStyle?(l.addClass("editingToolbarDefaultAesthetic"),l.removeClass("editingToolbarTinyAesthetic"),l.removeClass("editingToolbarGlassAesthetic")):"tiny"==o.aestheticStyle?(l.addClass("editingToolbarTinyAesthetic"),l.removeClass("editingToolbarDefaultAesthetic"),l.removeClass("editingToolbarGlassAesthetic")):(l.addClass("editingToolbarGlassAesthetic"),l.removeClass("editingToolbarTinyAesthetic"),l.removeClass("editingToolbarDefaultAesthetic")),"top"==o.positionStyle){let t=e.workspace.activeLeaf.view.containerEl;const i=null==t?void 0:t.querySelector(".markdown-source-view"),o=null==t?void 0:t.querySelector(".canvas-wrapper"),n=null==t?void 0:t.querySelector(".excalidraw-wrapper"),s=i||o||n;if(!s)return;(null==t?void 0:t.querySelector("#editingToolbarPopoverBar"))||s.insertAdjacentElement("afterbegin",c),s.insertAdjacentElement("afterbegin",l),r=null==s?void 0:s.offsetWidth}else"body"==o.appendMethod?E.body.appendChild(l):"workspace"==o.appendMethod&&(null===(n=E.body)||void 0===n||n.querySelector(".mod-vertical.mod-root").insertAdjacentElement("afterbegin",l));let d=null===(s=e.workspace.activeLeaf.view.containerEl)||void 0===s?void 0:s.querySelector("#editingToolbarPopoverBar");o.menuCommands.forEach(((n,s)=>{let c;if("SubmenuCommands"in n){let h;a>=r-104&&r>100?(i.setIS_MORE_Button(!0),h=new t.ButtonComponent(d)):h=new t.ButtonComponent(l),h.setClass("editingToolbarCommandsubItem"+s),s>=o.cMenuNumRows?h.setClass("editingToolbarSecond"):"top"!=o.positionStyle&&h.buttonEl.setAttribute("aria-label-position","top"),B(n.icon)?h.buttonEl.innerHTML=n.icon:h.setIcon(n.icon),a+=28;let u=function(t){let e=createEl("div");return e.addClass(t),e}("subitem");u&&n.SubmenuCommands.forEach((i=>{let n=A(e,i.id);c="â€“"==n?i.name:i.name+"("+n+")";let a=new t.ButtonComponent(u).setTooltip(c).setClass("menu-item").onClick((()=>{e.commands.executeCommandById(i.id),0==o.cMenuVisibility||"following"==o.positionStyle?l.style.visibility="hidden":l.style.visibility="visible"}));s<o.cMenuNumRows&&"top"!=o.positionStyle&&a.buttonEl.setAttribute("aria-label-position","top"),"editingToolbar-Divider-Line"==i.id&&a.setClass("editingToolbar-Divider-Line"),B(i.icon)?a.buttonEl.innerHTML=i.icon:a.setIcon(i.icon),h.buttonEl.insertAdjacentElement("afterbegin",u)}))}else if("editing-toolbar:change-font-color"==n.id){let s=new t.ButtonComponent(l);s.setClass("editingToolbarCommandsubItem-font-color").setTooltip(g("Font Colors")).onClick((()=>{e.commands.executeCommandById(n.id),0==o.cMenuVisibility||"following"==o.positionStyle?l.style.visibility="hidden":l.style.visibility="visible"})),B(n.icon)?s.buttonEl.innerHTML=n.icon:s.setIcon(n.icon),a+=26;let r=createEl("div");if(r.addClass("subitem"),r){r.innerHTML=function(t){return`<div class='x-color-picker-wrapper'>\n<div class='x-color-picker' >\n  <table class="x-color-picker-table" id='x-color-picker-table'>\n    <tbody>\n      <tr>\n        <th colspan="10" class="ui-widget-content">Theme Colors</th>\n      </tr>\n      <tr>\n        <td style="background-color:#ffffff"><span></span></td>\n        <td style="background-color:#000000"><span></span></td>\n        <td style="background-color:#eeece1"><span></span></td>\n        <td style="background-color:#1f497d"><span></span></td>\n        <td style="background-color:#4f81bd"><span></span></td>\n        <td style="background-color:#c0504d"><span></span></td>\n        <td style="background-color:#9bbb59"><span></span></td>\n        <td style="background-color:#8064a2"><span></span></td>\n        <td style="background-color:#4bacc6"><span></span></td>\n        <td style="background-color:#f79646"><span></span></td>\n      </tr>\n      <tr>\n        <th colspan="10"></th>\n      </tr>\n      <tr class="top">\n        <td style="background-color:#f2f2f2"><span></span></td>\n        <td style="background-color:#7f7f7f"><span></span></td>\n        <td style="background-color:#ddd9c3"><span></span></td>\n        <td style="background-color:#c6d9f0"><span></span></td>\n        <td style="background-color:#dbe5f1"><span></span></td>\n        <td style="background-color:#f2dcdb"><span></span></td>\n        <td style="background-color:#ebf1dd"><span></span></td>\n        <td style="background-color:#e5e0ec"><span></span></td>\n        <td style="background-color:#dbeef3"><span></span></td>\n        <td style="background-color:#fdeada"><span></span></td>\n      </tr>\n      <tr class="in">\n        <td style="background-color:#d8d8d8"><span></span></td>\n        <td style="background-color:#595959"><span></span></td>\n        <td style="background-color:#c4bd97"><span></span></td>\n        <td style="background-color:#8db3e2"><span></span></td>\n        <td style="background-color:#b8cce4"><span></span></td>\n        <td style="background-color:#e5b9b7"><span></span></td>\n        <td style="background-color:#d7e3bc"><span></span></td>\n        <td style="background-color:#ccc1d9"><span></span></td>\n        <td style="background-color:#b7dde8"><span></span></td>\n        <td style="background-color:#fbd5b5"><span></span></td>\n      </tr>\n      <tr class="in">\n        <td style="background-color:#bfbfbf"><span></span></td>\n        <td style="background-color:#3f3f3f"><span></span></td>\n        <td style="background-color:#938953"><span></span></td>\n        <td style="background-color:#548dd4"><span></span></td>\n        <td style="background-color:#95b3d7"><span></span></td>\n        <td style="background-color:#d99694"><span></span></td>\n        <td style="background-color:#c3d69b"><span></span></td>\n        <td style="background-color:#b2a2c7"><span></span></td>\n        <td style="background-color:#92cddc"><span></span></td>\n        <td style="background-color:#fac08f"><span></span></td>\n      </tr>\n      <tr class="in">\n        <td style="background-color:#a5a5a5"><span></span></td>\n        <td style="background-color:#262626"><span></span></td>\n        <td style="background-color:#494429"><span></span></td>\n        <td style="background-color:#17365d"><span></span></td>\n        <td style="background-color:#366092"><span></span></td>\n        <td style="background-color:#953734"><span></span></td>\n        <td style="background-color:#76923c"><span></span></td>\n        <td style="background-color:#5f497a"><span></span></td>\n        <td style="background-color:#31859b"><span></span></td>\n        <td style="background-color:#e36c09"><span></span></td>\n      </tr>\n      <tr class="bottom">\n        <td style="background-color:#7f7f7f"><span></span></td>\n        <td style="background-color:#0c0c0c"><span></span></td>\n        <td style="background-color:#1d1b10"><span></span></td>\n        <td style="background-color:#0f243e"><span></span></td>\n        <td style="background-color:#244061"><span></span></td>\n        <td style="background-color:#632423"><span></span></td>\n        <td style="background-color:#4f6128"><span></span></td>\n        <td style="background-color:#3f3151"><span></span></td>\n        <td style="background-color:#205867"><span></span></td>\n        <td style="background-color:#974806"><span></span></td>\n      </tr>\n       <tr>\n        <th colspan="10"></th>\n      </tr>\n      <tr>\n        <th colspan="10" class="ui-widget-content">Standard Colors</th>\n      </tr>\n      <tr>\n        <td style="background-color:#c00000"><span></span></td>\n        <td style="background-color:#ff0000"><span></span></td>\n        <td style="background-color:#ffc000"><span></span></td>\n        <td style="background-color:#ffff00"><span></span></td>\n        <td style="background-color:#92d050"><span></span></td>\n        <td style="background-color:#00b050"><span></span></td>\n        <td style="background-color:#00b0f0"><span></span></td>\n        <td style="background-color:#0070c0"><span></span></td>\n        <td style="background-color:#002060"><span></span></td>\n        <td style="background-color:#7030a0"><span></span></td>\n      </tr>\n      <tr>\n      <th colspan="10" class="ui-widget-content">Custom Font Colors</th>\n    </tr>\n    <tr>\n      <td style="background-color:${t.settings.custom_fc1}"><span></span></td>\n      <td style="background-color:${t.settings.custom_fc2}"><span></span></td>\n      <td style="background-color:${t.settings.custom_fc3}"><span></span></td>\n      <td style="background-color:${t.settings.custom_fc4}"><span></span></td>\n      <td style="background-color:${t.settings.custom_fc5}"><span></span></td>\n    </tr>\n    </tbody>\n  </table>\n</div>\n</div>`}(i),s.buttonEl.insertAdjacentElement("afterbegin",r),I(e,i,"x-color-picker-table");let o=r.querySelector(".x-color-picker-wrapper");new t.ButtonComponent(o).setIcon("paintbrush").setTooltip(g("Format Brush")).onClick((()=>{L(i),i.setEN_FontColor_Format_Brush(!0),i.Temp_Notice=new t.Notice(g("Font-Color formatting brush ON!"),0)})),new t.ButtonComponent(o).setIcon("palette").setTooltip(g("Custom Font Color")).onClick((()=>{e.setting.open(),e.setting.openTabById("editing-toolbar"),setTimeout((()=>{const t=e.setting.activeTab.containerEl.querySelector(".editing-toolbar-tabs");if(t){const i=t.children[1];null==i||i.click(),setTimeout((()=>{var t;let i=e.setting.activeTab.containerEl.querySelector(".custom_font");i&&(null===(t=i.addClass)||void 0===t||t.call(i,"toolbar-cta"))}),100)}}),200)}))}}else if("editing-toolbar:change-background-color"==n.id){let s=new t.ButtonComponent(l);s.setClass("editingToolbarCommandsubItem-font-color").setTooltip(g("Background color")).onClick((()=>{e.commands.executeCommandById(n.id),0==o.cMenuVisibility||"following"==o.positionStyle?l.style.visibility="hidden":l.style.visibility="visible"})),B(n.icon)?s.buttonEl.innerHTML=n.icon:s.setIcon(n.icon),a+=26;let r=createEl("div");if(r.addClass("subitem"),r){r.innerHTML=function(t){return`<div class='x-color-picker-wrapper'>\n<div class='x-color-picker' >\n  <table class="x-color-picker-table" id='x-backgroundcolor-picker-table'>\n    <tbody>\n      <tr>\n        <th colspan="5" class="ui-widget-content">Translucent Colors</th>\n      </tr>\n      <tr class="top">\n        <td style="background-color:rgba(140, 140, 140, 0.12)"><span></span></td>\n        <td style="background-color:rgba(92, 92, 92, 0.2)"><span></span></td>\n        <td style="background-color:rgba(163, 67, 31, 0.2)"><span></span></td>\n        <td style="background-color:rgba(240, 107, 5, 0.2)"><span></span></td>\n        <td style="background-color:rgba(240, 200, 0, 0.2)"><span></span></td>\n        </tr>\n        <tr class="bottom">\n        <td style="background-color:rgba(3, 135, 102, 0.2)"><span></span></td>\n        <td style="background-color:rgba(3, 135, 102, 0.2)"><span></span></td>\n        <td style="background-color:rgba(5, 117, 197, 0.2)"><span></span></td>\n        <td style="background-color:rgba(74, 82, 199, 0.2)"><span></span></td>\n        <td style="background-color:rgba(136, 49, 204, 0.2)"><span></span></td>\n      </tr>\n\n      <tr>\n      <th colspan="5" class="ui-widget-content">Highlighter Colors</th>\n    </tr>\n    \n    <tr class="top">\n      <td style="background-color:rgb(255, 248, 143)"><span></span></td>\n      <td style="background-color:rgb(211, 248, 182)"><span></span></td>\n      <td style="background-color:rgb(175, 250, 209)"><span></span></td>\n      <td style="background-color:rgb(177, 255, 255)"><span></span></td>\n      <td style="background-color:rgb(253, 191, 255)"><span></span></td>\n      </tr>\n      <tr class="bottom">\n      <td style="background-color:rgb(210, 203, 255);"><span></span></td>\n      <td style="background-color:rgb(64, 169, 255);"><span></span></td>\n      <td style="background-color:rgb(255, 77, 79);"><span></span></td>\n      <td style="background-color:rgb(212, 177, 6);"><span></span></td>\n      <td style="background-color:rgb(146, 84, 222);"><span></span></td>\n    </tr>\n    <tr>\n    <th colspan="5" class="ui-widget-content">Custom Colors</th>\n  </tr>\n    <tr class="bottom">\n    <td style="background-color: ${t.settings.custom_bg1};"><span></span></td>\n    <td style="background-color:${t.settings.custom_bg2};"><span></span></td>\n    <td style="background-color:${t.settings.custom_bg3};"><span></span></td>\n    <td style="background-color:${t.settings.custom_bg4};"><span></span></td>\n    <td style="background-color:${t.settings.custom_bg5};"><span></span></td>\n  </tr>\n    </tbody>\n  </table>\n</div>\n</div>`}(i),s.buttonEl.insertAdjacentElement("afterbegin",r),I(e,i,"x-backgroundcolor-picker-table");let o=r.querySelector(".x-color-picker-wrapper");new t.ButtonComponent(o).setIcon("paintbrush").setTooltip(g("Format Brush")).onClick((()=>{L(i),i.setEN_BG_Format_Brush(!0),i.Temp_Notice=new t.Notice(g("Font-Color formatting brush ON!"),0)})),new t.ButtonComponent(o).setIcon("palette").setTooltip(g("Custom Backgroud Color")).onClick((()=>{e.setting.open(),e.setting.openTabById("editing-toolbar"),setTimeout((()=>{const t=e.setting.activeTab.containerEl.querySelector(".editing-toolbar-tabs");if(t){const i=t.children[1];null==i||i.click(),setTimeout((()=>{var t;let i=e.setting.activeTab.containerEl.querySelector(".custom_bg");i&&(null===(t=i.addClass)||void 0===t||t.call(i,"toolbar-cta"))}),100)}}),200)}))}}else{let h;a>=r-104&&r>100?(i.setIS_MORE_Button(!0),h=new t.ButtonComponent(d)):h=new t.ButtonComponent(l);let u=A(e,n.id);c="â€“"==u?n.name:n.name+"("+u+")",h.setTooltip(c).onClick((()=>{e.commands.executeCommandById(n.id),0==o.cMenuVisibility||"following"==o.positionStyle?l.style.visibility="hidden":l.style.visibility="visible"})),h.setClass("editingToolbarCommandItem"),s>=o.cMenuNumRows?h.setClass("editingToolbarSecond"):"top"!=o.positionStyle&&h.buttonEl.setAttribute("aria-label-position","top"),"editingToolbar-Divider-Line"==n.id&&h.setClass("editingToolbar-Divider-Line"),B(n.icon)?h.buttonEl.innerHTML=n.icon:h.setIcon(n.icon),a+=26}})),function(e,i,o){const n=e.workspace.getActiveViewOfType(t.ItemView);if(!T.isAllowedViewType(n))return;let s=n.containerEl.querySelector("#editingToolbarPopoverBar");if(!i.IS_MORE_Button)return;let a=o.createEl("span");a.addClass("more-menu");let r=new t.ButtonComponent(a);r.setClass("editingToolbarCommandItem").setTooltip(g("More")).onClick((()=>{"hidden"==s.style.visibility?(s.style.visibility="visible",s.style.height="32px"):(s.style.visibility="hidden",s.style.height="0")})),r.buttonEl.innerHTML='<svg  width="14" height="14"  version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" enable-background="new 0 0 1024 1024" xml:space="preserve"><path fill="#666" d="M510.29 14.13 q17.09 -15.07 40.2 -14.07 q23.12 1 39.2 18.08 l334.66 385.92 q25.12 30.15 34.16 66.83 q9.04 36.68 0.5 73.87 q-8.54 37.19 -32.66 67.34 l-335.67 390.94 q-15.07 18.09 -38.69 20.1 q-23.62 2.01 -41.71 -13.07 q-18.08 -15.08 -20.09 -38.19 q-2.01 -23.12 13.06 -41.21 l334.66 -390.94 q11.06 -13.06 11.56 -29.65 q0.5 -16.58 -10.55 -29.64 l-334.67 -386.92 q-15.07 -17.09 -13.56 -40.7 q1.51 -23.62 19.59 -38.7 ZM81.17 14.13 q17.08 -15.07 40.19 -14.07 q23.11 1 39.2 18.08 l334.66 385.92 q25.12 30.15 34.16 66.83 q9.04 36.68 0.5 73.87 q-8.54 37.19 -32.66 67.34 l-335.67 390.94 q-15.07 18.09 -38.69 20.6 q-23.61 2.51 -41.7 -12.57 q-18.09 -15.08 -20.1 -38.69 q-2.01 -23.62 13.06 -41.71 l334.66 -390.94 q11.06 -13.06 11.56 -29.65 q0.5 -16.58 -10.55 -29.64 l-334.66 -386.92 q-15.08 -17.09 -13.57 -40.7 q1.51 -23.62 19.6 -38.7 Z"/></svg>',i.setIS_MORE_Button(!1)}(e,i,l),Math.abs(i.settings.cMenuWidth-Number(a))>30&&(i.settings.cMenuWidth=Number(a),setTimeout((()=>{i.saveSettings()}),100))};if(!i.isLoadMobile())return;const s=e.workspace.getActiveViewOfType(t.ItemView);T.isAllowedViewType(s)&&(q(e,i.settings)||(n(),h(i.settings),d(i.settings),function(e,i){E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;let o=E.querySelectorAll("#change-font-color-icon");o&&o.forEach((t=>{t.style.fill=e}));let n=E.querySelectorAll("#change-background-color-icon");n&&n.forEach((t=>{t.style.fill=i}))}
/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */(o.cMenuFontColor,o.cMenuBackgroundColor)))}()}function V(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?V(Object(i),!0).forEach((function(e){$(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function $(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function z(){return z=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},z.apply(this,arguments)}function R(t,e){if(null==t)return{};var i,o,n=function(t,e){if(null==t)return{};var i,o,n={},s=Object.keys(t);for(o=0;o<s.length;o++)i=s[o],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)i=s[o],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function W(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var j=W(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Z=W(/Edge/i),U=W(/firefox/i),X=W(/safari/i)&&!W(/chrome/i)&&!W(/android/i),G=W(/iP(ad|od|hone)/i),Y=W(/chrome/i)&&W(/android/i),K={capture:!1,passive:!1};function Q(t,e,i){t.addEventListener(e,i,!j&&K)}function J(t,e,i){t.removeEventListener(e,i,!j&&K)}function tt(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return!1}return!1}}function et(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function it(t,e,i,o){if(t){i=i||document;do{if(null!=e&&(">"===e[0]?t.parentNode===i&&tt(t,e):tt(t,e))||o&&t===i)return t;if(t===i)break}while(t=et(t))}return null}var ot,nt=/\s+/g;function st(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(nt," ").replace(" "+e+" "," ");t.className=(o+(i?" "+e:"")).replace(nt," ")}}function at(t,e,i){var o=t&&t.style;if(o){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),void 0===e?i:i[e];e in o||-1!==e.indexOf("webkit")||(e="-webkit-"+e),o[e]=i+("string"==typeof i?"":"px")}}function rt(t,e){var i="";if("string"==typeof t)i=t;else do{var o=at(t,"transform");o&&"none"!==o&&(i=o+" "+i)}while(!e&&(t=t.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function lt(t,e,i){if(t){var o=t.getElementsByTagName(e),n=0,s=o.length;if(i)for(;n<s;n++)i(o[n],n);return o}return[]}function ct(){var t=document.scrollingElement;return t||document.documentElement}function dt(t,e,i,o,n){if(t.getBoundingClientRect||t===window){var s,a,r,l,c,d,h;if(t!==window&&t.parentNode&&t!==ct()?(a=(s=t.getBoundingClientRect()).top,r=s.left,l=s.bottom,c=s.right,d=s.height,h=s.width):(a=0,r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,h=window.innerWidth),(e||i)&&t!==window&&(n=n||t.parentNode,!j))do{if(n&&n.getBoundingClientRect&&("none"!==at(n,"transform")||i&&"static"!==at(n,"position"))){var u=n.getBoundingClientRect();a-=u.top+parseInt(at(n,"border-top-width")),r-=u.left+parseInt(at(n,"border-left-width")),l=a+s.height,c=r+s.width;break}}while(n=n.parentNode);if(o&&t!==window){var p=rt(n||t),g=p&&p.a,m=p&&p.d;p&&(l=(a/=m)+(d/=m),c=(r/=g)+(h/=g))}return{top:a,left:r,bottom:l,right:c,width:h,height:d}}}function ht(t,e,i){for(var o=ft(t,!0),n=dt(t)[e];o;){var s=dt(o)[i];if(!("top"===i||"left"===i?n>=s:n<=s))return o;if(o===ct())break;o=ft(o,!1)}return!1}function ut(t,e,i,o){for(var n=0,s=0,a=t.children;s<a.length;){if("none"!==a[s].style.display&&a[s]!==we.ghost&&(o||a[s]!==we.dragged)&&it(a[s],i.draggable,t,!1)){if(n===e)return a[s];n++}s++}return null}function pt(t,e){for(var i=t.lastElementChild;i&&(i===we.ghost||"none"===at(i,"display")||e&&!tt(i,e));)i=i.previousElementSibling;return i||null}function gt(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===we.clone||e&&!tt(t,e)||i++;return i}function mt(t){var e=0,i=0,o=ct();if(t)do{var n=rt(t),s=n.a,a=n.d;e+=t.scrollLeft*s,i+=t.scrollTop*a}while(t!==o&&(t=t.parentNode));return[e,i]}function ft(t,e){if(!t||!t.getBoundingClientRect)return ct();var i=t,o=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=at(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return ct();if(o||e)return i;o=!0}}}while(i=i.parentNode);return ct()}function bt(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function vt(t,e){return function(){if(!ot){var i=arguments;1===i.length?t.call(this,i[0]):t.apply(this,i),ot=setTimeout((function(){ot=void 0}),e)}}}function yt(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function wt(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}function Ct(t,e,i){var o={};return Array.from(t.children).forEach((function(n){var s,a,r,l;if(it(n,e.draggable,t,!1)&&!n.animated&&n!==i){var c=dt(n);o.left=Math.min(null!==(s=o.left)&&void 0!==s?s:1/0,c.left),o.top=Math.min(null!==(a=o.top)&&void 0!==a?a:1/0,c.top),o.right=Math.max(null!==(r=o.right)&&void 0!==r?r:-1/0,c.right),o.bottom=Math.max(null!==(l=o.bottom)&&void 0!==l?l:-1/0,c.bottom)}})),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var kt="Sortable"+(new Date).getTime();function xt(){var t,e=[];return{captureAnimationState:function(){(e=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(t){if("none"!==at(t,"display")&&t!==we.ghost){e.push({target:t,rect:dt(t)});var i=P({},e[e.length-1].rect);if(t.thisAnimationDuration){var o=rt(t,!0);o&&(i.top-=o.f,i.left-=o.e)}t.fromRect=i}}))},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(function(t,e){for(var i in t)if(t.hasOwnProperty(i))for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[i][o])return Number(i);return-1}(e,{target:t}),1)},animateAll:function(i){var o=this;if(!this.options.animation)return clearTimeout(t),void("function"==typeof i&&i());var n=!1,s=0;e.forEach((function(t){var e=0,i=t.target,a=i.fromRect,r=dt(i),l=i.prevFromRect,c=i.prevToRect,d=t.rect,h=rt(i,!0);h&&(r.top-=h.f,r.left-=h.e),i.toRect=r,i.thisAnimationDuration&&bt(l,r)&&!bt(a,r)&&(d.top-r.top)/(d.left-r.left)==(a.top-r.top)/(a.left-r.left)&&(e=function(t,e,i,o){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*o.animation}(d,l,c,o.options)),bt(r,a)||(i.prevFromRect=a,i.prevToRect=r,e||(e=o.options.animation),o.animate(i,d,r,e)),e&&(n=!0,s=Math.max(s,e),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),e),i.thisAnimationDuration=e)})),clearTimeout(t),n?t=setTimeout((function(){"function"==typeof i&&i()}),s):"function"==typeof i&&i(),e=[]},animate:function(t,e,i,o){if(o){at(t,"transition",""),at(t,"transform","");var n=rt(this.el),s=n&&n.a,a=n&&n.d,r=(e.left-i.left)/(s||1),l=(e.top-i.top)/(a||1);t.animatingX=!!r,t.animatingY=!!l,at(t,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=function(t){return t.offsetWidth}(t),at(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),at(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){at(t,"transition",""),at(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),o)}}}}var Tt=[],Et={initializeByDefault:!0},St={mount:function(t){for(var e in Et)Et.hasOwnProperty(e)&&!(e in t)&&(t[e]=Et[e]);Tt.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),Tt.push(t)},pluginEvent:function(t,e,i){var o=this;this.eventCanceled=!1,i.cancel=function(){o.eventCanceled=!0};var n=t+"Global";Tt.forEach((function(o){e[o.pluginName]&&(e[o.pluginName][n]&&e[o.pluginName][n](P({sortable:e},i)),e.options[o.pluginName]&&e[o.pluginName][t]&&e[o.pluginName][t](P({sortable:e},i)))}))},initializePlugins:function(t,e,i,o){for(var n in Tt.forEach((function(o){var n=o.pluginName;if(t.options[n]||o.initializeByDefault){var s=new o(t,e,t.options);s.sortable=t,s.options=t.options,t[n]=s,z(i,s.defaults)}})),t.options)if(t.options.hasOwnProperty(n)){var s=this.modifyOption(t,n,t.options[n]);void 0!==s&&(t.options[n]=s)}},getEventProperties:function(t,e){var i={};return Tt.forEach((function(o){"function"==typeof o.eventProperties&&z(i,o.eventProperties.call(e[o.pluginName],t))})),i},modifyOption:function(t,e,i){var o;return Tt.forEach((function(n){t[n.pluginName]&&n.optionListeners&&"function"==typeof n.optionListeners[e]&&(o=n.optionListeners[e].call(t[n.pluginName],i))})),o}};var qt=["evt"],_t=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.evt,n=R(i,qt);St.pluginEvent.bind(we)(t,e,P({dragEl:At,parentEl:Bt,ghostEl:It,rootEl:Dt,nextEl:Lt,lastDownEl:Nt,cloneEl:Ot,cloneHidden:Ft,dragStarted:Yt,putSortable:Rt,activeSortable:we.active,originalEvent:o,oldIndex:Vt,oldDraggableIndex:Ht,newIndex:Pt,newDraggableIndex:$t,hideGhostForTarget:fe,unhideGhostForTarget:be,cloneNowHidden:function(){Ft=!0},cloneNowShown:function(){Ft=!1},dispatchSortableEvent:function(t){Mt({sortable:e,name:t,originalEvent:o})}},n))};function Mt(t){!function(t){var e=t.sortable,i=t.rootEl,o=t.name,n=t.targetEl,s=t.cloneEl,a=t.toEl,r=t.fromEl,l=t.oldIndex,c=t.newIndex,d=t.oldDraggableIndex,h=t.newDraggableIndex,u=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||i&&i[kt]){var m,f=e.options,b="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||j||Z?(m=document.createEvent("Event")).initEvent(o,!0,!0):m=new CustomEvent(o,{bubbles:!0,cancelable:!0}),m.to=a||i,m.from=r||i,m.item=n||i,m.clone=s,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=d,m.newDraggableIndex=h,m.originalEvent=u,m.pullMode=p?p.lastPutMode:void 0;var v=P(P({},g),St.getEventProperties(o,e));for(var y in v)m[y]=v[y];i&&i.dispatchEvent(m),f[b]&&f[b].call(e,m)}}(P({putSortable:Rt,cloneEl:Ot,targetEl:At,rootEl:Dt,oldIndex:Vt,oldDraggableIndex:Ht,newIndex:Pt,newDraggableIndex:$t},t))}var At,Bt,It,Dt,Lt,Nt,Ot,Ft,Vt,Pt,Ht,$t,zt,Rt,Wt,jt,Zt,Ut,Xt,Gt,Yt,Kt,Qt,Jt,te,ee=!1,ie=!1,oe=[],ne=!1,se=!1,ae=[],re=!1,le=[],ce="undefined"!=typeof document,de=G,he=Z||j?"cssFloat":"float",ue=ce&&!Y&&!G&&"draggable"in document.createElement("div"),pe=function(){if(ce){if(j)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),ge=function(t,e){var i=at(t),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=ut(t,0,e),s=ut(t,1,e),a=n&&at(n),r=s&&at(s),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+dt(n).width,c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+dt(s).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!s||"both"!==r.clear&&r.clear!==d?"horizontal":"vertical"}return n&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=o&&"none"===i[he]||s&&"none"===i[he]&&l+c>o)?"vertical":"horizontal"},me=function(t){function e(t,i){return function(o,n,s,a){var r=o.options.group.name&&n.options.group.name&&o.options.group.name===n.options.group.name;if(null==t&&(i||r))return!0;if(null==t||!1===t)return!1;if(i&&"clone"===t)return t;if("function"==typeof t)return e(t(o,n,s,a),i)(o,n,s,a);var l=(i?o:n).options.group.name;return!0===t||"string"==typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var i={},o=t.group;o&&"object"==H(o)||(o={name:o}),i.name=o.name,i.checkPull=e(o.pull,!0),i.checkPut=e(o.put),i.revertClone=o.revertClone,t.group=i},fe=function(){!pe&&It&&at(It,"display","none")},be=function(){!pe&&It&&at(It,"display","")};ce&&!Y&&document.addEventListener("click",(function(t){if(ie)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),ie=!1,!1}),!0);var ve=function(t){if(At){t=t.touches?t.touches[0]:t;var e=(n=t.clientX,s=t.clientY,oe.some((function(t){var e=t[kt].options.emptyInsertThreshold;if(e&&!pt(t)){var i=dt(t),o=n>=i.left-e&&n<=i.right+e,r=s>=i.top-e&&s<=i.bottom+e;return o&&r?a=t:void 0}})),a);if(e){var i={};for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);i.target=i.rootEl=e,i.preventDefault=void 0,i.stopPropagation=void 0,e[kt]._onDragOver(i)}}var n,s,a},ye=function(t){At&&At.parentNode[kt]._isOutsideThisEl(t.target)};function we(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=z({},e),t[kt]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ge(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==we.supportPointer&&"PointerEvent"in window&&(!X||G),emptyInsertThreshold:5};for(var o in St.initializePlugins(this,t,i),i)!(o in e)&&(e[o]=i[o]);for(var n in me(e),this)"_"===n.charAt(0)&&"function"==typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!e.forceFallback&&ue,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Q(t,"pointerdown",this._onTapStart):(Q(t,"mousedown",this._onTapStart),Q(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Q(t,"dragover",this),Q(t,"dragenter",this)),oe.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),z(this,xt())}function Ce(t,e,i,o,n,s,a,r){var l,c,d=t[kt],h=d.options.onMove;return!window.CustomEvent||j||Z?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=i,l.draggedRect=o,l.related=n||e,l.relatedRect=s||dt(e),l.willInsertAfter=r,l.originalEvent=a,t.dispatchEvent(l),h&&(c=h.call(d,l,a)),c}function ke(t){t.draggable=!1}function xe(){re=!1}function Te(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,o=0;i--;)o+=e.charCodeAt(i);return o.toString(36)}function Ee(t){return setTimeout(t,0)}function Se(t){return clearTimeout(t)}we.prototype={constructor:we,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(Kt=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,At):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,i=this.el,o=this.options,n=o.preventOnFilter,s=t.type,a=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,r=(a||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||r,c=o.filter;if(function(t){le.length=0;var e=t.getElementsByTagName("input"),i=e.length;for(;i--;){var o=e[i];o.checked&&le.push(o)}}(i),!At&&!(/mousedown|pointerdown/.test(s)&&0!==t.button||o.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!X||!r||"SELECT"!==r.tagName.toUpperCase())&&!((r=it(r,o.draggable,i,!1))&&r.animated||Nt===r)){if(Vt=gt(r),Ht=gt(r,o.draggable),"function"==typeof c){if(c.call(this,t,r,this))return Mt({sortable:e,rootEl:l,name:"filter",targetEl:r,toEl:i,fromEl:i}),_t("filter",e,{evt:t}),void(n&&t.preventDefault())}else if(c&&(c=c.split(",").some((function(o){if(o=it(l,o.trim(),i,!1))return Mt({sortable:e,rootEl:o,name:"filter",targetEl:r,fromEl:i,toEl:i}),_t("filter",e,{evt:t}),!0}))))return void(n&&t.preventDefault());o.handle&&!it(l,o.handle,i,!1)||this._prepareDragStart(t,a,r)}}},_prepareDragStart:function(t,e,i){var o,n=this,s=n.el,a=n.options,r=s.ownerDocument;if(i&&!At&&i.parentNode===s){var l=dt(i);if(Dt=s,Bt=(At=i).parentNode,Lt=At.nextSibling,Nt=i,zt=a.group,we.dragged=At,Wt={target:At,clientX:(e||t).clientX,clientY:(e||t).clientY},Xt=Wt.clientX-l.left,Gt=Wt.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,At.style["will-change"]="all",o=function(){_t("delayEnded",n,{evt:t}),we.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!U&&n.nativeDraggable&&(At.draggable=!0),n._triggerDragStart(t,e),Mt({sortable:n,name:"choose",originalEvent:t}),st(At,a.chosenClass,!0))},a.ignore.split(",").forEach((function(t){lt(At,t.trim(),ke)})),Q(r,"dragover",ve),Q(r,"mousemove",ve),Q(r,"touchmove",ve),a.supportPointer?(Q(r,"pointerup",n._onDrop),!this.nativeDraggable&&Q(r,"pointercancel",n._onDrop)):(Q(r,"mouseup",n._onDrop),Q(r,"touchend",n._onDrop),Q(r,"touchcancel",n._onDrop)),U&&this.nativeDraggable&&(this.options.touchStartThreshold=4,At.draggable=!0),_t("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(Z||j))o();else{if(we.eventCanceled)return void this._onDrop();a.supportPointer?(Q(r,"pointerup",n._disableDelayedDrag),Q(r,"pointercancel",n._disableDelayedDrag)):(Q(r,"mouseup",n._disableDelayedDrag),Q(r,"touchend",n._disableDelayedDrag),Q(r,"touchcancel",n._disableDelayedDrag)),Q(r,"mousemove",n._delayedDragTouchMoveHandler),Q(r,"touchmove",n._delayedDragTouchMoveHandler),a.supportPointer&&Q(r,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(o,a.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){At&&ke(At),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;J(t,"mouseup",this._disableDelayedDrag),J(t,"touchend",this._disableDelayedDrag),J(t,"touchcancel",this._disableDelayedDrag),J(t,"pointerup",this._disableDelayedDrag),J(t,"pointercancel",this._disableDelayedDrag),J(t,"mousemove",this._delayedDragTouchMoveHandler),J(t,"touchmove",this._delayedDragTouchMoveHandler),J(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?Q(document,"pointermove",this._onTouchMove):Q(document,e?"touchmove":"mousemove",this._onTouchMove):(Q(At,"dragend",this),Q(Dt,"dragstart",this._onDragStart));try{document.selection?Ee((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){if(ee=!1,Dt&&At){_t("dragStarted",this,{evt:e}),this.nativeDraggable&&Q(document,"dragover",ye);var i=this.options;!t&&st(At,i.dragClass,!1),st(At,i.ghostClass,!0),we.active=this,t&&this._appendGhost(),Mt({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(jt){this._lastX=jt.clientX,this._lastY=jt.clientY,fe();for(var t=document.elementFromPoint(jt.clientX,jt.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(jt.clientX,jt.clientY))!==e;)e=t;if(At.parentNode[kt]._isOutsideThisEl(t),e)do{if(e[kt]){if(e[kt]._onDragOver({clientX:jt.clientX,clientY:jt.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}t=e}while(e=et(e));be()}},_onTouchMove:function(t){if(Wt){var e=this.options,i=e.fallbackTolerance,o=e.fallbackOffset,n=t.touches?t.touches[0]:t,s=It&&rt(It,!0),a=It&&s&&s.a,r=It&&s&&s.d,l=de&&te&&mt(te),c=(n.clientX-Wt.clientX+o.x)/(a||1)+(l?l[0]-ae[0]:0)/(a||1),d=(n.clientY-Wt.clientY+o.y)/(r||1)+(l?l[1]-ae[1]:0)/(r||1);if(!we.active&&!ee){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(t,!0)}if(It){s?(s.e+=c-(Zt||0),s.f+=d-(Ut||0)):s={a:1,b:0,c:0,d:1,e:c,f:d};var h="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");at(It,"webkitTransform",h),at(It,"mozTransform",h),at(It,"msTransform",h),at(It,"transform",h),Zt=c,Ut=d,jt=n}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!It){var t=this.options.fallbackOnBody?document.body:Dt,e=dt(At,!0,de,!0,t),i=this.options;if(de){for(te=t;"static"===at(te,"position")&&"none"===at(te,"transform")&&te!==document;)te=te.parentNode;te!==document.body&&te!==document.documentElement?(te===document&&(te=ct()),e.top+=te.scrollTop,e.left+=te.scrollLeft):te=ct(),ae=mt(te)}st(It=At.cloneNode(!0),i.ghostClass,!1),st(It,i.fallbackClass,!0),st(It,i.dragClass,!0),at(It,"transition",""),at(It,"transform",""),at(It,"box-sizing","border-box"),at(It,"margin",0),at(It,"top",e.top),at(It,"left",e.left),at(It,"width",e.width),at(It,"height",e.height),at(It,"opacity","0.8"),at(It,"position",de?"absolute":"fixed"),at(It,"zIndex","100000"),at(It,"pointerEvents","none"),we.ghost=It,t.appendChild(It),at(It,"transform-origin",Xt/parseInt(It.style.width)*100+"% "+Gt/parseInt(It.style.height)*100+"%")}},_onDragStart:function(t,e){var i=this,o=t.dataTransfer,n=i.options;_t("dragStart",this,{evt:t}),we.eventCanceled?this._onDrop():(_t("setupClone",this),we.eventCanceled||((Ot=wt(At)).removeAttribute("id"),Ot.draggable=!1,Ot.style["will-change"]="",this._hideClone(),st(Ot,this.options.chosenClass,!1),we.clone=Ot),i.cloneId=Ee((function(){_t("clone",i),we.eventCanceled||(i.options.removeCloneOnHide||Dt.insertBefore(Ot,At),i._hideClone(),Mt({sortable:i,name:"clone"}))})),!e&&st(At,n.dragClass,!0),e?(ie=!0,i._loopId=setInterval(i._emulateDragOver,50)):(J(document,"mouseup",i._onDrop),J(document,"touchend",i._onDrop),J(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",n.setData&&n.setData.call(i,o,At)),Q(document,"drop",i),at(At,"transform","translateZ(0)")),ee=!0,i._dragStartId=Ee(i._dragStarted.bind(i,e,t)),Q(document,"selectstart",i),Yt=!0,window.getSelection().removeAllRanges(),X&&at(document.body,"user-select","none"))},_onDragOver:function(t){var e,i,o,n,s=this.el,a=t.target,r=this.options,l=r.group,c=we.active,d=zt===l,h=r.sort,u=Rt||c,p=this,g=!1;if(!re){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),a=it(a,r.draggable,s,!0),M("dragOver"),we.eventCanceled)return g;if(At.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||p._ignoreWhileAnimating===a)return B(!1);if(ie=!1,c&&!r.disabled&&(d?h||(o=Bt!==Dt):Rt===this||(this.lastPutMode=zt.checkPull(this,c,At,t))&&l.checkPut(this,c,At,t))){if(n="vertical"===this._getDirection(t,a),e=dt(At),M("dragOverValid"),we.eventCanceled)return g;if(o)return Bt=Dt,A(),this._hideClone(),M("revert"),we.eventCanceled||(Lt?Dt.insertBefore(At,Lt):Dt.appendChild(At)),B(!0);var m=pt(s,r.draggable);if(!m||function(t,e,i){var o=dt(pt(i.el,i.options.draggable)),n=Ct(i.el,i.options,It),s=10;return e?t.clientX>n.right+s||t.clientY>o.bottom&&t.clientX>o.left:t.clientY>n.bottom+s||t.clientX>o.right&&t.clientY>o.top}(t,n,this)&&!m.animated){if(m===At)return B(!1);if(m&&s===t.target&&(a=m),a&&(i=dt(a)),!1!==Ce(Dt,s,At,e,a,i,t,!!a))return A(),m&&m.nextSibling?s.insertBefore(At,m.nextSibling):s.appendChild(At),Bt=s,I(),B(!0)}else if(m&&function(t,e,i){var o=dt(ut(i.el,0,i.options,!0)),n=Ct(i.el,i.options,It),s=10;return e?t.clientX<n.left-s||t.clientY<o.top&&t.clientX<o.right:t.clientY<n.top-s||t.clientY<o.bottom&&t.clientX<o.left}(t,n,this)){var f=ut(s,0,r,!0);if(f===At)return B(!1);if(i=dt(a=f),!1!==Ce(Dt,s,At,e,a,i,t,!1))return A(),s.insertBefore(At,f),Bt=s,I(),B(!0)}else if(a.parentNode===s){i=dt(a);var b,v,y,w=At.parentNode!==s,C=!function(t,e,i){var o=i?t.left:t.top,n=i?t.right:t.bottom,s=i?t.width:t.height,a=i?e.left:e.top,r=i?e.right:e.bottom,l=i?e.width:e.height;return o===a||n===r||o+s/2===a+l/2}(At.animated&&At.toRect||e,a.animated&&a.toRect||i,n),k=n?"top":"left",x=ht(a,"top","top")||ht(At,"top","top"),T=x?x.scrollTop:void 0;if(Kt!==a&&(v=i[k],ne=!1,se=!C&&r.invertSwap||w),b=function(t,e,i,o,n,s,a,r){var l=o?t.clientY:t.clientX,c=o?i.height:i.width,d=o?i.top:i.left,h=o?i.bottom:i.right,u=!1;if(!a)if(r&&Jt<c*n){if(!ne&&(1===Qt?l>d+c*s/2:l<h-c*s/2)&&(ne=!0),ne)u=!0;else if(1===Qt?l<d+Jt:l>h-Jt)return-Qt}else if(l>d+c*(1-n)/2&&l<h-c*(1-n)/2)return function(t){return gt(At)<gt(t)?1:-1}(e);if((u=u||a)&&(l<d+c*s/2||l>h-c*s/2))return l>d+c/2?1:-1;return 0}(t,a,i,n,C?1:r.swapThreshold,null==r.invertedSwapThreshold?r.swapThreshold:r.invertedSwapThreshold,se,Kt===a),0!==b){var E=gt(At);do{E-=b,y=Bt.children[E]}while(y&&("none"===at(y,"display")||y===It))}if(0===b||y===a)return B(!1);Kt=a,Qt=b;var S=a.nextElementSibling,q=!1,_=Ce(Dt,s,At,e,a,i,t,q=1===b);if(!1!==_)return 1!==_&&-1!==_||(q=1===_),re=!0,setTimeout(xe,30),A(),q&&!S?s.appendChild(At):a.parentNode.insertBefore(At,q?S:a),x&&yt(x,0,T-x.scrollTop),Bt=At.parentNode,void 0===v||se||(Jt=Math.abs(v-dt(a)[k])),I(),B(!0)}if(s.contains(At))return B(!1)}return!1}function M(r,l){_t(r,p,P({evt:t,isOwner:d,axis:n?"vertical":"horizontal",revert:o,dragRect:e,targetRect:i,canSort:h,fromSortable:u,target:a,completed:B,onMove:function(i,o){return Ce(Dt,s,At,e,i,dt(i),t,o)},changed:I},l))}function A(){M("dragOverAnimationCapture"),p.captureAnimationState(),p!==u&&u.captureAnimationState()}function B(e){return M("dragOverCompleted",{insertion:e}),e&&(d?c._hideClone():c._showClone(p),p!==u&&(st(At,Rt?Rt.options.ghostClass:c.options.ghostClass,!1),st(At,r.ghostClass,!0)),Rt!==p&&p!==we.active?Rt=p:p===we.active&&Rt&&(Rt=null),u===p&&(p._ignoreWhileAnimating=a),p.animateAll((function(){M("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(a===At&&!At.animated||a===s&&!a.animated)&&(Kt=null),r.dragoverBubble||t.rootEl||a===document||(At.parentNode[kt]._isOutsideThisEl(t.target),!e&&ve(t)),!r.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function I(){Pt=gt(At),$t=gt(At,r.draggable),Mt({sortable:p,name:"change",toEl:s,newIndex:Pt,newDraggableIndex:$t,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){J(document,"mousemove",this._onTouchMove),J(document,"touchmove",this._onTouchMove),J(document,"pointermove",this._onTouchMove),J(document,"dragover",ve),J(document,"mousemove",ve),J(document,"touchmove",ve)},_offUpEvents:function(){var t=this.el.ownerDocument;J(t,"mouseup",this._onDrop),J(t,"touchend",this._onDrop),J(t,"pointerup",this._onDrop),J(t,"pointercancel",this._onDrop),J(t,"touchcancel",this._onDrop),J(document,"selectstart",this)},_onDrop:function(t){var e=this.el,i=this.options;Pt=gt(At),$t=gt(At,i.draggable),_t("drop",this,{evt:t}),Bt=At&&At.parentNode,Pt=gt(At),$t=gt(At,i.draggable),we.eventCanceled||(ee=!1,se=!1,ne=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Se(this.cloneId),Se(this._dragStartId),this.nativeDraggable&&(J(document,"drop",this),J(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),X&&at(document.body,"user-select",""),at(At,"transform",""),t&&(Yt&&(t.cancelable&&t.preventDefault(),!i.dropBubble&&t.stopPropagation()),It&&It.parentNode&&It.parentNode.removeChild(It),(Dt===Bt||Rt&&"clone"!==Rt.lastPutMode)&&Ot&&Ot.parentNode&&Ot.parentNode.removeChild(Ot),At&&(this.nativeDraggable&&J(At,"dragend",this),ke(At),At.style["will-change"]="",Yt&&!ee&&st(At,Rt?Rt.options.ghostClass:this.options.ghostClass,!1),st(At,this.options.chosenClass,!1),Mt({sortable:this,name:"unchoose",toEl:Bt,newIndex:null,newDraggableIndex:null,originalEvent:t}),Dt!==Bt?(Pt>=0&&(Mt({rootEl:Bt,name:"add",toEl:Bt,fromEl:Dt,originalEvent:t}),Mt({sortable:this,name:"remove",toEl:Bt,originalEvent:t}),Mt({rootEl:Bt,name:"sort",toEl:Bt,fromEl:Dt,originalEvent:t}),Mt({sortable:this,name:"sort",toEl:Bt,originalEvent:t})),Rt&&Rt.save()):Pt!==Vt&&Pt>=0&&(Mt({sortable:this,name:"update",toEl:Bt,originalEvent:t}),Mt({sortable:this,name:"sort",toEl:Bt,originalEvent:t})),we.active&&(null!=Pt&&-1!==Pt||(Pt=Vt,$t=Ht),Mt({sortable:this,name:"end",toEl:Bt,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){_t("nulling",this),Dt=At=Bt=It=Lt=Ot=Nt=Ft=Wt=jt=Yt=Pt=$t=Vt=Ht=Kt=Qt=Rt=zt=we.dragged=we.ghost=we.clone=we.active=null,le.forEach((function(t){t.checked=!0})),le.length=Zt=Ut=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":At&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],i=this.el.children,o=0,n=i.length,s=this.options;o<n;o++)it(t=i[o],s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||Te(t));return e},sort:function(t,e){var i={},o=this.el;this.toArray().forEach((function(t,e){var n=o.children[e];it(n,this.options.draggable,o,!1)&&(i[t]=n)}),this),e&&this.captureAnimationState(),t.forEach((function(t){i[t]&&(o.removeChild(i[t]),o.appendChild(i[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return it(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var i=this.options;if(void 0===e)return i[t];var o=St.modifyOption(this,t,e);i[t]=void 0!==o?o:e,"group"===t&&me(i)},destroy:function(){_t("destroy",this);var t=this.el;t[kt]=null,J(t,"mousedown",this._onTapStart),J(t,"touchstart",this._onTapStart),J(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(J(t,"dragover",this),J(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),oe.splice(oe.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Ft){if(_t("hideClone",this),we.eventCanceled)return;at(Ot,"display","none"),this.options.removeCloneOnHide&&Ot.parentNode&&Ot.parentNode.removeChild(Ot),Ft=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(Ft){if(_t("showClone",this),we.eventCanceled)return;At.parentNode!=Dt||this.options.group.revertClone?Lt?Dt.insertBefore(Ot,Lt):Dt.appendChild(Ot):Dt.insertBefore(Ot,At),this.options.group.revertClone&&this.animate(At,Ot),at(Ot,"display",""),Ft=!1}}else this._hideClone()}},ce&&Q(document,"touchmove",(function(t){(we.active||ee)&&t.cancelable&&t.preventDefault()})),we.utils={on:Q,off:J,css:at,find:lt,is:function(t,e){return!!it(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},throttle:vt,closest:it,toggleClass:st,clone:wt,index:gt,nextTick:Ee,cancelNextTick:Se,detectDirection:ge,getChild:ut,expando:kt},we.get=function(t){return t[kt]},we.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(we.utils=P(P({},we.utils),t.utils)),St.mount(t)}))},we.create=function(t,e){return new we(t,e)},we.version="1.15.6";var qe,_e,Me,Ae,Be,Ie,De=[],Le=!1;function Ne(){De.forEach((function(t){clearInterval(t.pid)})),De=[]}function Oe(){clearInterval(Ie)}var Fe=vt((function(t,e,i,o){if(e.scroll){var n,s=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,r=e.scrollSensitivity,l=e.scrollSpeed,c=ct(),d=!1;_e!==i&&(_e=i,Ne(),qe=e.scroll,n=e.scrollFn,!0===qe&&(qe=ft(i,!0)));var h=0,u=qe;do{var p=u,g=dt(p),m=g.top,f=g.bottom,b=g.left,v=g.right,y=g.width,w=g.height,C=void 0,k=void 0,x=p.scrollWidth,T=p.scrollHeight,E=at(p),S=p.scrollLeft,q=p.scrollTop;p===c?(C=y<x&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),k=w<T&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(C=y<x&&("auto"===E.overflowX||"scroll"===E.overflowX),k=w<T&&("auto"===E.overflowY||"scroll"===E.overflowY));var _=C&&(Math.abs(v-s)<=r&&S+y<x)-(Math.abs(b-s)<=r&&!!S),M=k&&(Math.abs(f-a)<=r&&q+w<T)-(Math.abs(m-a)<=r&&!!q);if(!De[h])for(var A=0;A<=h;A++)De[A]||(De[A]={});De[h].vx==_&&De[h].vy==M&&De[h].el===p||(De[h].el=p,De[h].vx=_,De[h].vy=M,clearInterval(De[h].pid),0==_&&0==M||(d=!0,De[h].pid=setInterval(function(){o&&0===this.layer&&we.active._onTouchMove(Be);var e=De[this.layer].vy?De[this.layer].vy*l:0,i=De[this.layer].vx?De[this.layer].vx*l:0;"function"==typeof n&&"continue"!==n.call(we.dragged.parentNode[kt],i,e,t,Be,De[this.layer].el)||yt(De[this.layer].el,i,e)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&u!==c&&(u=ft(u,!1)));Le=d}}),30),Ve=function(t){var e=t.originalEvent,i=t.putSortable,o=t.dragEl,n=t.activeSortable,s=t.dispatchSortableEvent,a=t.hideGhostForTarget,r=t.unhideGhostForTarget;if(e){var l=i||n;a();var c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,d=document.elementFromPoint(c.clientX,c.clientY);r(),l&&!l.el.contains(d)&&(s("spill"),this.onSpill({dragEl:o,putSortable:i}))}};function Pe(){}function He(){}Pe.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,i=t.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var o=ut(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(e,o):this.sortable.el.appendChild(e),this.sortable.animateAll(),i&&i.animateAll()},drop:Ve},z(Pe,{pluginName:"revertOnSpill"}),He.prototype={onSpill:function(t){var e=t.dragEl,i=t.putSortable||this.sortable;i.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),i.animateAll()},drop:Ve},z(He,{pluginName:"removeOnSpill"}),we.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?Q(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Q(document,"pointermove",this._handleFallbackAutoScroll):e.touches?Q(document,"touchmove",this._handleFallbackAutoScroll):Q(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?J(document,"dragover",this._handleAutoScroll):(J(document,"pointermove",this._handleFallbackAutoScroll),J(document,"touchmove",this._handleFallbackAutoScroll),J(document,"mousemove",this._handleFallbackAutoScroll)),Oe(),Ne(),clearTimeout(ot),ot=void 0},nulling:function(){Be=_e=qe=Le=Ie=Me=Ae=null,De.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var i=this,o=(t.touches?t.touches[0]:t).clientX,n=(t.touches?t.touches[0]:t).clientY,s=document.elementFromPoint(o,n);if(Be=t,e||this.options.forceAutoScrollFallback||Z||j||X){Fe(t,this.options,s,e);var a=ft(s,!0);!Le||Ie&&o===Me&&n===Ae||(Ie&&Oe(),Ie=setInterval((function(){var s=ft(document.elementFromPoint(o,n),!0);s!==a&&(a=s,Ne()),Fe(t,i.options,s,e)}),10),Me=o,Ae=n)}else{if(!this.options.bubbleScroll||ft(s,!0)===ct())return void Ne();Fe(t,this.options,ft(s,!1),!1)}}},z(t,{pluginName:"scroll",initializeByDefault:!0})}),we.mount(He,Pe);class $e extends t.Modal{constructor(t,e){super(t),this.changelogContent="",this.changelogLoaded=!1,this.plugin=e}loadChangelog(){return e(this,void 0,void 0,(function*(){try{const e=yield t.request({url:"https://raw.githubusercontent.com/PKM-er/obsidian-editing-toolbar/master/CHANGELOG.md",method:"GET"});if(!e)throw new Error("æ— æ³•è·å– Changelog å†…å®¹");{const t=e.split("\n");let i="",o=[],n=!1;for(const e of t)if(e.startsWith("## ")&&!i)i=e.substring(3).trim(),n=!0,o.push(e);else{if(e.startsWith("## ")&&n)break;n&&o.push(e)}this.changelogContent=o.join("\n")}}catch(t){console.error("åŠ è½½ Changelog æ—¶å‡ºé”™:",t),this.changelogContent="### æ— æ³•åŠ è½½æ›´æ–°è¯´æ˜\n\nè¯·[ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹æœ€æ–°æ›´æ–°è¯´æ˜](https://github.com/PKM-er/obsidian-editing-toolbar/blob/master/CHANGELOG.md)"}this.changelogLoaded=!0,this.updateChangelogDisplay()}))}updateChangelogDisplay(){this.changelogContainer&&this.changelogContentEl&&this.changelogLoaded&&(this.changelogContentEl.empty(),t.MarkdownRenderer.renderMarkdown(this.changelogContent,this.changelogContentEl,"",this.plugin))}fixCommandIds(){return e(this,void 0,void 0,(function*(){try{const e={"editor:toggle-numbered-list":"editing-toolbar:toggle-numbered-list","editor:toggle-bullet-list":"editing-toolbar:toggle-bullet-list","editor:toggle-highlight":"editing-toolbar:toggle-highlight","toggle-highlight":"editing-toolbar:toggle-highlight","editing-toolbar:editor:toggle-bold":"editing-toolbar:toggle-bold","editing-toolbar:editor:toggle-italics":"editing-toolbar:toggle-italics","editing-toolbar:editor:toggle-strikethrough":"editing-toolbar:toggle-strikethrough","editing-toolbar:editor:toggle-inline-math":"editing-toolbar:toggle-inline-math","editing-toolbar:editor:insert-callout":"editing-toolbar:insert-callout","editing-toolbar:editor:insert-link":"editing-toolbar:insert-link"};let i=!1;const o=this.plugin.settings;if(o.menuCommands){const t=o=>{o.forEach((o=>{o.id&&e[o.id]&&(o.id=e[o.id],i=!0),"editing-toolbar:format-eraser"===o.id&&(o.icon="eraser",i=!0),o.SubmenuCommands&&t(o.SubmenuCommands)}))};t(o.menuCommands);let n=!1;const s=t=>{for(const e of t){if("editing-toolbar:toggle-format-brush"===e.id)return void(n=!0);if(e.SubmenuCommands&&(s(e.SubmenuCommands),n))return}};if(s(o.menuCommands),!n&&o.menuCommands.length>=2){const t={id:"editing-toolbar:toggle-format-brush",name:"Format Brush",icon:"paintbrush"};o.menuCommands.splice(2,0,t),i=!0}}i?(yield this.plugin.saveSettings(),new t.Notice(g("Command IDs have been successfully repaired!"))):new t.Notice(g("No command IDs need to be repaired"))}catch(e){console.error("ä¿®å¤å‘½ä»¤IDæ—¶å‡ºé”™:",e),new t.Notice(g("Error repairing command IDs, please check the console for details"))}}))}reloadPlugin(t){return e(this,void 0,void 0,(function*(){const{plugins:e}=this.app;try{yield e.disablePlugin(t),yield e.enablePlugin(t)}catch(t){console.error(t)}}))}restoreDefaultSettings(){return e(this,void 0,void 0,(function*(){try{const e=this.plugin.settings.lastVersion;this.plugin.settings=Object.assign(Object.assign({},x),{lastVersion:e}),yield this.plugin.saveSettings(),new t.Notice(g("Successfully restored default settings!"))}catch(e){console.error("æ¢å¤é»˜è®¤è®¾ç½®æ—¶å‡ºé”™:",e),new t.Notice(g("Error restoring default settings, please check the console for details"))}}))}onOpen(){const{contentEl:i}=this;i.createEl("h2",{text:this.plugin.manifest.version+"âš¡Tips"}),i.createEl("p",{text:g("Notice:")});const o=i.createEl("ul");o.createEl("li",{text:g("This update rebuilds the entire code, reducing resource consumption")}),o.createEl("li",{text:g("Optimized mobile usage, added canvas support, and added custom commands")}),o.createEl("li",{text:g("âš ï¸This update is not compatible with some old version command ids, please click [Repair command] to be compatible")}),o.createEl("li",{text:g("âš ï¸If you want to restore the default settings, please click [Restore default settings]")}),this.changelogContainer=i.createDiv({cls:"changelog-container"}),this.changelogContainer.createEl("h3",{text:g("Latest Changes")}),this.changelogContentEl=this.changelogContainer.createDiv({cls:"changelog-content"}),this.changelogContentEl.setText(g("Loading changelog...")),setTimeout((()=>{this.loadChangelog()}),100),new t.Setting(i).setName(g("ğŸ”§Data repair")).setDesc(g("This update changed the ID of some commands, please click this button to repair the commands to ensure the toolbar works properly")).addButton((t=>t.setButtonText(g("Repair command ID")).onClick((()=>e(this,void 0,void 0,(function*(){yield this.fixCommandIds()})))))),new t.Setting(i).setName(g("ğŸ”„Restore default settings")).setDesc(g("This will reset all your custom configurations")).addButton((t=>t.setButtonText(g("Restore default")).onClick((()=>e(this,void 0,void 0,(function*(){confirm(g("Are you sure you want to restore all settings to default? This will lose all your custom configurations."))&&(yield this.restoreDefaultSettings())})))))),new t.Setting(i).setName(g("ğŸ“‹View full changelog")).setDesc(g("Open the complete changelog in your browser")).addButton((t=>t.setButtonText(g("Open changelog")).onClick((()=>{window.open("https://github.com/PKM-er/obsidian-editing-toolbar/blob/master/CHANGELOG.md","_blank")})))),new t.Setting(i).addButton((t=>t.setButtonText(g("Close")).onClick((()=>{this.close()})))),i.createEl("style",{text:"\n            .changelog-container {\n                margin-top: 20px;\n                margin-bottom: 20px;\n                padding: 10px;\n                border: 1px solid var(--background-modifier-border);\n                border-radius: 5px;\n                max-height: 200px;\n                overflow-y: auto;\n            }\n            .changelog-content {\n                padding: 0 10px;\n            }\n            .changelog-content a {\n                text-decoration: underline;\n            }\n            "})}onClose(){const{contentEl:t}=this;t.empty()}}function ze(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}
/*! Pickr 1.8.4 MIT | https://github.com/Simonwep/pickr */
var Re=function(t){var e={exports:{}};return t(e,e.exports),e.exports}((function(t,e){self,t.exports=(()=>{var t={d:(e,i)=>{for(var o in i)t.o(i,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.d(e,{default:()=>B});var i={};function o(t,e,i,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};e instanceof HTMLCollection||e instanceof NodeList?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);for(const s of e)for(const e of i)s[t](e,o,{capture:!1,...n});return Array.prototype.slice.call(arguments,1)}t.r(i),t.d(i,{adjustableInputNumbers:()=>d,createElementFromString:()=>a,createFromTemplate:()=>r,eventPath:()=>l,off:()=>s,on:()=>n,resolveElement:()=>c});const n=o.bind(null,"addEventListener"),s=o.bind(null,"removeEventListener");function a(t){const e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild}function r(t){const e=(t,e)=>{const i=t.getAttribute(e);return t.removeAttribute(e),i},i=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e(t,":obj"),s=e(t,":ref"),a=n?o[n]={}:o;s&&(o[s]=t);for(const o of Array.from(t.children)){const t=e(o,":arr"),n=i(o,t?{}:a);t&&(a[t]||(a[t]=[])).push(Object.keys(n).length?n:o)}return o};return i(a(t))}function l(t){let e=t.path||t.composedPath&&t.composedPath();if(e)return e;let i=t.target.parentElement;for(e=[t.target,i];i=i.parentElement;)e.push(i);return e.push(document,window),e}function c(t){return t instanceof Element?t:"string"==typeof t?t.split(/>>/g).reduce(((t,e,i,o)=>(t=t.querySelector(e),i<o.length-1?t.shadowRoot:t)),document):null}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t;function i(i){const o=[.001,.01,.1][Number(i.shiftKey||2*i.ctrlKey)]*(i.deltaY<0?1:-1);let n=0,s=t.selectionStart;t.value=t.value.replace(/[\d.]+/g,((t,i)=>i<=s&&i+t.length>=s?(s=i,e(Number(t),o,n)):(n++,t))),t.focus(),t.setSelectionRange(s,s),i.preventDefault(),t.dispatchEvent(new Event("input"))}n(t,"focus",(()=>n(window,"wheel",i,{passive:!1}))),n(t,"blur",(()=>s(window,"wheel",i)))}const{min:h,max:u,floor:p,round:g}=Math;function m(t,e,i){e/=100,i/=100;const o=p(t=t/360*6),n=t-o,s=i*(1-e),a=i*(1-n*e),r=i*(1-(1-n)*e),l=o%6;return[255*[i,a,s,s,r,i][l],255*[r,i,i,a,s,s][l],255*[s,s,r,i,i,a][l]]}function f(t,e,i){return m(t,e,i).map((t=>g(t).toString(16).padStart(2,"0")))}function b(t,e,i){const o=m(t,e,i),n=o[0]/255,s=o[1]/255,a=o[2]/255,r=h(1-n,1-s,1-a);return[100*(1===r?0:(1-n-r)/(1-r)),100*(1===r?0:(1-s-r)/(1-r)),100*(1===r?0:(1-a-r)/(1-r)),100*r]}function v(t,e,i){const o=(2-(e/=100))*(i/=100)/2;return 0!==o&&(e=1===o?0:o<.5?e*i/(2*o):e*i/(2-2*o)),[t,100*e,100*o]}function y(t,e,i){const o=h(t/=255,e/=255,i/=255),n=u(t,e,i),s=n-o;let a,r;if(0===s)a=r=0;else{r=s/n;const o=((n-t)/6+s/2)/s,l=((n-e)/6+s/2)/s,c=((n-i)/6+s/2)/s;t===n?a=c-l:e===n?a=1/3+o-c:i===n&&(a=2/3+l-o),a<0?a+=1:a>1&&(a-=1)}return[360*a,100*r,100*n]}function w(t,e,i,o){return e/=100,i/=100,[...y(255*(1-h(1,(t/=100)*(1-(o/=100))+o)),255*(1-h(1,e*(1-o)+o)),255*(1-h(1,i*(1-o)+o)))]}function C(t,e,i){e/=100;const o=2*(e*=(i/=100)<.5?i:1-i)/(i+e)*100,n=100*(i+e);return[t,isNaN(o)?0:o,n]}function k(t){return y(...t.match(/.{2}/g).map((t=>parseInt(t,16))))}function x(t){t=t.match(/^[a-zA-Z]+$/)?function(t){if("black"===t.toLowerCase())return"#000";const e=document.createElement("canvas").getContext("2d");return e.fillStyle=t,"#000"===e.fillStyle?null:e.fillStyle}(t):t;const e={cmyk:/^cmyk[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)/i,rgba:/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsla:/^((hsla)|hsl)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsva:/^((hsva)|hsv)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},i=t=>t.map((t=>/^(|\d+)\.\d+|\d+$/.test(t)?Number(t):void 0));let o;t:for(const n in e){if(!(o=e[n].exec(t)))continue;const s=t=>!!o[2]==("number"==typeof t);switch(n){case"cmyk":{const[,t,e,s,a]=i(o);if(t>100||e>100||s>100||a>100)break t;return{values:w(t,e,s,a),type:n}}case"rgba":{const[,,,t,e,a,r]=i(o);if(t>255||e>255||a>255||r<0||r>1||!s(r))break t;return{values:[...y(t,e,a),r],a:r,type:n}}case"hexa":{let[,t]=o;4!==t.length&&3!==t.length||(t=t.split("").map((t=>t+t)).join(""));const e=t.substring(0,6);let i=t.substring(6);return i=i?parseInt(i,16)/255:void 0,{values:[...k(e),i],a:i,type:n}}case"hsla":{const[,,,t,e,a,r]=i(o);if(t>360||e>100||a>100||r<0||r>1||!s(r))break t;return{values:[...C(t,e,a),r],a:r,type:n}}case"hsva":{const[,,,t,e,a,r]=i(o);if(t>360||e>100||a>100||r<0||r>1||!s(r))break t;return{values:[t,e,a,r],a:r,type:n}}}}return{values:null,type:null}}function T(){const t=(t,e)=>function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return e(~i?t.map((t=>Number(t.toFixed(i)))):t)},e={h:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,v:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,toHSVA(){const i=[e.h,e.s,e.v,e.a];return i.toString=t(i,(t=>`hsva(${t[0]}, ${t[1]}%, ${t[2]}%, ${e.a})`)),i},toHSLA(){const i=[...v(e.h,e.s,e.v),e.a];return i.toString=t(i,(t=>`hsla(${t[0]}, ${t[1]}%, ${t[2]}%, ${e.a})`)),i},toRGBA(){const i=[...m(e.h,e.s,e.v),e.a];return i.toString=t(i,(t=>`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${e.a})`)),i},toCMYK(){const i=b(e.h,e.s,e.v);return i.toString=t(i,(t=>`cmyk(${t[0]}%, ${t[1]}%, ${t[2]}%, ${t[3]}%)`)),i},toHEXA(){const t=f(e.h,e.s,e.v),i=e.a>=1?"":Number((255*e.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return i&&t.push(i),t.toString=()=>`#${t.join("").toUpperCase()}`,t},clone:()=>T(e.h,e.s,e.v,e.a)};return e}const E=t=>Math.max(Math.min(t,1),0);function S(t){const e={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},t),_keyboard(t){const{options:i}=e,{type:o,key:n}=t;if(document.activeElement===i.wrapper){const{lock:i}=e.options,s="ArrowUp"===n,a="ArrowRight"===n,r="ArrowDown"===n,l="ArrowLeft"===n;if("keydown"===o&&(s||a||r||l)){let o=0,n=0;"v"===i?o=s||a?1:-1:"h"===i?o=s||a?-1:1:(n=s?-1:r?1:0,o=l?-1:a?1:0),e.update(E(e.cache.x+.01*o),E(e.cache.y+.01*n)),t.preventDefault()}else n.startsWith("Arrow")&&(e.options.onstop(),t.preventDefault())}},_tapstart(t){n(document,["mouseup","touchend","touchcancel"],e._tapstop),n(document,["mousemove","touchmove"],e._tapmove),t.cancelable&&t.preventDefault(),e._tapmove(t)},_tapmove(t){const{options:i,cache:o}=e,{lock:n,element:s,wrapper:a}=i,r=a.getBoundingClientRect();let l=0,c=0;if(t){const e=t&&t.touches&&t.touches[0];l=t?(e||t).clientX:0,c=t?(e||t).clientY:0,l<r.left?l=r.left:l>r.left+r.width&&(l=r.left+r.width),c<r.top?c=r.top:c>r.top+r.height&&(c=r.top+r.height),l-=r.left,c-=r.top}else o&&(l=o.x*r.width,c=o.y*r.height);"h"!==n&&(s.style.left=`calc(${l/r.width*100}% - ${s.offsetWidth/2}px)`),"v"!==n&&(s.style.top=`calc(${c/r.height*100}% - ${s.offsetHeight/2}px)`),e.cache={x:l/r.width,y:c/r.height};const d=E(l/r.width),h=E(c/r.height);switch(n){case"v":return i.onchange(d);case"h":return i.onchange(h);default:return i.onchange(d,h)}},_tapstop(){e.options.onstop(),s(document,["mouseup","touchend","touchcancel"],e._tapstop),s(document,["mousemove","touchmove"],e._tapmove)},trigger(){e._tapmove()},update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{left:o,top:n,width:s,height:a}=e.options.wrapper.getBoundingClientRect();"h"===e.options.lock&&(i=t),e._tapmove({clientX:o+s*t,clientY:n+a*i})},destroy(){const{options:t,_tapstart:i,_keyboard:o}=e;s(document,["keydown","keyup"],o),s([t.wrapper,t.element],"mousedown",i),s([t.wrapper,t.element],"touchstart",i,{passive:!1})}},{options:i,_tapstart:o,_keyboard:a}=e;return n([i.wrapper,i.element],"mousedown",o),n([i.wrapper,i.element],"touchstart",o,{passive:!1}),n(document,["keydown","keyup"],a),e}function q(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({onchange:()=>0,className:"",elements:[]},t);const e=n(t.elements,"click",(e=>{t.elements.forEach((i=>i.classList[e.target===i?"add":"remove"](t.className))),t.onchange(e),e.stopPropagation()}));return{destroy:()=>s(...e)}}const _={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8},M=(t,e,i)=>{const{container:o,margin:n,position:s,variantFlipOrder:a,positionFlipOrder:r}={container:document.documentElement.getBoundingClientRect(),..._,...i},{left:l,top:c}=e.style;e.style.left="0",e.style.top="0";const d=t.getBoundingClientRect(),h=e.getBoundingClientRect(),u={t:d.top-h.height-n,b:d.bottom+n,r:d.right+n,l:d.left-h.width-n},p={vs:d.left,vm:d.left+d.width/2+-h.width/2,ve:d.left+d.width-h.width,hs:d.top,hm:d.bottom-d.height/2-h.height/2,he:d.bottom-h.height},[g,m="middle"]=s.split("-"),f=r[g],b=a[m],{top:v,left:y,bottom:w,right:C}=o;for(const t of f){const i="t"===t||"b"===t,o=u[t],[n,s]=i?["top","left"]:["left","top"],[a,r]=i?[h.height,h.width]:[h.width,h.height],[l,c]=i?[w,C]:[C,w],[d,g]=i?[v,y]:[y,v];if(!(o<d||o+a>l))for(const a of b){const l=p[(i?"v":"h")+a];if(!(l<g||l+r>c))return e.style[s]=l-h[s]+"px",e.style[n]=o-h[n]+"px",t+a}}return e.style.left=l,e.style.top=c,null};function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class B{constructor(t){A(this,"_initializingActive",!0),A(this,"_recalc",!0),A(this,"_nanopop",null),A(this,"_root",null),A(this,"_color",T()),A(this,"_lastColor",T()),A(this,"_swatchColors",[]),A(this,"_setupAnimationFrame",null),A(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]}),this.options=t=Object.assign({...B.DEFAULT_OPTIONS},t);const{swatches:e,components:i,theme:o,sliders:n,lockOpacity:s,padding:a}=t;["nano","monolith"].includes(o)&&!n&&(t.sliders="h"),i.interaction||(i.interaction={});const{preview:r,opacity:l,hue:c,palette:d}=i;i.opacity=!s&&l,i.palette=d||r||l||c,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),e&&e.length&&e.forEach((t=>this.addSwatch(t)));const{button:h,app:u}=this._root;this._nanopop=((t,e,i)=>{const o="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...i}:t;return{update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;const{reference:e,popper:i}=Object.assign(o,t);if(!i||!e)throw new Error("Popper- or reference-element missing.");return M(e,i,o)}}})(h,u,{margin:a}),h.setAttribute("role","button"),h.setAttribute("aria-label",this._t("btn:toggle"));const p=this;this._setupAnimationFrame=requestAnimationFrame((function e(){if(!u.offsetWidth)return p._setupAnimationFrame=requestAnimationFrame(e);p.setColor(t.default),p._rePositioningPicker(),t.defaultRepresentation&&(p._representation=t.defaultRepresentation,p.setColorRepresentation(p._representation)),t.showAlways&&p.show(),p._initializingActive=!1,p._emit("init")}))}_preBuild(){const{options:t}=this;for(const e of["el","container"])t[e]=c(t[e]);this._root=(t=>{const{components:e,useAsButton:i,inline:o,appClass:n,theme:s,lockOpacity:a}=t.options,l=t=>t?"":'style="display:none" hidden',c=e=>t._t(e),d=r(`\n      <div :ref="root" class="pickr">\n\n        ${i?"":'<button type="button" :ref="button" class="pcr-button"></button>'}\n\n        <div :ref="app" class="pcr-app ${n||""}" data-theme="${s}" ${o?'style="position: unset"':""} aria-label="${c("ui:dialog")}" role="window">\n          <div class="pcr-selection" ${l(e.palette)}>\n            <div :obj="preview" class="pcr-color-preview" ${l(e.preview)}>\n              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${c("btn:last-color")}"></button>\n              <div :ref="currentColor" class="pcr-current-color"></div>\n            </div>\n\n            <div :obj="palette" class="pcr-color-palette">\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${c("aria:palette")}" role="listbox"></div>\n            </div>\n\n            <div :obj="hue" class="pcr-color-chooser" ${l(e.hue)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${c("aria:hue")}" role="slider"></div>\n            </div>\n\n            <div :obj="opacity" class="pcr-color-opacity" ${l(e.opacity)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${c("aria:opacity")}" role="slider"></div>\n            </div>\n          </div>\n\n          <div class="pcr-swatches ${e.palette?"":"pcr-last"}" :ref="swatches"></div>\n\n          <div :obj="interaction" class="pcr-interaction" ${l(Object.keys(e.interaction).length)}>\n            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${l(e.interaction.input)} aria-label="${c("aria:input")}">\n\n            <input :arr="options" class="pcr-type" data-type="HEXA" value="${a?"HEX":"HEXA"}" type="button" ${l(e.interaction.hex)}>\n            <input :arr="options" class="pcr-type" data-type="RGBA" value="${a?"RGB":"RGBA"}" type="button" ${l(e.interaction.rgba)}>\n            <input :arr="options" class="pcr-type" data-type="HSLA" value="${a?"HSL":"HSLA"}" type="button" ${l(e.interaction.hsla)}>\n            <input :arr="options" class="pcr-type" data-type="HSVA" value="${a?"HSV":"HSVA"}" type="button" ${l(e.interaction.hsva)}>\n            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${l(e.interaction.cmyk)}>\n\n            <input :ref="save" class="pcr-save" value="${c("btn:save")}" type="button" ${l(e.interaction.save)} aria-label="${c("aria:btn:save")}">\n            <input :ref="cancel" class="pcr-cancel" value="${c("btn:cancel")}" type="button" ${l(e.interaction.cancel)} aria-label="${c("aria:btn:cancel")}">\n            <input :ref="clear" class="pcr-clear" value="${c("btn:clear")}" type="button" ${l(e.interaction.clear)} aria-label="${c("aria:btn:clear")}">\n          </div>\n        </div>\n      </div>\n    `),h=d.interaction;return h.options.find((t=>!t.hidden&&!t.classList.add("active"))),h.type=()=>h.options.find((t=>t.classList.contains("active"))),d})(this),t.useAsButton&&(this._root.button=t.el),t.container.appendChild(this._root.root)}_finalBuild(){const t=this.options,e=this._root;if(t.container.removeChild(e.root),t.inline){const i=t.el.parentElement;t.el.nextSibling?i.insertBefore(e.app,t.el.nextSibling):i.appendChild(e.app)}else t.container.appendChild(e.app);t.useAsButton?t.inline&&t.el.remove():t.el.parentNode.replaceChild(e.root,t.el),t.disabled&&this.disable(),t.comparison||(e.button.style.transition="none",t.useAsButton||(e.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const t=this,e=this.options.components,i=(t.options.sliders||"v").repeat(2),[o,n]=i.match(/^[vh]+$/g)?i:[],s=()=>this._color||(this._color=this._lastColor.clone()),a={palette:S({element:t._root.palette.picker,wrapper:t._root.palette.palette,onstop:()=>t._emit("changestop","slider",t),onchange(i,o){if(!e.palette)return;const n=s(),{_root:a,options:r}=t,{lastColor:l,currentColor:c}=a.preview;t._recalc&&(n.s=100*i,n.v=100-100*o,n.v<0&&(n.v=0),t._updateOutput("slider"));const d=n.toRGBA().toString(0);this.element.style.background=d,this.wrapper.style.background=`\n                        linear-gradient(to top, rgba(0, 0, 0, ${n.a}), transparent),\n                        linear-gradient(to left, hsla(${n.h}, 100%, 50%, ${n.a}), rgba(255, 255, 255, ${n.a}))\n                    `,r.comparison?r.useAsButton||t._lastColor||l.style.setProperty("--pcr-color",d):(a.button.style.setProperty("--pcr-color",d),a.button.classList.remove("clear"));const h=n.toHEXA().toString();for(const{el:e,color:i}of t._swatchColors)e.classList[h===i.toHEXA().toString()?"add":"remove"]("pcr-active");c.style.setProperty("--pcr-color",d)}}),hue:S({lock:"v"===n?"h":"v",element:t._root.hue.picker,wrapper:t._root.hue.slider,onstop:()=>t._emit("changestop","slider",t),onchange(i){if(!e.hue||!e.palette)return;const o=s();t._recalc&&(o.h=360*i),this.element.style.backgroundColor=`hsl(${o.h}, 100%, 50%)`,a.palette.trigger()}}),opacity:S({lock:"v"===o?"h":"v",element:t._root.opacity.picker,wrapper:t._root.opacity.slider,onstop:()=>t._emit("changestop","slider",t),onchange(i){if(!e.opacity||!e.palette)return;const o=s();t._recalc&&(o.a=Math.round(100*i)/100),this.element.style.background=`rgba(0, 0, 0, ${o.a})`,a.palette.trigger()}}),selectable:q({elements:t._root.interaction.options,className:"active",onchange(e){t._representation=e.target.getAttribute("data-type").toUpperCase(),t._recalc&&t._updateOutput("swatch")}})};this._components=a}_bindEvents(){const{_root:t,options:e}=this,i=[n(t.interaction.clear,"click",(()=>this._clearColor())),n([t.interaction.cancel,t.preview.lastColor],"click",(()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")})),n(t.interaction.save,"click",(()=>{!this.applyColor()&&!e.showAlways&&this.hide()})),n(t.interaction.result,["keyup","input"],(t=>{this.setColor(t.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),t.stopImmediatePropagation()})),n(t.interaction.result,["focus","blur"],(t=>{this._recalc="blur"===t.type,this._recalc&&this._updateOutput(null)})),n([t.palette.palette,t.palette.picker,t.hue.slider,t.hue.picker,t.opacity.slider,t.opacity.picker],["mousedown","touchstart"],(()=>this._recalc=!0),{passive:!0})];if(!e.showAlways){const o=e.closeWithKey;i.push(n(t.button,"click",(()=>this.isOpen()?this.hide():this.show())),n(document,"keyup",(t=>this.isOpen()&&(t.key===o||t.code===o)&&this.hide())),n(document,["touchstart","mousedown"],(e=>{this.isOpen()&&!l(e).some((e=>e===t.app||e===t.button))&&this.hide()}),{capture:!0}))}if(e.adjustableNumbers){const e={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};d(t.interaction.result,((t,i,o)=>{const n=e[this.getColorRepresentation().toLowerCase()];if(n){const e=n[o],s=t+(e>=100?1e3*i:i);return s<=0?0:Number((s<e?s:e).toPrecision(3))}return t}))}if(e.autoReposition&&!e.inline){let t=null;const o=this;i.push(n(window,["scroll","resize"],(()=>{o.isOpen()&&(e.closeOnScroll&&o.hide(),null===t?(t=setTimeout((()=>t=null),100),requestAnimationFrame((function e(){o._rePositioningPicker(),null!==t&&requestAnimationFrame(e)}))):(clearTimeout(t),t=setTimeout((()=>t=null),100)))}),{capture:!0}))}this._eventBindings=i}_rePositioningPicker(){const{options:t}=this;if(!t.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:t.position})){const t=this._root.app,e=t.getBoundingClientRect();t.style.top=(window.innerHeight-e.height)/2+"px",t.style.left=(window.innerWidth-e.width)/2+"px"}}_updateOutput(t){const{_root:e,_color:i,options:o}=this;if(e.interaction.type()){const t=`to${e.interaction.type().getAttribute("data-type")}`;e.interaction.result.value="function"==typeof i[t]?i[t]().toString(o.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",i,t,this)}_clearColor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{_root:e,options:i}=this;i.useAsButton||e.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),e.button.classList.add("clear"),i.showAlways||this.hide(),this._lastColor=null,this._initializingActive||t||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(t){const{values:e,type:i,a:o}=x(t),{lockOpacity:n}=this.options,s=void 0!==o&&1!==o;return e&&3===e.length&&(e[3]=void 0),{values:!e||n&&s?null:e,type:i}}_t(t){return this.options.i18n[t]||B.I18N_DEFAULTS[t]}_emit(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];this._eventListener[t].forEach((t=>t(...i,this)))}on(t,e){return this._eventListener[t].push(e),this}off(t,e){const i=this._eventListener[t]||[],o=i.indexOf(e);return~o&&i.splice(o,1),this}addSwatch(t){const{values:e}=this._parseLocalColor(t);if(e){const{_swatchColors:t,_root:i}=this,o=T(...e),s=a(`<button type="button" style="--pcr-color: ${o.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return i.swatches.appendChild(s),t.push({el:s,color:o}),this._eventBindings.push(n(s,"click",(()=>{this.setHSVA(...o.toHSVA(),!0),this._emit("swatchselect",o),this._emit("change",o,"swatch",this)}))),!0}return!1}removeSwatch(t){const e=this._swatchColors[t];if(e){const{el:i}=e;return this._root.swatches.removeChild(i),this._swatchColors.splice(t,1),!0}return!1}applyColor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{preview:e,button:i}=this._root,o=this._color.toRGBA().toString(0);return e.lastColor.style.setProperty("--pcr-color",o),this.options.useAsButton||i.style.setProperty("--pcr-color",o),i.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||t||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach((t=>s(...t))),Object.keys(this._components).forEach((t=>this._components[t].destroy()))}destroyAndRemove(){this.destroy();const{root:t,app:e}=this._root;t.parentElement&&t.parentElement.removeChild(t),e.parentElement.removeChild(e),Object.keys(this).forEach((t=>this[t]=null))}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:360,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=this._recalc;if(this._recalc=!1,t<0||t>360||e<0||e>100||i<0||i>100||o<0||o>1)return!1;this._color=T(t,e,i,o);const{hue:a,opacity:r,palette:l}=this._components;return a.update(t/360),r.update(o),l.update(e/100,1-i/100),n||this.applyColor(),s&&this._updateOutput(),this._recalc=s,!0}setColor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null===t)return this._clearColor(e),!0;const{values:i,type:o}=this._parseLocalColor(t);if(i){const t=o.toUpperCase(),{options:n}=this._root.interaction,s=n.find((e=>e.getAttribute("data-type")===t));if(s&&!s.hidden)for(const t of n)t.classList[t===s?"add":"remove"]("active");return!!this.setHSVA(...i,e)&&this.setColorRepresentation(t)}return!1}setColorRepresentation(t){return t=t.toUpperCase(),!!this._root.interaction.options.find((e=>e.getAttribute("data-type").startsWith(t)&&!e.click()))}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}return A(B,"utils",i),A(B,"version","1.8.4"),A(B,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),A(B,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),A(B,"create",(t=>new B(t))),e.default})()})),We=ze(Re),je=[],Ze=[];!function(t,e){if(t&&"undefined"!=typeof document){var i,o=!0===e.prepend?"prepend":"append",n=!0===e.singleTag,s="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(n){var a=je.indexOf(s);-1===a&&(a=je.push(s)-1,Ze[a]={}),i=Ze[a]&&Ze[a][o]?Ze[a][o]:Ze[a][o]=r()}else i=r();65279===t.charCodeAt(0)&&(t=t.substring(1)),i.styleSheet?i.styleSheet.cssText+=t:i.appendChild(document.createTextNode(t))}function r(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),e.attributes)for(var i=Object.keys(e.attributes),n=0;n<i.length;n++)t.setAttribute(i[n],e.attributes[i[n]]);var a="prepend"===o?"afterbegin":"beforeend";return s.insertAdjacentElement(a,t),t}}('/*! Pickr 1.8.4 MIT | https://github.com/Simonwep/pickr */\n.pickr{position:relative;overflow:visible;transform:translateY(0)}.pickr *{box-sizing:border-box;outline:none;border:none;-webkit-appearance:none}.pickr .pcr-button{position:relative;height:2em;width:2em;padding:0.5em;cursor:pointer;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Helvetica Neue",Arial,sans-serif;border-radius:.15em;background:url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" stroke="%2342445A" stroke-width="5px" stroke-linecap="round"><path d="M45,45L5,5"></path><path d="M45,5L5,45"></path></svg>\') no-repeat center;background-size:0;transition:all 0.3s}.pickr .pcr-button::before{position:absolute;content:\'\';top:0;left:0;width:100%;height:100%;background:url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>\');background-size:.5em;border-radius:.15em;z-index:-1}.pickr .pcr-button::before{z-index:initial}.pickr .pcr-button::after{position:absolute;content:\'\';top:0;left:0;height:100%;width:100%;transition:background 0.3s;background:var(--pcr-color);border-radius:.15em}.pickr .pcr-button.clear{background-size:70%}.pickr .pcr-button.clear::before{opacity:0}.pickr .pcr-button.clear:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px var(--pcr-color)}.pickr .pcr-button.disabled{cursor:not-allowed}.pickr *,.pcr-app *{box-sizing:border-box;outline:none;border:none;-webkit-appearance:none}.pickr input:focus,.pickr input.pcr-active,.pickr button:focus,.pickr button.pcr-active,.pcr-app input:focus,.pcr-app input.pcr-active,.pcr-app button:focus,.pcr-app button.pcr-active{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px var(--pcr-color)}.pickr .pcr-palette,.pickr .pcr-slider,.pcr-app .pcr-palette,.pcr-app .pcr-slider{transition:box-shadow 0.3s}.pickr .pcr-palette:focus,.pickr .pcr-slider:focus,.pcr-app .pcr-palette:focus,.pcr-app .pcr-slider:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(0,0,0,0.25)}.pcr-app{position:fixed;display:flex;flex-direction:column;z-index:10000;border-radius:0.1em;background:#fff;opacity:0;visibility:hidden;transition:opacity 0.3s, visibility 0s 0.3s;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Helvetica Neue",Arial,sans-serif;box-shadow:0 0.15em 1.5em 0 rgba(0,0,0,0.1),0 0 1em 0 rgba(0,0,0,0.03);left:0;top:0}.pcr-app.visible{transition:opacity 0.3s;visibility:visible;opacity:1}.pcr-app .pcr-swatches{display:flex;flex-wrap:wrap;margin-top:0.75em}.pcr-app .pcr-swatches.pcr-last{margin:0}@supports (display: grid){.pcr-app .pcr-swatches{display:grid;align-items:center;grid-template-columns:repeat(auto-fit, 1.75em)}}.pcr-app .pcr-swatches>button{font-size:1em;position:relative;width:calc(1.75em - 5px);height:calc(1.75em - 5px);border-radius:0.15em;cursor:pointer;margin:2.5px;flex-shrink:0;justify-self:center;transition:all 0.15s;overflow:hidden;background:transparent;z-index:1}.pcr-app .pcr-swatches>button::before{position:absolute;content:\'\';top:0;left:0;width:100%;height:100%;background:url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>\');background-size:6px;border-radius:.15em;z-index:-1}.pcr-app .pcr-swatches>button::after{content:\'\';position:absolute;top:0;left:0;width:100%;height:100%;background:var(--pcr-color);border:1px solid rgba(0,0,0,0.05);border-radius:0.15em;box-sizing:border-box}.pcr-app .pcr-swatches>button:hover{filter:brightness(1.05)}.pcr-app .pcr-swatches>button:not(.pcr-active){box-shadow:none}.pcr-app .pcr-interaction{display:flex;flex-wrap:wrap;align-items:center;margin:0 -0.2em 0 -0.2em}.pcr-app .pcr-interaction>*{margin:0 0.2em}.pcr-app .pcr-interaction input{letter-spacing:0.07em;font-size:0.75em;text-align:center;cursor:pointer;color:#75797e;background:#f1f3f4;border-radius:.15em;transition:all 0.15s;padding:0.45em 0.5em;margin-top:0.75em}.pcr-app .pcr-interaction input:hover{filter:brightness(0.975)}.pcr-app .pcr-interaction input:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(66,133,244,0.75)}.pcr-app .pcr-interaction .pcr-result{color:#75797e;text-align:left;flex:1 1 8em;min-width:8em;transition:all 0.2s;border-radius:.15em;background:#f1f3f4;cursor:text}.pcr-app .pcr-interaction .pcr-result::-moz-selection{background:#4285f4;color:#fff}.pcr-app .pcr-interaction .pcr-result::selection{background:#4285f4;color:#fff}.pcr-app .pcr-interaction .pcr-type.active{color:#fff;background:#4285f4}.pcr-app .pcr-interaction .pcr-save,.pcr-app .pcr-interaction .pcr-cancel,.pcr-app .pcr-interaction .pcr-clear{color:#fff;width:auto}.pcr-app .pcr-interaction .pcr-save,.pcr-app .pcr-interaction .pcr-cancel,.pcr-app .pcr-interaction .pcr-clear{color:#fff}.pcr-app .pcr-interaction .pcr-save:hover,.pcr-app .pcr-interaction .pcr-cancel:hover,.pcr-app .pcr-interaction .pcr-clear:hover{filter:brightness(0.925)}.pcr-app .pcr-interaction .pcr-save{background:#4285f4}.pcr-app .pcr-interaction .pcr-clear,.pcr-app .pcr-interaction .pcr-cancel{background:#f44250}.pcr-app .pcr-interaction .pcr-clear:focus,.pcr-app .pcr-interaction .pcr-cancel:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(244,66,80,0.75)}.pcr-app .pcr-selection .pcr-picker{position:absolute;height:18px;width:18px;border:2px solid #fff;border-radius:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.pcr-app .pcr-selection .pcr-color-palette,.pcr-app .pcr-selection .pcr-color-chooser,.pcr-app .pcr-selection .pcr-color-opacity{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column;cursor:grab;cursor:-webkit-grab}.pcr-app .pcr-selection .pcr-color-palette:active,.pcr-app .pcr-selection .pcr-color-chooser:active,.pcr-app .pcr-selection .pcr-color-opacity:active{cursor:grabbing;cursor:-webkit-grabbing}.pcr-app[data-theme=\'nano\']{width:14.25em;max-width:95vw}.pcr-app[data-theme=\'nano\'] .pcr-swatches{margin-top:.6em;padding:0 .6em}.pcr-app[data-theme=\'nano\'] .pcr-interaction{padding:0 .6em .6em .6em}.pcr-app[data-theme=\'nano\'] .pcr-selection{display:grid;grid-gap:.6em;grid-template-columns:1fr 4fr;grid-template-rows:5fr auto auto;align-items:center;height:10.5em;width:100%;align-self:flex-start}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-preview{grid-area:2 / 1 / 4 / 1;height:100%;width:100%;display:flex;flex-direction:row;justify-content:center;margin-left:.6em}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-preview .pcr-last-color{display:none}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-preview .pcr-current-color{position:relative;background:var(--pcr-color);width:2em;height:2em;border-radius:50em;overflow:hidden}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-preview .pcr-current-color::before{position:absolute;content:\'\';top:0;left:0;width:100%;height:100%;background:url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>\');background-size:.5em;border-radius:.15em;z-index:-1}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-palette{grid-area:1 / 1 / 2 / 3;width:100%;height:100%;z-index:1}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-palette .pcr-palette{border-radius:.15em;width:100%;height:100%}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-palette .pcr-palette::before{position:absolute;content:\'\';top:0;left:0;width:100%;height:100%;background:url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>\');background-size:.5em;border-radius:.15em;z-index:-1}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-chooser{grid-area:2 / 2 / 2 / 2}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-opacity{grid-area:3 / 2 / 3 / 2}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-chooser,.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-opacity{height:0.5em;margin:0 .6em}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-chooser .pcr-picker,.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-opacity .pcr-picker{top:50%;transform:translateY(-50%)}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-chooser .pcr-slider,.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-opacity .pcr-slider{flex-grow:1;border-radius:50em}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-chooser .pcr-slider{background:linear-gradient(to right, red, #ff0, lime, cyan, blue, #f0f, red)}.pcr-app[data-theme=\'nano\'] .pcr-selection .pcr-color-opacity .pcr-slider{background:linear-gradient(to right, transparent, black),url(\'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>\');background-size:100%, 0.25em}\n\n',{});class Ue extends t.Modal{constructor(t,e,i){if(super(t),this.plugin=e,this.commandIndex=i,null!==i){const t=e.settings.customCommands[i];this.commandId=t.id,this.commandName=t.name,this.prefix=t.prefix,this.suffix=t.suffix,this.char=t.char,this.line=t.line,this.islinehead=t.islinehead,this.icon=t.icon||""}else this.commandId="",this.commandName="",this.prefix="",this.suffix="",this.char=0,this.line=0,this.islinehead=!1,this.icon=""}onOpen(){const{contentEl:e}=this;e.empty(),e.createEl("h2",{text:null!==this.commandIndex?"Edit Custom Command":"Add Custom Command"}),new t.Setting(e).setName(g("Command ID")).setDesc(g('Unique identifier, no spaces, e.g.: "my-custom-format"')).addText((t=>t.setValue(this.commandId).onChange((t=>{this.commandId=t;const i=e.querySelector(".setting-item:nth-child(3) input");i instanceof HTMLInputElement&&(i.value=t,this.commandName=t)})))),new t.Setting(e).setName(g("Command Name")).setDesc(g("Displayed name in toolbar and menu")).addText((t=>t.setValue(this.commandName).onChange((t=>this.commandName=t)))),new t.Setting(e).setName(g("Prefix")).setDesc(g("Add content before selected text")).addText((t=>t.setValue(this.prefix).onChange((t=>{this.prefix=t;const i=this.getMirrorText(t);if(i){this.suffix=i;const t=e.querySelector(".setting-item:nth-child(5) input");t instanceof HTMLInputElement&&(t.value=i,this.suffix=i)}})))),new t.Setting(e).setName(g("Suffix")).setDesc(g("Add content after selected text")).addText((t=>t.setValue(this.suffix).onChange((t=>this.suffix=t)))),new t.Setting(e).setName(g("Cursor Position Offset")).setDesc(g("Default 0, format will keep the text selected")).addText((t=>t.setValue(this.char.toString()).onChange((t=>this.char=parseInt(t)||0)))),new t.Setting(e).setName(g("Line Offset")).setDesc(g("Line offset of cursor after formatting")).addText((t=>t.setValue(this.line.toString()).onChange((t=>this.line=parseInt(t)||0)))),new t.Setting(e).setName(g("Line Head Format")).setDesc(g("Whether to insert at the beginning of the next line")).addToggle((t=>t.setValue(this.islinehead).onChange((t=>this.islinehead=t))));const i=new t.Setting(e).setName(g("Icon")).setDesc(g("Command icon (click to select)"));if(this.iconDisplay=i.controlEl.createDiv("editingToolbarSettingsIcon"),this.icon)try{t.setIcon(this.iconDisplay,this.icon)}catch(t){this.iconDisplay.setText(this.icon)}i.addButton((e=>e.setButtonText(g("Choose Icon")).onClick((()=>{const e={id:this.commandId,name:this.commandName,icon:this.icon};new m(this.plugin,e,!1,(e=>{if(this.icon=e,this.iconDisplay.empty(),this.icon)try{t.setIcon(this.iconDisplay,this.icon)}catch(t){this.iconDisplay.setText(this.icon)}const o=i.controlEl.querySelector("input");o&&(o.value=this.icon)})).open()})))),new t.Setting(e).addButton((e=>e.setButtonText(g("Save")).setCta().onClick((()=>{if(!this.commandId||!this.commandName)return void new t.Notice(g("Command ID and command name cannot be empty"));if(this.commandId.includes(" "))return void new t.Notice(g("Command ID cannot contain spaces"));if(null===this.commandIndex){if(this.plugin.settings.customCommands.findIndex((t=>t.id===this.commandId))>=0)return void new t.Notice(g("The command")+this.commandId+g("already exists"),8e3)}const e={id:this.commandId,name:this.commandName,prefix:this.prefix,suffix:this.suffix,char:this.char,line:this.line,islinehead:this.islinehead,icon:this.icon};null!==this.commandIndex?this.plugin.settings.customCommands[this.commandIndex]=e:this.plugin.settings.customCommands.push(e),this.plugin.saveSettings().then((()=>{this.close(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand")),this.plugin.reloadCustomCommands()}),100)}))})))).addButton((t=>t.setButtonText(g("Cancel")).onClick((()=>this.close()))))}onClose(){const{contentEl:t}=this;t.empty()}getMirrorText(t){const e={"**":"**","*":"*",__:"__",_:"_","~~":"~~","`":"`","```":"```",$:"$",$$:"$$","(":")","[":"]","{":"}","<":">","==":"==","*==":"==*","**==":"==**","***==":"==***"};if(!t)return"";if(t in e)return e[t];const i=t.match(/^<(\w+)([^>]*)>$/);return i?`</${i[1]}>`:""}}const Xe=[{id:"general",name:g("General"),icon:"gear"},{id:"appearance",name:g("Appearance"),icon:"brush"},{id:"customcommands",name:g("Custom Commands"),icon:"custom-command"},{id:"commands",name:g("Toolbar Commands"),icon:"command"}];function Ge(t){const{el:e,containerEl:i,swatches:o,opacity:n,defaultColor:s}=t;return{el:e,container:i,theme:"nano",swatches:o,lockOpacity:!n,default:s,position:"left-middle",components:{preview:!0,hue:!0,opacity:!!n,interaction:{hex:!0,rgba:!1,hsla:!1,input:!0,cancel:!0,save:!0}}}}function Ye(t,e){let i;return e.forEach(((e,o)=>{e.id===t&&(i=o)})),i}class Ke extends t.PluginSettingTab{constructor(t,e){super(t,e),this.pickrs=[],this.activeTab="general",this.plugin=e,addEventListener("editingToolbar-NewCommand",(()=>{S(),F(t,this.plugin),this.display()}))}display(){this.destroyPickrs();const{containerEl:t}=this;t.empty(),this.createHeader(t);const e=t.createEl("div",{cls:"editing-toolbar-tabs"});Xe.forEach((t=>{const i=e.createEl("div",{cls:"editing-toolbar-tab "+(this.activeTab===t.id?"active":"")});i.createEl("span",{cls:`setting-editor-icon ${t.icon}`}),i.createEl("span",{text:t.name}),i.addEventListener("click",(()=>{this.activeTab=t.id,this.display()}))}));const i=t.createEl("div",{cls:"editing-toolbar-content"});switch(this.activeTab){case"general":this.displayGeneralSettings(i);break;case"appearance":this.displayAppearanceSettings(i);break;case"customcommands":this.displayCustomCommandSettings(i);break;case"commands":this.displayCommandSettings(i)}}displayGeneralSettings(e){new t.Setting(e).setName(g("Editing Toolbar append method")).setDesc(g("Choose where Editing Toolbar will append upon regeneration.")).addDropdown((t=>{let e={};w.map((t=>e[t]=t)),t.addOptions(e),t.setValue(this.plugin.settings.appendMethod).onChange((t=>{this.plugin.settings.appendMethod=t,this.plugin.saveSettings()}))})),new t.Setting(e).setName(g("Mobile enabled or not")).setDesc(g("Whether to enable on mobile devices with device width less than 768px")).addToggle((t=>{var e,i;return t.setValue(null!==(i=null===(e=this.plugin.settings)||void 0===e?void 0:e.isLoadOnMobile)&&void 0!==i&&i).onChange((t=>{this.plugin.settings.isLoadOnMobile=t,this.plugin.saveSettings(),this.triggerRefresh()}))}))}displayAppearanceSettings(i){new t.Setting(i).setName(g("Editing Toolbar aesthetic")).setDesc(g("Choose between a glass morphism, tiny and default style")).addDropdown((t=>{let e={};C.map((t=>e[t]=t)),t.addOptions(e).setValue(this.plugin.settings.aestheticStyle).onChange((t=>{this.plugin.settings.aestheticStyle=t,this.plugin.saveSettings(),this.triggerRefresh()}))})),new t.Setting(i).setName(g("Editing Toolbar position")).setDesc(g("Choose between fixed position or cursor following mode")).addDropdown((t=>{let e={};k.map((t=>e[t]=t)),t.addOptions(e).setValue(this.plugin.settings.positionStyle).onChange((t=>{this.plugin.settings.positionStyle=t,"top"==t&&(this.plugin.settings.aestheticStyle="glass"),"fixed"==t&&(this.plugin.settings.aestheticStyle="default"),"following"==t&&(this.plugin.settings.aestheticStyle="tiny"),this.plugin.saveSettings(),this.triggerRefresh()}))})),"top"==this.plugin.settings.positionStyle&&new t.Setting(i).setName(g("Editing Toolbar Auto-hide")).setDesc(g("The toolbar is displayed when the mouse moves over it, otherwise it is automatically hidden")).addToggle((t=>{var e;return t.setValue(null===(e=this.plugin.settings)||void 0===e?void 0:e.autohide).onChange((t=>{this.plugin.settings.autohide=t,this.plugin.saveSettings(),this.triggerRefresh()}))})),"fixed"==this.plugin.settings.positionStyle&&new t.Setting(i).setName(g("Editing Toolbar columns")).setDesc(g("Choose the number of columns per row to display on Editing Toolbar. To see the change, hit the refresh button below, or in the status bar menu.")).addSlider((i=>{i.setLimits(1,32,1).setValue(this.plugin.settings.cMenuNumRows).onChange(t.debounce((t=>e(this,void 0,void 0,(function*(){this.plugin.settings.cMenuNumRows=t,yield this.plugin.saveSettings()}))),100,!0)).setDynamicTooltip()})),this.createColorSettings(i)}displayCommandSettings(e){new t.Setting(e).setName(g("Editing Toolbar commands")).setDesc(g("Add a command onto Editing Toolbar from Obsidian's commands library. To reorder the commands, drag and drop the command items. To delete them, use the delete buttom to the right of the command item. Editing Toolbar will not automaticaly refresh after reordering commands. Use the refresh button above.")).addButton((t=>{t.setIcon("plus").setTooltip(g("Add")).onClick((()=>{new b(this.plugin).open(),this.triggerRefresh()}))})),this.createCommandList(e)}displayCustomCommandSettings(i){new t.Setting(i).setName(g("Custom Format Commands")).setDesc(g("Add, edit or delete custom format commands")).addButton((t=>t.setIcon("plus").setTooltip(g("Add")).onClick((()=>{new Ue(this.app,this.plugin,null).open()}))));const o=i.createDiv("custom-commands-container");this.plugin.settings.customCommands.forEach(((i,n)=>{new t.Setting(o).setName(i.name).setDesc(`${g("ID")}: ${i.id}, ${g("Prefix")}: ${i.prefix}, ${g("Suffix")}: ${i.suffix}`).addButton((t=>{t.setClass("editingToolbarSettingsIcon"),B(i.icon)?t.buttonEl.innerHTML=i.icon:t.setIcon(i.icon)})).addButton((e=>e.setButtonText(g("Add to Toolbar")).setTooltip(g("Add this command to the toolbar")).onClick((()=>{if(this.plugin.settings.menuCommands.some((t=>t.id===`editing-toolbar:custom-${i.id}`)))return void new t.Notice(g("This command is already in the toolbar"));const e={id:`editing-toolbar:custom-${i.id}`,name:i.name,icon:i.icon||"text"};this.plugin.settings.menuCommands.push(e),this.plugin.saveSettings().then((()=>{new t.Notice(g("Command added to toolbar")),dispatchEvent(new Event("editingToolbar-NewCommand")),this.plugin.reloadCustomCommands()}))})))).addButton((t=>t.setIcon("pencil").setTooltip(g("Edit")).onClick((()=>{new Ue(this.app,this.plugin,n).open()})))).addButton((t=>t.setIcon("editingToolbarDelete").setTooltip(g("Delete")).onClick((()=>e(this,void 0,void 0,(function*(){this.plugin.settings.customCommands.splice(n,1),yield this.plugin.saveSettings(),this.plugin.reloadCustomCommands(),this.display()}))))))}))}triggerRefresh(){setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100)}createHeader(e){const i=e.createEl("div",{cls:"editing-toolbar-header"});i.createEl("div",{cls:"editing-toolbar-title-container"}).createEl("h1",{text:"Obsidian Editing Toolbar:"+this.plugin.manifest.version,cls:"editing-toolbar-title"});const o=i.createEl("div",{cls:"editing-toolbar-info"});o.createEl("span",{text:"ä½œè€…ï¼š"}).createEl("a",{text:"Cuman âœ¨",href:"https://github.com/cumany"}),o.createEl("span",{text:"  æ•™ç¨‹ï¼š"}).createEl("a",{text:"pkmer.cn",href:"https://pkmer.cn/show/20230329145815"}),new t.Setting(o).setClass("editing-toolbar-fix-button").addButton((t=>{t.setIcon("wrench").setTooltip(g("Fix")).onClick((()=>{new $e(this.app,this.plugin).open()}))}))}createColorSettings(e){new t.Setting(e).setName(g("ğŸ¨ Set custom background")).setDesc(g("Click on the picker to adjust the colour")).setClass("custom_bg").then((t=>{const e=t.controlEl.createDiv({cls:"pickr-container"});for(let t=0;t<5;t++){const i=e.createDiv({cls:"picker"}),o=We.create(Ge({isView:!1,el:i,containerEl:e,swatches:["#FFB78B8C","#CDF4698C","#A0CCF68C","#F0A7D88C","#ADEFEF8C"],opacity:!0,defaultColor:this.plugin.settings[`custom_bg${t+1}`]||"#000000"}));this.setupPickrEvents(o,`custom_bg${t+1}`),this.pickrs.push(o)}})),new t.Setting(e).setName(g("ğŸ–Œï¸ Set custom font color")).setDesc(g("Click on the picker to adjust the colour")).setClass("custom_font").then((t=>{const e=t.controlEl.createDiv({cls:"pickr-container"});for(let t=0;t<5;t++){const i=e.createDiv({cls:"picker"}),o=We.create(Ge({isView:!1,el:i,containerEl:e,swatches:["#D83931","#DE7802","#245BDB","#6425D0","#646A73"],opacity:!0,defaultColor:this.plugin.settings[`custom_fc${t+1}`]||"#000000"}));this.setupPickrEvents(o,`custom_fc${t+1}`),this.pickrs.push(o)}}))}createCommandList(i){const n=i.createEl("div",{cls:"editingToolbarSettingsTabsContainer"});let s="";we.create(n,{group:"item",animation:500,draggable:".setting-item",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",dragoverBubble:!1,forceFallback:!0,fallbackOnBody:!0,swapThreshold:.7,fallbackClass:"sortable-fallback",easing:"cubic-bezier(1, 0, 0, 1)",delay:800,delayOnTouchOnly:!0,touchStartThreshold:5,onChoose:function(t){t.item.classList.add("sortable-chosen-feedback")},onUnchoose:function(t){t.item.classList.remove("sortable-chosen-feedback")},onSort:t=>{if(t.from.className===t.to.className){const e=this.plugin.settings.menuCommands,[i]=e.splice(t.oldIndex,1);e.splice(t.newIndex,0,i),this.plugin.saveSettings()}this.triggerRefresh()},onStart:function(t){s=t.item.className}}),this.plugin.settings.menuCommands.forEach(((i,a)=>{const r=new t.Setting(n);if("SubmenuCommands"in i){if(r.settingEl.setAttribute("data-id",i.id),r.setClass("editingToolbarCommandItem").setClass("editingToolbarCommandsubItem").setName(i.name).addButton((t=>{t.setClass("editingToolbarSettingsIcon").onClick((()=>e(this,void 0,void 0,(function*(){new m(this.plugin,i,!1).open()})))),B(i.icon)?t.buttonEl.innerHTML=i.icon:t.setIcon(i.icon)})).addButton((t=>{t.setIcon("editingToolbarDelete").setTooltip(g("Delete")).setClass("editingToolbarSettingsButton").setClass("editingToolbarSettingsButtonDelete").onClick((()=>e(this,void 0,void 0,(function*(){this.plugin.settings.menuCommands.remove(i),yield this.plugin.saveSettings(),this.display(),this.triggerRefresh(),console.log(`%cCommand '${i.name}' was removed from editingToolbar`,"color: #989cab")}))))})),"editingToolbar-plugin:change-font-color"==i.id)return;if("editingToolbar-plugin:change-background-color"==i.id)return;const o=r.settingEl.createEl("div",{cls:"editingToolbarSettingsTabsContainer_sub"});we.create(o,{group:{name:"item",pull:!0,put:function(){return!s.includes("editingToolbarCommandsubItem")}},draggable:".setting-item",animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",dragoverBubble:!1,fallbackOnBody:!0,swapThreshold:.7,forceFallback:!0,fallbackClass:"sortable-fallback",easing:"cubic-bezier(1, 0, 0, 1)",onStart:function(){},onSort:t=>{var e,i,o;if(t.from.className===t.to.className){const i=null===(e=this.plugin.settings.menuCommands[a])||void 0===e?void 0:e.SubmenuCommands;if(i){const[e]=i.splice(t.oldIndex,1);i.splice(t.newIndex,0,e),this.plugin.saveSettings()}}else if("editingToolbarSettingsTabsContainer"===t.to.className){const e=this.plugin.settings.menuCommands;const o=null===(i=e[Ye(t.target.parentElement.dataset.id,e)])||void 0===i?void 0:i.SubmenuCommands;if(o){const[i]=o.splice(t.oldIndex,1);e.splice(t.newIndex,0,i),this.plugin.saveSettings()}else console.error("Subresult is undefined.")}else if("editingToolbarSettingsTabsContainer"===t.from.className){const e=this.plugin.settings.menuCommands,i=null===(o=e[Ye(t.target.parentElement.dataset.id,e)])||void 0===o?void 0:o.SubmenuCommands;if(i){const[o]=e.splice(t.oldIndex,1);i.splice(t.newIndex,0,o),this.plugin.saveSettings()}else console.error("Subresult is undefined.")}this.triggerRefresh()}}),i.SubmenuCommands.forEach((n=>{const s=new t.Setting(o);s.setClass("editingToolbarCommandItem").addButton((t=>{t.setClass("editingToolbarSettingsIcon").onClick((()=>e(this,void 0,void 0,(function*(){new m(this.plugin,n,!0).open()})))),B(null==n?void 0:n.icon)?t.buttonEl.innerHTML=n.icon:t.setIcon(n.icon)})).setName(n.name).addButton((t=>{t.setIcon("pencil").setTooltip(g("Change Command name")).setClass("editingToolbarSettingsButton").onClick((()=>e(this,void 0,void 0,(function*(){new v(this.app,this.plugin,n,!0).open()}))))})).addButton((t=>{t.setIcon("editingToolbarDelete").setTooltip(g("Delete")).setClass("editingToolbarSettingsButton").setClass("editingToolbarSettingsButtonDelete").onClick((()=>e(this,void 0,void 0,(function*(){i.SubmenuCommands.remove(n),yield this.plugin.saveSettings(),this.display(),this.triggerRefresh(),console.log(`%cCommand '${i.name}' was removed from editingToolbar`,"color: #989cab")}))))})),s.nameEl}))}else r.addButton((t=>{t.setClass("editingToolbarSettingsIcon").onClick((()=>e(this,void 0,void 0,(function*(){new m(this.plugin,i,!1).open()})))),B(i.icon)?t.buttonEl.innerHTML=i.icon:t.setIcon(i.icon)})),"editingToolbar-Divider-Line"==i.id&&r.setClass("editingToolbar-Divider-Line"),r.setClass("editingToolbarCommandItem").setName(i.name).addButton((t=>{t.setIcon("pencil").setTooltip(g("Change Command name")).setClass("editingToolbarSettingsButton").onClick((()=>e(this,void 0,void 0,(function*(){new v(this.app,this.plugin,i,!1).open()}))))})).addButton((t=>{t.setIcon("editingToolbarSub").setTooltip(g("Add submenu")).setClass("editingToolbarSettingsButton").setClass("editingToolbarSettingsButtonaddsub").onClick((()=>e(this,void 0,void 0,(function*(){const t={id:"SubmenuCommands-"+o(1),name:"submenu",icon:"remix-Filter3Line",SubmenuCommands:[]};this.plugin.settings.menuCommands.splice(a+1,0,t),yield this.plugin.saveSettings(),this.display(),this.triggerRefresh(),console.log(`%cCommand '${t.id}' add `,"color: #989cab")}))))})).addButton((t=>{t.setIcon("vertical-split").setTooltip(g("add hr")).setClass("editingToolbarSettingsButton").setClass("editingToolbarSettingsButtonaddsub").onClick((()=>e(this,void 0,void 0,(function*(){this.plugin.settings.menuCommands.splice(a+1,0,{id:"editingToolbar-Divider-Line",name:"HR",icon:"vertical-split"}),yield this.plugin.saveSettings(),this.display(),this.triggerRefresh()}))))})).addButton((t=>{t.setIcon("editingToolbarDelete").setTooltip(g("Delete")).setClass("editingToolbarSettingsButton").setClass("editingToolbarSettingsButtonDelete").onClick((()=>e(this,void 0,void 0,(function*(){this.plugin.settings.menuCommands.remove(i),yield this.plugin.saveSettings(),this.display(),this.triggerRefresh(),console.log(`%cCommand '${i.name}' was removed from editingToolbar`,"color: #989cab")}))))}))}))}setupPickrEvents(t,i){t.on("save",((t,o)=>e(this,void 0,void 0,(function*(){t&&(this.plugin.settings[i]=t.toHEXA().toString(),yield this.plugin.saveSettings(),o.hide(),o.addSwatch(t.toHEXA().toString()))})))).on("show",(()=>{const{result:e}=t.getRoot().interaction;requestAnimationFrame((()=>e.select()))})).on("cancel",(t=>{t.hide()}))}destroyPickrs(){this.pickrs.forEach((t=>{t&&t.destroyAndRemove()})),this.pickrs=[]}hide(){this.destroyPickrs(),this.triggerRefresh()}}const Qe={editingToolbar:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"><path d="M19 10H5c-1.103 0-2 .897-2 2v8c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-8c0-1.103-.897-2-2-2zM5 20v-8h14l.002 8H5zM5 6h14v2H5zm2-4h10v2H7z" fill="currentColor"/></svg>',editingToolbarSub:'<svg t="1661526346488" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16880"  ><path d="M597.333333 85.333333h-341.333333C187.733333 85.333333 128 140.8 128 213.333333v597.333334c0 72.533333 59.733333 128 128 128h426.666667c72.533333 0 128-55.466667 128-128V298.666667l-213.333334-213.333334z m170.666667 725.333334c0 46.933333-38.4 85.333333-85.333333 85.333333H256c-46.933333 0-85.333333-38.4-85.333333-85.333333V213.333333c0-46.933333 38.4-85.333333 85.333333-85.333333h298.666667v213.333333h213.333333v469.333334z m-320-234.666667h128c12.8 0 21.333333 8.533333 21.333333 21.333333s-8.533333 21.333333-21.333333 21.333334h-128v128c0 12.8-8.533333 21.333333-21.333333 21.333333s-21.333333-8.533333-21.333334-21.333333v-128h-128c-12.8 0-21.333333-8.533333-21.333333-21.333334s8.533333-21.333333 21.333333-21.333333h128v-128c0-12.8 8.533333-21.333333 21.333334-21.333333s21.333333 8.533333 21.333333 21.333333v128z" fill="#8a8a8a" p-id="16881"></path></svg>',editingToolbarAdd:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="white" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4z" fill="currentColor"/><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10s10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8s8 3.589 8 8s-3.589 8-8 8z" fill="currentColor"/></svg>',editingToolbarDelete:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="white" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"><path d="M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z" fill="var(--text-error)"/><path d="M9 10h2v8H9zm4 0h2v8h-2z" fill="var(--text-error)"/></svg>',editingToolbarReload:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="white" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"><path d="M19 10H5c-1.103 0-2 .897-2 2v8c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-8c0-1.103-.897-2-2-2zM5 20v-8h14l.002 8H5zM5 6h14v2H5zm2-4h10v2H7z" fill="currentColor"/></svg>',"codeblock-glyph":'<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor" d="M20 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 19V7h16l.002 12H4z" fill="currentColor"/><path d="M9.293 9.293L5.586 13l3.707 3.707l1.414-1.414L8.414 13l2.293-2.293zm5.414 0l-1.414 1.414L15.586 13l-2.293 2.293l1.414 1.414L18.414 13z"/></svg>',"underline-glyph":'<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 1024 1024"><path fill="currentColor" d="M824 804H200c-4.4 0-8 3.4-8 7.6v60.8c0 4.2 3.6 7.6 8 7.6h624c4.4 0 8-3.4 8-7.6v-60.8c0-4.2-3.6-7.6-8-7.6zm-312-76c69.4 0 134.6-27.1 183.8-76.2C745 602.7 772 537.4 772 468V156c0-6.6-5.4-12-12-12h-60c-6.6 0-12 5.4-12 12v312c0 97-79 176-176 176s-176-79-176-176V156c0-6.6-5.4-12-12-12h-60c-6.6 0-12 5.4-12 12v312c0 69.4 27.1 134.6 76.2 183.8C377.3 701 442.6 728 512 728z"/></svg>',"superscript-glyph":'<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor"d="M16 7.41L11.41 12L16 16.59L14.59 18L10 13.41L5.41 18L4 16.59L8.59 12L4 7.41L5.41 6L10 10.59L14.59 6L16 7.41M21.85 9h-4.88V8l.89-.82c.76-.64 1.32-1.18 1.7-1.63c.37-.44.56-.85.57-1.23a.884.884 0 0 0-.27-.7c-.18-.19-.47-.28-.86-.29c-.31.01-.58.07-.84.17l-.66.39l-.45-1.17c.27-.22.59-.39.98-.53S18.85 2 19.32 2c.78 0 1.38.2 1.78.61c.4.39.62.93.62 1.57c-.01.56-.19 1.08-.54 1.55c-.34.48-.76.93-1.27 1.36l-.64.52v.02h2.58V9z"/></svg>',"subscript-glyph":'<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor" d="M16 7.41L11.41 12L16 16.59L14.59 18L10 13.41L5.41 18L4 16.59L8.59 12L4 7.41L5.41 6L10 10.59L14.59 6L16 7.41m5.85 13.62h-4.88v-1l.89-.8c.76-.65 1.32-1.19 1.7-1.63c.37-.44.56-.85.57-1.24a.898.898 0 0 0-.27-.7c-.18-.16-.47-.28-.86-.28c-.31 0-.58.06-.84.18l-.66.38l-.45-1.17c.27-.21.59-.39.98-.53s.82-.24 1.29-.24c.78.04 1.38.25 1.78.66c.4.41.62.93.62 1.57c-.01.56-.19 1.08-.54 1.55c-.34.47-.76.92-1.27 1.36l-.64.52v.02h2.58v1.35z"/></svg>',"bot-glyph":'<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor" d="M21.928 11.607c-.202-.488-.635-.605-.928-.633V8c0-1.103-.897-2-2-2h-6V4.61c.305-.274.5-.668.5-1.11a1.5 1.5 0 0 0-3 0c0 .442.195.836.5 1.11V6H5c-1.103 0-2 .897-2 2v2.997l-.082.006A1 1 0 0 0 1.99 12v2a1 1 0 0 0 1 1H3v5c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5a1 1 0 0 0 1-1v-1.938a1.006 1.006 0 0 0-.072-.455zM5 20V8h14l.001 3.996L19 12v2l.001.005l.001 5.995H5z" fill="currentColor"/><ellipse cx="8.5" cy="12" rx="1.5" ry="2" fill="currentColor"/><ellipse cx="15.5" cy="12" rx="1.5" ry="2" fill="currentColor"/><path d="M8 16h8v2H8z" fill="currentColor"/></svg>',"header-1":'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path fill="currentColor"  d="M835.626667 349.397333A42.666667 42.666667 0 0 1 853.333333 384v426.666667a42.666667 42.666667 0 0 1-85.333333 0v-367.488l-71.850667 23.978666a42.666667 42.666667 0 0 1-26.965333-80.981333l128-42.666667a42.666667 42.666667 0 0 1 38.4 5.888zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="1635"></path></svg>',"header-2":'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M768 426.666667a85.333333 85.333333 0 0 0-85.333333 85.333333v21.333333a42.666667 42.666667 0 1 1-85.333334 0V512a170.666667 170.666667 0 0 1 170.666667-170.666667h7.338667a163.328 163.328 0 0 1 115.498666 278.869334L742.997333 768H896a42.666667 42.666667 0 1 1 0 85.333333h-256a42.666667 42.666667 0 0 1-30.165333-72.832l220.672-220.672A77.994667 77.994667 0 0 0 775.338667 426.666667H768zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="1791"></path></svg>',"header-3":'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M597.333333 384a42.666667 42.666667 0 0 1 42.666667-42.666667h256a42.666667 42.666667 0 0 1 30.165333 72.832l-105.941333 105.984A170.752 170.752 0 0 1 768 853.333333a170.666667 170.666667 0 0 1-160.938667-113.877333 42.666667 42.666667 0 0 1 80.469334-28.373333A85.333333 85.333333 0 1 0 768 597.333333h-42.666667a42.666667 42.666667 0 0 1-30.165333-72.832L793.002667 426.666667H640a42.666667 42.666667 0 0 1-42.666667-42.666667zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="1949"></path></svg>',"header-4":'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M780.714667 343.296a42.666667 42.666667 0 0 1 28.032 53.418667L719.36 682.666667H896a42.666667 42.666667 0 1 1 0 85.333333h-234.666667a42.666667 42.666667 0 0 1-40.704-55.381333l106.666667-341.333334a42.666667 42.666667 0 0 1 53.418667-27.989333z" p-id="2107"></path><path d="M853.333333 554.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v213.333334a42.666667 42.666667 0 1 1-85.333333 0v-213.333334a42.666667 42.666667 0 0 1 42.666666-42.666666zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="2108"></path></svg>',"header-5":'\n  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M683.946667 373.674667A42.666667 42.666667 0 0 1 725.333333 341.333333h170.666667a42.666667 42.666667 0 1 1 0 85.333334h-137.301333l-22.016 88.234666A170.666667 170.666667 0 1 1 640 795.562667a42.666667 42.666667 0 1 1 64-56.448 85.333333 85.333333 0 1 0 0-112.896 42.666667 42.666667 0 0 1-73.386667-38.528l53.333334-214.016zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="2264"></path></svg>',"header-6":'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M831.274667 303.957333a42.666667 42.666667 0 0 1 16.725333 57.984l-83.498667 151.466667a170.453333 170.453333 0 0 1 88.746667 22.741333 169.557333 169.557333 0 0 1 62.506667 232.277334 171.093333 171.093333 0 0 1-232.96 62.165333 169.557333 169.557333 0 0 1-62.805334-231.850667l153.301334-278.016a42.666667 42.666667 0 0 1 57.984-16.768z m-20.48 306.176a85.76 85.76 0 0 0-116.736 31.018667 84.224 84.224 0 0 0 31.189333 115.456 85.76 85.76 0 0 0 116.736-31.018667 84.224 84.224 0 0 0-31.232-115.456zM128 170.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v256h256V213.333333a42.666667 42.666667 0 1 1 85.333333 0v597.333334a42.666667 42.666667 0 1 1-85.333333 0v-256H170.666667v256a42.666667 42.666667 0 1 1-85.333334 0V213.333333a42.666667 42.666667 0 0 1 42.666667-42.666666z" p-id="2422"></path></svg>',"header-n":'<svg  viewBox="0 0 24 24" ><path d="M2 3a1 1 0 0 0-1 1v16a1 1 0 1 0 2 0v-7h9v7a1 1 0 1 0 2 0V4a1 1 0 1 0-2 0v7H3V4a1 1 0 0 0-1-1Zm14 9a1 1 0 0 1 1.984-.177 4.099 4.099 0 0 1 1.757-.576 3.447 3.447 0 0 1 3.759 3.432V20a1 1 0 1 1-2 0v-5.32c0-.851-.73-1.519-1.578-1.442A2.114 2.114 0 0 0 18 15.344V20a1 1 0 1 1-2 0v-8Z" fill="currentColor"></path></svg>',obsidian:'<svg viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" class="logo-wireframe"><path d="M 30.91 17.52 L 34.43 35.7 M 61.44 14.41 L 62.61 0 M 34.43 35.7 L 37.57 90.47 M 81 26.39 L 61.44 14.41 L 34.43 35.7 L 65.35 100 M 62.61 0 L 30.91 17.52 L 18 45.45 L 37.57 90.47 L 65.35 100 L 70.44 89.8 L 81 26.39 L 62.61 0 Z"></path></svg>',"obsidian-new":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#A88BFA" d="m6.91927 14.5955c.64053-.1907 1.67255-.4839 2.85923-.5565-.71191-1.7968-.88376-3.3691-.74554-4.76905.15962-1.61678.72977-2.9662 1.28554-4.11442.1186-.24501.2326-.47313.3419-.69198.1549-.30984.3004-.60109.4365-.8953.2266-.48978.3948-.92231.4798-1.32416.0836-.39515.0841-.74806-.0148-1.08657-.099-.338982-.3093-.703864-.7093-1.1038132-.5222-.1353116-1.1017-.0165173-1.53613.3742922l-5.15591 4.638241c-.28758.25871-.47636.60929-.53406.99179l-.44455 2.94723c.69903.6179 2.42435 2.41414 3.47374 4.90644.09364.2224.1819.4505.26358.6838z"></path><path fill="#A88BFA" d="m2.97347 10.3512c-.02431.1037-.05852.205-.10221.3024l-2.724986 6.0735c-.279882.6238-.15095061 1.3552.325357 1.8457l4.288349 4.4163c2.1899-3.2306 1.87062-6.2699.87032-8.6457-.75846-1.8013-1.90801-3.2112-2.65683-3.9922z"></path><path fill="#A88BFA" d="m5.7507 23.5094c.07515.012.15135.0192.2281.0215.81383.0244 2.18251.0952 3.29249.2997.90551.1669 2.70051.6687 4.17761 1.1005 1.1271.3294 2.2886-.5707 2.4522-1.7336.1192-.8481.343-1.8075.7553-2.6869l-.0095.0033c-.6982-1.9471-1.5865-3.2044-2.5178-4.0073-.9284-.8004-1.928-1.1738-2.8932-1.3095-1.60474-.2257-3.07497.1961-4.00103.4682.55465 2.3107.38396 5.0295-1.48417 7.8441z"></path><path fill="#A88BFA" d="m17.3708 19.3102c.9267-1.3985 1.5868-2.4862 1.9352-3.0758.1742-.295.1427-.6648-.0638-.9383-.5377-.7126-1.5666-2.1607-2.1272-3.5015-.5764-1.3785-.6624-3.51876-.6673-4.56119-.0019-.39626-.1275-.78328-.3726-1.09465l-3.3311-4.23183c-.0117.19075-.0392.37998-.0788.56747-.1109.52394-.32 1.04552-.5585 1.56101-.1398.30214-.3014.62583-.4646.95284-.1086.21764-.218.4368-.3222.652-.5385 1.11265-1.0397 2.32011-1.1797 3.73901-.1299 1.31514.0478 2.84484.8484 4.67094.1333.0113.2675.0262.4023.0452 1.1488.1615 2.3546.6115 3.4647 1.5685.9541.8226 1.8163 2.0012 2.5152 3.6463z"></path></svg>'};class Je{constructor(t){this.plugin=t}init(){this.statusBarIcon=this.plugin.addStatusBarItem(),this.statusBarIcon.addClass("editingToolbar-statusbar-button"),t.setIcon(this.statusBarIcon,"editingToolbar"),this.registerClickEvent()}registerClickEvent(){this.plugin.registerDomEvent(this.statusBarIcon,"click",(()=>{const t=this.statusBarIcon.parentElement.getBoundingClientRect(),e=this.statusBarIcon.getBoundingClientRect();this.showMenu(e,t)}))}showMenu(e,i){const o=new t.Menu;o.addSections(["settings"]),this.addVisibilityToggle(o),o.addSections(["controls"]),this.addToolbarControls(o);o.dom.addClass("editingToolbar-statusbar-menu"),o.showAtPosition({x:e.right+5,y:i.top-5})}addVisibilityToggle(i){i.addItem((i=>{i.setTitle(g("Hide & Show")),!t.requireApiVersion("0.15.0")||i.setSection("settings");const o=i.dom,n=new t.ToggleComponent(o).setValue(this.plugin.settings.cMenuVisibility).setDisabled(!0),s=()=>e(this,void 0,void 0,(function*(){this.plugin.settings.cMenuVisibility=!this.plugin.settings.cMenuVisibility,n.setValue(this.plugin.settings.cMenuVisibility),1==this.plugin.settings.cMenuVisibility?setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100):c(this.plugin.settings.cMenuVisibility),S(),yield this.plugin.saveSettings()}));i.onClick((t=>{t.preventDefault(),t.stopImmediatePropagation(),s()}))})),i.addItem((i=>{i.setTitle(g("Toolbar Position")),!t.requireApiVersion("0.15.0")||i.setSection("settings"),i.setIcon("layout");const o=i.setSubmenu();["top","fixed","following"].forEach((t=>{o.addItem((i=>{i.setTitle(t),i.setIcon(this.plugin.settings.positionStyle===t?"check":""),i.onClick((()=>e(this,void 0,void 0,(function*(){this.plugin.settings.positionStyle=t,yield this.plugin.saveSettings(),S(),setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100)}))))}))}))}))}addToolbarControls(e){const i=[{icon:"plus",title:g("Add Command"),click:()=>new b(this.plugin).open()}];"fixed"===this.plugin.settings.positionStyle&&i.push({icon:"sliders",title:g("Settings"),click:()=>new y(this.plugin.app,this.plugin).open()}),i.forEach((i=>{e.addItem((e=>{e.setIcon(i.icon),e.setTitle(i.title),e.onClick(i.click),t.requireApiVersion("0.15.0")&&e.setSection("controls")}))}))}}let ti,ei;class ii extends t.Modal{constructor(t){super(t.app),this.plugin=t,this.type="note",this.title="",this.content="",this.collapse="none",this.calloutTypes=[{type:"note",aliases:["cite"],icon:"lucide-pencil",label:"Note",color:"var(--callout-default)"},{type:"abstract",aliases:["summary","tldr"],icon:"lucide-clipboard-list",label:"Abstract",color:"var(--callout-summary)"},{type:"info",aliases:[],icon:"lucide-info",label:"Info",color:"var(--callout-info)"},{type:"todo",aliases:[],icon:"lucide-check-circle-2",label:"Todo",color:"var(--callout-todo)"},{type:"important",aliases:[],icon:"lucide-flame",label:"Important",color:"var(--callout-important)"},{type:"tip",aliases:["hint"],icon:"lucide-flame",label:"Tip",color:"var(--callout-tip)"},{type:"success",aliases:["check","done"],icon:"lucide-check",label:"Success",color:"var(--callout-success)"},{type:"question",aliases:["help","faq"],icon:"help-circle",label:"Question",color:"var(--callout-question)"},{type:"warning",aliases:["caution","attention"],icon:"lucide-alert-triangle",label:"Warning",color:"var(--callout-warning)"},{type:"failure",aliases:["fail","missing"],icon:"lucide-x",label:"Failure",color:"var(--callout-fail)"},{type:"danger",aliases:["error"],icon:"lucide-zap",label:"Danger",color:"var(--callout-error)"},{type:"bug",aliases:[],icon:"lucide-bug",label:"Bug",color:"var(--callout-bug)"},{type:"example",aliases:[],icon:"lucide-list",label:"Example",color:"var(--callout-example)"},{type:"quote",aliases:["cite"],icon:"quote-glyph",label:"Quote",color:"var(--callout-quote)"}],this.containerEl.addClass("insert-callout-modal");const e=this.plugin.commandsManager.getActiveEditor();if(e){const t=e.getSelection();t&&(this.content=t)}}onOpen(){this.display()}display(){return e(this,void 0,void 0,(function*(){const{contentEl:e}=this;e.empty(),e.addEventListener("keydown",(t=>{"Enter"===t.key&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.insertButton&&this.insertButton.click())}));const i=e.createDiv("callout-type-container");new t.Setting(i).setName(g("Callout Type")).addDropdown((t=>{this.calloutTypes.forEach((({type:e,aliases:i,label:o})=>{t.addOption(e,o),i.forEach((e=>{t.addOption(e,`${o} (${e})`)}))})),t.setValue(this.type),t.onChange((t=>{this.type=t,this.updateIconAndColor(o,t)}))}));const o=i.createDiv("callout-icon-container");this.updateIconAndColor(o,this.type),new t.Setting(e).setName(g("Title")).setDesc(g("Optional, leave blank for default title")).addText((t=>{t.setPlaceholder(g("Input title")).setValue(this.title).onChange((t=>{this.title=t}))})),new t.Setting(e).setName(g("Collapse State")).addDropdown((t=>{t.addOption("none",g("Default")).addOption("open",g("Open")).addOption("closed",g("Closed")).setValue(this.collapse).onChange((t=>{this.collapse=t}))})),new t.Setting(e).setName(g("Content")).addTextArea((t=>{t.setPlaceholder(g("Input content")).setValue(this.content).onChange((t=>{this.content=t})),t.inputEl.rows=5,t.inputEl.cols=40,this.contentTextArea=t.inputEl}));const n=e.createDiv("shortcut-hint");n.setText(`${t.Platform.isMacOS?"âŒ˜":"Ctrl"} + Enter ${g("to insert")}`),n.style.textAlign="right",n.style.fontSize="0.8em",n.style.opacity="0.7",n.style.marginTop="5px",new t.Setting(e).addButton((t=>(t.setButtonText(g("Insert")).setCta().onClick((()=>{this.insertCallout(),this.close()})),this.insertButton=t.buttonEl,t))).addButton((t=>(t.setButtonText(g("Cancel")).setTooltip(g("Cancel")).onClick((()=>this.close())),t))),setTimeout((()=>{this.contentTextArea&&this.contentTextArea.focus()}),10)}))}updateIconAndColor(e,i){const o=this.calloutTypes.find((t=>t.type===i||t.aliases.includes(i)));o&&(e.empty(),t.setIcon(e,o.icon),e.style.setProperty("--callout-color",o.color))}insertCallout(){const t=this.plugin.commandsManager.getActiveEditor();if(!t)return;let e=`> [!${this.type}]`;"none"!==this.collapse&&(e+=""+("open"===this.collapse?"+":"-")),this.title&&(e+=` ${this.title}`),e+=`\n> ${this.content.replace(/\n/g,"\n> ")}`;const i=t.getCursor(),o=t.getLine(i.line),n=0===i.ch;let s;if(t.getSelection()){!n&&o.trim().length>0&&(e="\n"+e);const i=t.getCursor("from");t.replaceSelection(e);const a=e.split("\n").length;s={line:i.line+a,ch:0}}else{!n&&o.trim().length>0&&(e="\n"+e),t.replaceRange(e,i);const a=e.split("\n").length;s={line:i.line+a,ch:0}}setTimeout((()=>{t.replaceRange("\n",s),t.setCursor({line:s.line+1,ch:0}),t.focus()}),0)}}class oi extends t.Modal{constructor(t){super(t.app),this.plugin=t,this.linkText="",this.linkUrl="",this.linkAlias="",this.isEmbed=!1,this.insertNewLine=!1,this.imageWidth="",this.imageHeight="",this.prefixText="",this.suffixText="",this.selectedText="";const e=this.plugin.commandsManager.getActiveEditor();if(e){const t=e.getSelection()||"";t?(this.selectedText=t,this.parseSelectedText(t)):this.parseClipboard()}else this.parseClipboard();this.updateHeader()}parseSelectedText(t){const e=t.match(/!\[.*?\]\(.*?\)/);if(e){const i=t.substring(0,e.index),o=t.substring(e.index+e[0].length),n=this.parseMarkdownImageLink(t);if(n)return this.linkText=n.title,this.linkUrl=n.url,this.imageWidth=n.width||"",this.imageHeight=n.height||"",this.isEmbed=!0,this.prefixText=i,void(this.suffixText=o)}const i=t.match(/\[.*?\]\(.*?\)/);if(i){const e=i[0],o=t.substring(0,i.index),n=t.substring(i.index+e.length),s=this.parseMarkdownLink(e);s&&(this.linkText=s.title,this.linkUrl=s.url,this.linkAlias=s.alias||"",this.isEmbed=!1),this.prefixText=o,this.suffixText=n}else{const e=this.parseMixedContent(t);e&&(this.linkText=e.title,this.linkUrl=e.url)}}parseMixedContent(t){let e;return(e=t.match(/^\[(.*?)\]\((.*?)\)$/))?{title:e[1].trim(),url:e[2].trim()}:(e=t.match(/<a[^>]+href=["']([^"']+)["'][^>]*>([^<]+)<\/a>/i))?{title:e[2].trim(),url:e[1].trim()}:(e=t.match(/^(.*?)\s*((?:https?:\/\/|www\.)\S+)$/i))&&e[1].trim()?{title:e[1].trim(),url:e[2].trim()}:this.isValidUrl(t.trim())?{title:this.extractTitleFromUrl(t.trim()),url:t.trim()}:{title:t.trim(),url:""}}extractTitleFromUrl(t){const e=t.match(/^([a-zA-Z]+):\/\/(.+)$/);if(e){const[,t,i]=e,o=i.split(/[/\\]/),n=o[o.length-1];return n?decodeURIComponent(n).trim():t.toUpperCase()}const i=t.match(/^\[\[(.*?)\]\]$/);if(i)return i[1];const o=t.match(/[^/\\]+$/);return o?o[0].replace(/\.[^/.]+$/,"").replace(/[-_]/g," ").trim():t}isValidUrl(t){if(!t||t.includes("\n")||/\s/.test(t))return!1;if(["obsidian://","zotero://","evernote://","notion://","bear://","things://","drafts://","x-devonthink-item://","file://","ftp://","ftps://","http://","https://","tel:","mailto:"].some((e=>t.startsWith(e))))return!0;if(t.match(/^\[\[.*?\]\]$/))return!0;if(t.match(/^[./\\]/)||t.match(/^[a-zA-Z]:\\/)||t.match(/^\/[^/]/)||t.match(/^[a-zA-Z]+:\/\//))return!0;try{return new URL(t),!0}catch(t){return!1}}parseMarkdownImageLink(t){const e=t.match(/!\[(.*?)(?:\|(\d+)(?:x(\d+))?)?\]\(([^)]+)\)(?:!.*)?$/);if(e){const[,t,i,o,n]=e;if(this.isEmbed=!0,this.embedToggle){this.embedToggle.setValue(!0);const t=this.contentEl.querySelector(".image-size-setting");t&&(t.style.display="block")}return{title:t.trim(),url:n.trim(),width:i,height:o}}return null}parseMarkdownLink(t){const e=t.match(/\[(.*?)(?:\|(.*?))?\]\(([^)]+)\)/);if(e){const[,t,i,o]=e;return{title:t.trim(),url:o.trim(),alias:null==i?void 0:i.trim()}}return null}parseClipboard(){return e(this,void 0,void 0,(function*(){try{const t=yield this.readClipboard(),e=t["text/plain"];if(e){const t=this.parseMarkdownImageLink(e);if(t)return this.linkText=t.title,this.linkUrl=t.url,(t.width||t.height)&&(this.isEmbed=!0,this.imageWidth=t.width||"",this.imageHeight=t.height||""),void this.updateUI();const i=this.parseMarkdownLink(e);if(i)return this.linkText=i.title,this.linkUrl=i.url,this.linkAlias=i.alias||"",this.isEmbed=!1,void this.updateUI()}if(t["text/html"]){const e=this.parseHtmlContent(t["text/html"]);e&&(this.linkText=this.linkText||e.title,this.linkUrl=e.url)}else if(t["text/markdown"]){const e=this.parseMarkdownContent(t["text/markdown"]);e&&(this.linkText=this.linkText||e.title,this.linkUrl=e.url)}else if(t["text/plain"]){const e=this.parseMixedContent(t["text/plain"]);e&&(this.linkText=this.linkText||e.title,this.linkUrl=e.url)}this.updateUI()}catch(t){console.error("Failed to read clipboard:",t)}}))}readClipboard(){return e(this,void 0,void 0,(function*(){const t={};try{const e=yield navigator.clipboard.read();for(const i of e){const e=i.types;for(const o of e)if("text/html"===o||"text/plain"===o||"text/markdown"===o){const e=yield i.getType(o);t[o]=yield e.text()}}}catch(e){try{const e=yield navigator.clipboard.readText();t["text/plain"]=e}catch(t){console.error("Failed to read clipboard:",t)}}return t}))}parseHtmlContent(t){var e;const i=(new DOMParser).parseFromString(t,"text/html"),o=i.querySelector("a");if(o)return{title:(null===(e=o.textContent)||void 0===e?void 0:e.trim())||"",url:o.href};const n=i.body.textContent||"";return this.parseMixedContent(n)}parseMarkdownContent(t){const e=t.match(/\[([^\]]+)\]\(([^)]+)\)/);return e?{title:e[1].trim(),url:e[2].trim()}:this.parseMixedContent(t)}onOpen(){this.display()}updateHeader(){const t=this.getPreviewText();this.previewSetting&&(this.previewSetting.controlEl.querySelector("input").value=t)}getPreviewText(){const t=this.linkText||"",e=this.linkUrl;let i=this.isEmbed?"!":"";return i+=`[${t}`,this.isEmbed&&(this.imageWidth||this.imageHeight)?(i+="|",this.imageWidth&&this.imageHeight?i+=`${this.imageWidth}x${this.imageHeight}`:this.imageWidth?i+=this.imageWidth:this.imageHeight&&(i+=`x${this.imageHeight}`)):!this.isEmbed&&this.linkAlias&&(i+=`|${this.linkAlias}`),i+=`](${e})`,i}display(){return e(this,void 0,void 0,(function*(){const{contentEl:i}=this;i.empty(),i.addClass("insert-link-modal"),this.titleEl.textContent="",this.titleEl.addClass("insert-link-modal-title"),i.addEventListener("keydown",(t=>{"Enter"===t.key&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.insertButton&&this.insertButton.click())}));const o=new t.Setting(i).setName(g("Link Text")).addText((t=>{this.linkTextInput=t,t.setPlaceholder(g("Link Text")).setValue(this.linkText).onChange((t=>{this.linkText=t,this.updateHeader()}))})),n=new t.Setting(o.controlEl).setName(g("Alias")).addText((t=>{this.linkAliasInput=t,t.setPlaceholder(g("Link Alias(optional)")).setValue(this.linkAlias).onChange((t=>{this.linkAlias=t,this.updateHeader()}))})),s=new t.Setting(i).setName(g("Link URL")).setClass("link-url-setting").addText((t=>{this.linkUrlInput=t,t.setPlaceholder(g("Link URL")).setValue(this.linkUrl).onChange((t=>{this.linkUrl=t.trim(),this.validateUrl(this.linkUrl),this.updateHeader()}))})).addButton((t=>{t.setIcon("lucide-clipboard").setTooltip(g("Paste and Parse")).onClick((()=>e(this,void 0,void 0,(function*(){yield this.parseClipboard(),this.updateHeader()}))))}));this.urlErrorMsg=s.descEl.createDiv("url-error"),this.urlErrorMsg.style.color="var(--text-error)",this.urlErrorMsg.style.display="none";const a=new t.Setting(i).setName(g("Embed Content")).setDesc(g("If it is an image, turn on"));this.embedToggle=new t.ToggleComponent(a.controlEl),this.embedToggle.setValue(this.isEmbed).onChange((t=>{this.isEmbed=t;const e=i.querySelector(".image-size-setting"),o=n.settingEl;e&&(e.style.display=t?"flex":"none"),o&&(o.style.display=t?"none":"flex"),this.updateHeader()}));new t.Setting(i).setClass("image-size-setting").setName(g("Image Size")).addText((t=>{t.inputEl.addClass("image-width-input"),t.setPlaceholder(g("Image Width")).setValue(this.imageWidth).onChange((e=>{this.imageWidth=e.replace(/[^\d]/g,""),t.setValue(this.imageWidth),this.updateHeader()}))})).addText((t=>{t.inputEl.addClass("image-height-input"),t.setPlaceholder(g("Image Height")).setValue(this.imageHeight).onChange((e=>{this.imageHeight=e.replace(/[^\d]/g,""),t.setValue(this.imageHeight),this.updateHeader()}))})).settingEl.style.display=this.isEmbed?"block":"none",new t.Setting(i).setName(g("Insert New Line")).setDesc(g("Insert a link on the next line")).addToggle((t=>{t.setValue(this.insertNewLine).onChange((t=>{this.insertNewLine=t,this.updateHeader()}))})),this.previewSetting=new t.Setting(i).setClass("preview-setting").addText((t=>{t.setValue(this.getPreviewText()).inputEl.setAttribute("readonly","true")}));const r=i.createDiv("shortcut-hint");r.setText(`${t.Platform.isMacOS?"âŒ˜":"Ctrl"} + Enter ${g("to insert")}`),r.style.textAlign="right",r.style.fontSize="0.8em",r.style.opacity="0.7",r.style.marginTop="5px",new t.Setting(i).addButton((t=>{t.setButtonText(g("Insert")).setCta().onClick((()=>{this.insertLink(),this.close()})),this.insertButton=t.buttonEl})).addButton((t=>t.setButtonText(g("Cancel")).setCta().onClick((()=>{this.close()})))),setTimeout((()=>{this.linkText||this.linkUrl?!this.linkText&&this.linkUrl?this.linkTextInput.inputEl.focus():this.linkText&&!this.linkUrl?this.linkUrlInput.inputEl.focus():this.linkAliasInput.inputEl.focus():this.linkTextInput.inputEl.focus()}),10)}))}validateUrl(t){return t?this.isValidUrl(t)?(this.urlErrorMsg.style.display="none",!0):(this.urlErrorMsg.textContent=g("URL Format Error"),this.urlErrorMsg.style.display="block",!1):(this.urlErrorMsg.style.display="none",!0)}insertLink(){if(!this.validateUrl(this.linkUrl))return;const t=this.plugin.commandsManager.getActiveEditor();if(!t)return;let e=this.linkText||this.linkUrl;const i=this.linkUrl;let o,n=this.isEmbed?"!":"";n+=`[${e}`,this.isEmbed&&(this.imageWidth||this.imageHeight)?(n+="|",this.imageWidth&&this.imageHeight?n+=`${this.imageWidth}x${this.imageHeight}`:this.imageWidth?n+=this.imageWidth:this.imageHeight&&(n+=`x${this.imageHeight}`)):!this.isEmbed&&this.linkAlias&&(n+=`|${this.linkAlias}`),n+=`](${i})`;if(t.getSelection()){const e=t.getCursor("from"),i=t.getCursor("to");if(this.insertNewLine)t.replaceRange("\n"+n,{line:i.line,ch:t.getLine(i.line).length}),o={line:i.line+1,ch:n.length};else{const s=this.prefixText+n+this.suffixText;t.replaceRange(s,{line:e.line,ch:0},i),o={line:e.line,ch:this.prefixText.length+n.length}}}else{const e=t.getCursor(),i=t.getLine(e.line);if(this.insertNewLine){const s=e.line+1;t.replaceRange("\n",{line:e.line,ch:i.length}),t.setCursor({line:s,ch:0}),t.replaceRange(n,{line:s,ch:0}),o={line:s,ch:n.length}}else t.replaceRange(n,e),o={line:e.line,ch:e.ch+n.length}}setTimeout((()=>{o&&t.setCursor(o),t.focus()}),0)}updateUI(){this.linkTextInput&&this.linkTextInput.setValue(this.linkText),this.linkUrlInput&&(this.linkUrlInput.setValue(this.linkUrl),this.validateUrl(this.linkUrl));const t=this.contentEl.querySelector(".image-width-input"),e=this.contentEl.querySelector(".image-height-input");t&&(t.value=this.imageWidth),e&&(e.value=this.imageHeight),this.linkAliasInput&&this.linkAliasInput.setValue(this.linkAlias);const i=this.contentEl.querySelector(".setting-item:nth-child(2)");i&&(i.style.display=this.isEmbed?"none":"flex"),this.updateHeader()}}class ni{constructor(t){this.executeCommandWithoutBlur=(t,i)=>e(this,void 0,void 0,(function*(){t&&(t.getSelection(),t.getCursor(),yield i(),t.focus())})),this._commandsMap={hrline:{char:5,line:1,prefix:"\n---",suffix:"\n",islinehead:!0},justify:{char:0,line:0,prefix:'<p align="justify">',suffix:"</p>",islinehead:!1},left:{char:0,line:0,prefix:'<p align="left">',suffix:"</p>",islinehead:!1},right:{char:0,line:0,prefix:'<p align="right">',suffix:"</p>",islinehead:!1},center:{char:0,line:0,prefix:"<center>",suffix:"</center>",islinehead:!1},underline:{char:0,line:0,prefix:"<u>",suffix:"</u>",islinehead:!1},superscript:{char:0,line:0,prefix:"<sup>",suffix:"</sup>",islinehead:!1},subscript:{char:0,line:0,prefix:"<sub>",suffix:"</sub>",islinehead:!1},codeblock:{char:4,line:0,prefix:"\n```\n",suffix:"\n```\n",islinehead:!1}},this.modCommands=[{id:"editor:insert-embed",name:"Add embed",icon:"note-glyph"},{id:"editor:insert-link",name:"Insert markdown link",icon:"link-glyph"},{id:"editor:insert-tag",name:"Add tag",icon:"price-tag-glyph"},{id:"editor:insert-wikilink",name:"Add internal link",icon:"bracket-glyph"},{id:"editor:toggle-code",name:"Code",icon:"code-glyph"},{id:"editor:toggle-blockquote",name:"Blockquote",icon:"lucide-text-quote"},{id:"editor:toggle-checklist-status",name:"Checklist status",icon:"checkbox-glyph"},{id:"editor:toggle-comments",name:"Comment",icon:"percent-sign-glyph"},{id:"editor:insert-callout",name:"Insert Callout",icon:"lucide-quote"},{id:"editor:insert-mathblock",name:"MathBlock",icon:"lucide-sigma-square"},{id:"editor:insert-table",name:"Insert Table",icon:"lucide-table"},{id:"editor:swap-line-up",name:"Swap line up",icon:"lucide-corner-right-up"},{id:"editor:swap-line-down",name:"Swap line down",icon:"lucide-corner-right-down"},{id:"editor:attach-file",name:"Attach file",icon:"lucide-paperclip"},{id:"editor:clear-formatting",name:"Clear formatting",icon:"lucide-eraser"}],this.applyCommand=(t,e)=>{const i=e.getSelection(),o=e.getCursor("from"),n=e.getCursor("to");let s=t.prefix;t.islinehead&&o.ch>0&&(s="\n"+s);const a=t.suffix,r={line:o.line-t.line,ch:o.ch-s.length};if(e.getRange(r,o)==s){const l={line:o.line+t.line,ch:n.ch+a.length};if(e.getRange(n,l)==a){e.replaceRange(i,r,l),e.setCursor(o.line-t.line,o.ch);const n={line:o.line,ch:o.ch-s.length},a={line:o.line,ch:n.ch+i.length};return void e.setSelection(n,a)}}if(e.replaceSelection(`${s}${i}${a}`),t.char>0)e.setCursor(o.line+t.line,o.ch+t.char+i.length);else{const t=o,n={line:t.line,ch:t.ch+s.length},a={line:t.line,ch:n.ch+i.length};e.setSelection(n,a)}},this.plugin=t}getActiveEditor(){var e,i,o;const n=this.plugin.app.workspace.getActiveViewOfType(t.MarkdownView);if(n)return n.editor;const s=null===(e=this.plugin.app.workspace)||void 0===e?void 0:e.activeEditor;if(s&&s.editor)return s.editor;const a=null===(o=null===(i=this.plugin.app.workspace.activeLeaf)||void 0===i?void 0:i.view)||void 0===o?void 0:o.editor;return a||null}registerCommands(){this.plugin.addCommand({id:"hide-show-menu",name:"Hide/show ",icon:"editingToolbar",callback:()=>e(this,void 0,void 0,(function*(){this.plugin.settings.cMenuVisibility=!this.plugin.settings.cMenuVisibility,this.plugin.settings.cMenuVisibility?setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100):c(this.plugin.settings.cMenuVisibility),S(),yield this.plugin.saveSettings()}))}),this.plugin.addCommand({id:"format-eraser",name:"Format Eraser",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>N(this.plugin,t)))},icon:"eraser"}),this.plugin.addCommand({id:"change-font-color",name:"Change font color[html]",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>{var e;return a(null!==(e=this.plugin.settings.cMenuFontColor)&&void 0!==e?e:"#2DC26B",t)}))},icon:'<svg width="24" height="24" focusable="false" fill="currentColor"><g fill-rule="evenodd"><path id="change-font-color-icon" d="M3 18h18v3H3z" style="fill:#2DC26B"></path><path d="M8.7 16h-.8a.5.5 0 01-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 01-.5.6h-.8a.5.5 0 01-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 00.5.6h1.6a.5.5 0 00.5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z"></path></g></svg>'}),this.plugin.addCommand({id:"change-background-color",name:"Change Backgroundcolor[html]",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>{var e;return r(null!==(e=this.plugin.settings.cMenuBackgroundColor)&&void 0!==e?e:"#FA541C",t)}))},icon:'<svg width="18" height="24" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg"><g   stroke="none" stroke-width="1" fill="currentColor" fill-rule="evenodd"><g  ><g fill="currentColor"><g transform="translate(119.502295, 137.878331) rotate(-135.000000) translate(-119.502295, -137.878331) translate(48.002295, 31.757731)" ><path d="M100.946943,60.8084699 L43.7469427,60.8084699 C37.2852111,60.8084699 32.0469427,66.0467383 32.0469427,72.5084699 L32.0469427,118.70847 C32.0469427,125.170201 37.2852111,130.40847 43.7469427,130.40847 L100.946943,130.40847 C107.408674,130.40847 112.646943,125.170201 112.646943,118.70847 L112.646943,72.5084699 C112.646943,66.0467383 107.408674,60.8084699 100.946943,60.8084699 Z M93.646,79.808 L93.646,111.408 L51.046,111.408 L51.046,79.808 L93.646,79.808 Z" fill-rule="nonzero"></path><path d="M87.9366521,16.90916 L87.9194966,68.2000001 C87.9183543,69.4147389 86.9334998,70.399264 85.7187607,70.4 L56.9423078,70.4 C55.7272813,70.4 54.7423078,69.4150264 54.7423078,68.2 L54.7423078,39.4621057 C54.7423078,37.2523513 55.5736632,35.1234748 57.0711706,33.4985176 L76.4832996,12.4342613 C78.9534987,9.75382857 83.1289108,9.5834005 85.8093436,12.0535996 C87.1658473,13.303709 87.9372691,15.0644715 87.9366521,16.90916 Z" fill-rule="evenodd"></path><path d="M131.3,111.241199 L11.7,111.241199 C5.23826843,111.241199 0,116.479467 0,122.941199 L0,200.541199 C0,207.002931 5.23826843,212.241199 11.7,212.241199 L131.3,212.241199 C137.761732,212.241199 143,207.002931 143,200.541199 L143,122.941199 C143,116.479467 137.761732,111.241199 131.3,111.241199 Z M124,130.241 L124,193.241 L19,193.241 L19,130.241 L124,130.241 Z" fill-rule="nonzero"></path></g></g><path d="M51,218 L205,218 C211.075132,218 216,222.924868 216,229 C216,235.075132 211.075132,240 205,240 L51,240 C44.9248678,240 40,235.075132 40,229 C40,222.924868 44.9248678,218 51,218 Z" id="change-background-color-icon" style="fill:#FA541C"></path></g></g></svg>'}),this.plugin.addCommand({id:"indent-list",name:"Indent list",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.indentList()))},icon:"indent-glyph"}),this.plugin.addCommand({id:"undent-list",name:"Unindent list",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.unindentList()))},icon:"unindent-glyph"}),this.plugin.addCommand({id:"toggle-numbered-list",name:"Numbered list",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleNumberList()))},icon:"number-list-glyph"}),this.plugin.addCommand({id:"toggle-bullet-list",name:"bullet list",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleBulletList()))},icon:"bullet-list-glyph"}),this.plugin.addCommand({id:"toggle-highlight",name:"highlight",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleMarkdownFormatting("highlight")))},icon:"highlight-glyph"}),this.plugin.addCommand({id:"toggle-bold",name:"Bold",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>{t.toggleMarkdownFormatting("bold")}))},icon:"bold-glyph"}),this.plugin.addCommand({id:"toggle-italics",name:"Italics",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleMarkdownFormatting("italic")))},icon:"italic-glyph"}),this.plugin.addCommand({id:"toggle-strikethrough",name:"Strikethrough",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleMarkdownFormatting("strikethrough")))},icon:"strikethrough-glyph"}),this.plugin.addCommand({id:"toggle-inline-math",name:"Inline math",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleMarkdownFormatting("math")))},icon:"lucide-sigma"}),this.plugin.addCommand({id:"editor:cycle-list-checklist",name:"Cycle list checklist",icon:"lucide-check-square",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.toggleCheckList(!0)))}}),this.plugin.addCommand({id:"editor-undo",name:"Undo editor",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.undo()))},icon:"undo-glyph"}),this.plugin.addCommand({id:"editor-redo",name:"Redo editor",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>null==t?void 0:t.redo()))},icon:"redo-glyph"}),this.plugin.addCommand({id:"editor-copy",name:"Copy editor",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>e(this,void 0,void 0,(function*(){try{yield window.navigator.clipboard.writeText(t.getSelection()),this.plugin.app.commands.executeCommandById("editor:focus")}catch(t){console.error("Copy failed:",t)}}))))},icon:"lucide-copy"}),this.plugin.addCommand({id:"editor-paste",name:"Paste editor",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>e(this,void 0,void 0,(function*(){try{const e=yield window.navigator.clipboard.readText();e&&t.replaceSelection(e),this.plugin.app.commands.executeCommandById("editor:focus")}catch(t){console.error("Paste failed:",t)}}))))},icon:"lucide-clipboard-type"}),this.plugin.addCommand({id:"editor-cut",name:"Cut editor",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>e(this,void 0,void 0,(function*(){try{yield window.navigator.clipboard.writeText(t.getSelection()),t.replaceSelection(""),this.plugin.app.commands.executeCommandById("editor:focus")}catch(t){console.error("Cut failed:",t)}}))))},icon:"lucide-scissors"}),this.plugin.addCommand({id:"insert-callout",name:"Insert Callout(Modal)",icon:"lucide-quote",callback:()=>{new ii(this.plugin).open()}}),this.plugin.addCommand({id:"insert-link",name:"Insert Link(Modal)",icon:"lucide-link",callback:()=>{new oi(this.plugin).open()}}),this.plugin.addCommand({id:"fullscreen-focus",name:"Fullscreen focus mode",hotkeys:[{modifiers:["Mod","Shift"],key:"F11"}],callback:()=>function(e){var i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.toggleFull=exports.isFull=exports.exitFull=exports.beFull=void 0;let o=document.documentElement,n=o.querySelector("head"),s=document.createElement("style"),a="requestFullscreen",r="exitFullscreen",l="fullscreenElement";"webkitRequestFullScreen"in o?(a="webkitRequestFullScreen",r="webkitExitFullscreen",l="webkitFullscreenElement"):"msRequestFullscreen"in o?(a="msRequestFullscreen",r="msExitFullscreen",l="msFullscreenElement"):"mozRequestFullScreen"in o?(a="mozRequestFullScreen",r="mozCancelFullScreen",l="mozFullScreenElement"):"requestFullscreen"in o||console.log("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒFullscreen API !");const c=e.workspace.getActiveViewOfType(t.MarkdownView);if(!c)return;let d,h=c.containerEl,u=null===(i=document.body)||void 0===i?void 0:i.querySelector(".mod-vertical.mod-root .workspace-tab-container");function p(t){return t[a]()}function g(){return o.contains(s)&&(null==n||n.removeChild(s)),document[r]()}function m(t){return t===document[l]}d=new MutationObserver((function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){if(m(u))try{document.body.removeChild(t),h.appendChild(t)}catch(t){console.log(t.message)}}))}))})),u.addEventListener("fullscreenchange",(function(){m(u)||d.disconnect()})),m(u)?(d.disconnect(),g()):(p(u),d.observe(document.body,{childList:!0})),exports.beFull=p,exports.exitFull=g,exports.isFull=m,exports.toggleFull=function(t){return m(t)?(g(),!1):(p(t),!0)}}(app),icon:"fullscreen"}),this.plugin.addCommand({id:"workplace-fullscreen-focus",name:"Workplace Fullscreen Focus",callback:()=>function(e){ti=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;let i=ti;e.workspace.leftSplit.collapsed&&e.workspace.rightSplit.collapsed?(e.commands.executeCommandById("app:toggle-right-sidebar"),e.commands.executeCommandById("app:toggle-left-sidebar"),e.workspace.leftRibbon.show(),i.body.classList.contains("auto-hide-header")&&i.body.classList.remove("auto-hide-header")):(i.body.classList.contains("auto-hide-header")||i.body.classList.add("auto-hide-header"),e.workspace.leftRibbon.hide(),e.workspace.leftSplit.collapsed||e.commands.executeCommandById("app:toggle-left-sidebar"),e.workspace.rightSplit.collapsed||e.commands.executeCommandById("app:toggle-right-sidebar"))}(app),hotkeys:[{modifiers:["Mod"],key:"F11"}],icon:"remix-SplitCellsHorizontal"});for(let t=0;t<=6;t++)this.plugin.addCommand({id:`header${t}-text`,name:0===t?"Remove header level":`Header ${t}`,callback:()=>{const e=this.getActiveEditor();e&&this.executeCommandWithoutBlur(e,(()=>s("#".repeat(t),e)))},icon:0===t?"heading-glyph":`header-${t}`});Object.keys(this._commandsMap).forEach((t=>{this.plugin.addCommand({id:`${t}`,name:`Toggle ${t}`,icon:`${t}-glyph`,callback:()=>{const e=this.getActiveEditor();e&&this.executeCommandWithoutBlur(e,(()=>{this.applyCommand(this._commandsMap[t],e)}))}})})),this.modCommands.forEach((t=>{this.plugin.addCommand({id:`${t.id}`,name:`${t.name}`,icon:`${t.icon}`,callback:()=>{const i=this.getActiveEditor();i&&this.executeCommandWithoutBlur(i,(()=>e(this,void 0,void 0,(function*(){const e=i.getCursor("to");let o=this.getCharacterOffset(t.id);yield this.plugin.app.commands.executeCommandById(`${t.id}`),0!=o&&i.setCursor(e.line,e.ch+o)}))))}})})),this.plugin.addCommand({id:"toggle-format-brush",name:"Toggle Format Brush",icon:"paintbrush",editorCallback:t=>{this.plugin.toggleFormatBrush()}}),this.registerCustomCommands();["toggle-bold","toggle-italics","toggle-strikethrough","toggle-highlight","toggle-code","toggle-blockquote","header0-text","header1-text","header2-text","header3-text","header4-text","header5-text","header6-text","format-eraser","change-font-color","change-background-color",...this.plugin.settings.customCommands.map((t=>`custom-${t.id}`)),...Object.keys(this._commandsMap)].forEach((t=>{const e=this.plugin.app.commands.commands[`editing-toolbar:${t}`];if(e&&e.callback){const i=e.callback;e.callback=()=>{i(),this.plugin.setLastExecutedCommand(`editing-toolbar:${t}`)}}}))}getCharacterOffset(t){switch(t){case"editor:insert-tag":return 1;case"editor:insert-callout":return 11;default:return 0}}reloadCustomCommands(){this.plugin.settings.customCommands.forEach((t=>{const e=`custom-${t.id}`;this.plugin.app.commands.commands[`editing-toolbar:${e}`]&&delete this.plugin.app.commands.commands[`editing-toolbar:${e}`]})),this.registerCustomCommands()}registerCustomCommands(){this.plugin.settings.customCommands.forEach((t=>{const e=`custom-${t.id}`,i={char:t.char,line:t.line,prefix:t.prefix,suffix:t.suffix,islinehead:t.islinehead};this._commandsMap[t.id]=i,this.plugin.addCommand({id:e,name:t.name,icon:t.icon||"text-glyph",callback:()=>{const t=this.getActiveEditor();t&&this.executeCommandWithoutBlur(t,(()=>{this.applyCommand(i,t),this.plugin.setLastExecutedCommand(`editing-toolbar:${e}`)}))}})}))}get commandsMap(){return this._commandsMap}}class si extends t.Plugin{constructor(){super(...arguments),this.lastExecutedCommand=null,this.formatBrushActive=!1,this.formatBrushNotice=null,this.lastExecutedCommandName=null,this.handleeditingToolbar=()=>{if(1==this.settings.cMenuVisibility){const e=this.app.workspace.getActiveViewOfType(t.ItemView);let i=q(this.app,this.settings);if(i){if(!T.isAllowedViewType(e))return void(i.style.visibility="hidden");"following"!=this.settings.positionStyle?i.style.visibility="visible":i.style.visibility="hidden"}else setTimeout((()=>{F(this.app,this)}),100)}},this.handleeditingToolbar_layout=()=>{if(!this.settings.cMenuVisibility)return!1;const e=this.app.workspace.getActiveViewOfType(t.ItemView);let i=q(this.app,this.settings);T.isSourceMode(e)&&T.isAllowedViewType(e)?i?i.style.visibility="following"==this.settings.positionStyle?"hidden":"visible":setTimeout((()=>{F(this.app,this)}),100):i&&(i.style.visibility="hidden")},this.handleeditingToolbar_resize=()=>{var e;if(1!=this.settings.cMenuVisibility||"top"!=this.settings.positionStyle)return!1;{const i=app.workspace.getActiveViewOfType(t.ItemView);if(T.isSourceMode(i)){let i=null!==(e=this.app.workspace.activeLeaf.view.leaf.width)&&void 0!==e?e:0;if(this.Leaf_Width==i)return!1;if(i>0&&(this.Leaf_Width=i,this.settings.cMenuWidth&&i)){if(i-this.settings.cMenuWidth<78&&i>this.settings.cMenuWidth)return;setTimeout((()=>{(function(){E=t.requireApiVersion("0.15.0")?activeWindow.document:window.document;let e=E,i=e.querySelectorAll("#editingToolbarModalBar"),o=e.querySelectorAll("#editingToolbarPopoverBar");i.forEach((t=>{t&&(t.firstChild&&t.removeChild(t.firstChild),t.remove())})),o.forEach((t=>{t&&(t.firstChild&&t.removeChild(t.firstChild),t.remove())}))})(),F(app,this)}),200)}}}}}onload(){var i;return e(this,void 0,void 0,(function*(){const e=this.manifest.version;console.log("editingToolbar v"+e+" loaded"),ei=t.requireApiVersion("0.15.0")?activeWindow.document:window.document,yield this.loadSettings(),this.settingTab=new Ke(this.app,this),this.addSettingTab(this.settingTab),this.commandsManager=new ni(this),this.commandsManager.registerCommands();const o=this.commandsManager.getActiveEditor();this.app.workspace.onLayoutReady((()=>{this.statusBar=new Je(this),this.statusBar.init()})),this.init_evt(ei,o),t.requireApiVersion("0.15.0")&&this.app.workspace.on("window-open",(t=>{this.init_evt(t.doc,o)}));((null===(i=this.settings)||void 0===i?void 0:i.lastVersion)||"0.0.0")!==e&&(new $e(this.app,this).open(),this.settings.lastVersion=e,yield this.saveSettings());app.plugins.enabledPlugins.has("obsidian-memos")&&this.registerEvent(this.app.workspace.on("thino-editor-created",this.handleeditingToolbar)),this.registerEvent(this.app.workspace.on("active-leaf-change",this.handleeditingToolbar)),this.registerEvent(this.app.workspace.on("layout-change",this.handleeditingToolbar_layout)),this.registerEvent(this.app.workspace.on("resize",this.handleeditingToolbar_resize)),1==this.settings.cMenuVisibility&&setTimeout((()=>{dispatchEvent(new Event("editingToolbar-NewCommand"))}),100),Object.keys(Qe).forEach((e=>{t.addIcon(e,Qe[e])}))}))}isLoadMobile(){var e;let i=window.innerWidth>0?window.innerWidth:screen.width,o=!!(null===(e=this.settings)||void 0===e?void 0:e.isLoadOnMobile)&&this.settings.isLoadOnMobile;return!(t.Platform.isMobileApp&&!o&&i<=768)||(console.log("editing toolbar disable loading on mobile"),!1)}init_evt(t,i){this.EN_FontColor_Format_Brush=!1,this.EN_BG_Format_Brush=!1,this.EN_Text_Format_Brush=!1,this.formatBrushActive=!1,this.registerDomEvent(t,"mouseup",(t=>e(this,void 0,void 0,(function*(){if(t.button&&(this.EN_FontColor_Format_Brush||this.EN_BG_Format_Brush||this.EN_Text_Format_Brush||this.formatBrushActive)&&L(this),!this.isView())return;let e=this.commandsManager.getActiveEditor();if(null==e?void 0:e.hasFocus()){let t=q(this.app,this.settings);if(null==e.getSelection()||""==e.getSelection())return void(t&&"following"==this.settings.positionStyle&&(t.style.visibility="hidden"));this.EN_FontColor_Format_Brush?a(this.settings.cMenuFontColor,e):this.EN_BG_Format_Brush?r(this.settings.cMenuBackgroundColor,e):this.EN_Text_Format_Brush?N(0,e):this.formatBrushActive&&this.lastExecutedCommand?this.applyFormatBrush(e):"following"==this.settings.positionStyle&&O(this.app,this.settings,e)}else(this.EN_FontColor_Format_Brush||this.EN_BG_Format_Brush||this.EN_Text_Format_Brush||this.formatBrushActive)&&L(this)})))),this.registerDomEvent(ei,"keydown",(t=>{if("following"!==this.settings.positionStyle)return;const e=q(this.app,this.settings);!t.shiftKey&&e&&(e.style.visibility="hidden")})),this.registerDomEvent(ei,"wheel",(()=>{if("following"!==this.settings.positionStyle)return;const t=q(this.app,this.settings);t&&(t.style.visibility="hidden")}))}onunload(){S(),console.log("editingToolbar unloaded"),this.app.workspace.off("active-leaf-change",this.handleeditingToolbar),this.app.workspace.off("layout-change",this.handleeditingToolbar_layout),this.app.workspace.off("resize",this.handleeditingToolbar_resize)}isView(){const e=this.app.workspace.getActiveViewOfType(t.ItemView);return T.isAllowedViewType(e)}setIS_MORE_Button(t){this.IS_MORE_Button=t}setEN_BG_Format_Brush(t){this.EN_BG_Format_Brush=t}setEN_FontColor_Format_Brush(t){this.EN_FontColor_Format_Brush=t}setEN_Text_Format_Brush(t){this.EN_Text_Format_Brush=t}setTemp_Notice(t){this.Temp_Notice=t}loadSettings(){return e(this,void 0,void 0,(function*(){this.settings=Object.assign({},x,yield this.loadData())}))}saveSettings(){return e(this,void 0,void 0,(function*(){yield this.saveData(this.settings)}))}setLastExecutedCommand(t){this.lastExecutedCommand=t;const e=this.app.commands.commands[t];if(e&&e.name)this.lastExecutedCommandName=e.name;else{const e=t.split(":");this.lastExecutedCommandName=e[e.length-1].replace(/-/g," ")}}toggleFormatBrush(){this.lastExecutedCommand?(this.formatBrushActive=!this.formatBrushActive,this.formatBrushActive?(this.EN_FontColor_Format_Brush=!1,this.EN_BG_Format_Brush=!1,this.EN_Text_Format_Brush=!1,this.formatBrushNotice&&this.formatBrushNotice.hide(),this.formatBrushNotice=new t.Notice(g("Format brush ON! Select text to applyã€")+this.lastExecutedCommandName+g("ã€‘format"),0)):this.formatBrushNotice&&(this.formatBrushNotice.hide(),this.formatBrushNotice=null)):new t.Notice(g("Please execute a editingToolbar format command first, then enable the format brush"))}applyFormatBrush(t){if(!this.lastExecutedCommand||!this.formatBrushActive)return;const e=this.app.commands.commands[this.lastExecutedCommand];e&&e.callback&&e.callback()}quiteAllFormatBrushes(){this.EN_FontColor_Format_Brush=!1,this.EN_BG_Format_Brush=!1,this.EN_Text_Format_Brush=!1,this.formatBrushActive&&(this.formatBrushActive=!1,this.formatBrushNotice&&(this.formatBrushNotice.hide(),this.formatBrushNotice=null)),this.Temp_Notice&&(this.Temp_Notice.hide(),this.Temp_Notice=null)}getCommandsManager(){return this.commandsManager}reloadCustomCommands(){this.commandsManager.reloadCustomCommands()}}module.exports=si;


/* nosourcemap */