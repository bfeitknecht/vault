{"path":"sem2/DDCA/UE/e/manual/DDCA-u08b-manual.pdf","text":"P A G LA B 8 â€“ Ful l Sy s t e m I nt e g r a t i o n SE SSI O N I I SPE E D U P T H E SN A K E In th is p a rt o f th e e x e rc ise , w e w ill try to c o n tro l th e sn a k e ' s sp e e d . T h e i d e a i s t o u se t w o sw i t c h e s o n t h e st a rt e r k i t t o c o n t ro l fo u r di f f er ent s peed val ues . T he t as ks ar e t he f ol l ow i ng: 1. Ex t e n d t h e t o p - le v e l h ie ra rc h y to a c c e p t in p u ts fro m s w itc h e s a n d tra n s fe r th e v a lu e s to re g is te rs . 2. Un d e r s t a n d t h e p r o v i d e d a s s e mb l y p r o g r a m sn a k e _ p a t t e rn s. a sm and m odi f y i t t o accept a 2 - bi t i nput val ue f r om t he s w i t ches . B as ed on t he i nput , i ncr eas e or decr eas e t he s peed of t he s nake. 3. Op t i o n a l l y , y o u h a v e t wo c h a l l e n g e t a s k s t o c o mp l e t e . Exte n d i n g th e I / O fu n c ti on al i ti e s For t he cr aw l i ng s nake exer ci s e i n t he pr evi ous par t , w e onl y had t o s t or e t he val ue t o dr i ve t he 7 - se g m e n t di s pl ay appr opr i at el y. I n t hi s par t , w e need t o r ead t he val ues f r om t he s w i t ches on t he s t ar t er ki t . For t hi s pur pos e, w e add an addi t i onal I / O r egi s t er t o th e M IP S p ro c e s s o r th a t is 2 b its w id e (1 b it fo r e a c h s w itc h ) and as s i gn an addr es s . T he t abl e of I / O r egi s t er s i s as f ol l ow s : Ad d r e s s Di r e c t i o n Wi d t h De s c r i p t i o n 0x00007FF0 out 28 bits Va l u e t o b e s e n t t o t h e 7 - se g m e n t d i sp l a y . 0x00007FF4 in 2 bits Spe e d s t e p 0, 1, 2 or 3. In th e to p . v file , c re a te a n in p u t sig n a l fo r th e sw itc h e s. D e p e n d in g o n th e v a lu e o f IOAddr , se t t h e IOReadData si g n a l t h a t c o n n e c t s t o t h e M IP S p ro c e sso r. M o d i fy t h e X D C fi l e so t h a t t h e i n p u t si g n a l i s connect ed t o t he cor r ect F P G A pi ns . S ynt hes i ze t he pr oj ect t o check f or any er r or s . N ot e: IOReadData is a 32 - bi t s i gnal ; h o w e v e r, we u s e o n l y t h e 2 L S Bs t o r e a d t h e s t at us of t he s w i t ches . Pi n La b e l o n b o a r d De s c r i p t i o n V1 6 SW 1 Sl i de s w i t c h, M SB of s pe e d s t e p a m ount . V1 7 SW 0 Sl i de s w i t c h, L SB of s pe e d s t e p a m ount . M od i fyi n g th e A s s e mb l y p r ogr am Th e a s s e m b l y c o d e f r o m P a r t 1 s i m p l y l o o p s c o n t i n u o u s l y w i t h n o cont r ol s . T her ef or e, w e need t o m odi f y th e c o d e to a c c e p t th e in p u t fro m th e s w itc h e s a n d a c c o rd in g ly c o n tro l th e s p e e d o f th e c ra w lin g s n a k e . Us i n g t h e M ARS e n v i r o n m e n t , m o d i f y t h e a s s e m b l y p r o g r a m sn a k e _ p a t t e rn s. a sm so t h a t i t w i l l re a d i n t h e 2 - bi t s w i t ch val ue us i ng me mo r y - ma p p e d I/O . T h e n , d e p e n d in g o n th e in p u t, m o d ify th e d e la y lo o p su c h th a t th e s n a k e m o v e s fa s te r o r s lo w e r. Hi n t : Y o u c a n u s e t h e M A R S e n v i r o n me n t t o c h e c k y o u r mo d i f i e d c o d e . J u s t r e me mb e r t o t e s t i t wi t h a s ma l l e r lo o p c o u n te r v a lu e . Yo u r m o d i f i e d p r o g r a m n e e d s t o b e c o p i e d i n t o t h e t e x t f i l e in s m e m _ h .tx t . T o d o th is , y o u c a n u s e th e M e m o r y Du m p o p t i o n wi t h i n t h e M ARS a s s e m b l e r . By s e l e c t i n g t h e \" Me m o r y S e g m e n t \" as \" .te x t \" and \" Du m p For m a t \" as \" He x a d e c i m a l T e x t \" , y o u a r e a b le to gener at e t he r equi r ed f i l e. A l l you have t o do i s us e a t ext edi t or and m ake s ur e t hat t he f i l e has exact l y 64 l i nes . A l l l i nes af t er your r eal code have t o be f i l l ed w i t h zer oes . P A G Si nc e w e us e m e m or y - bas ed var i abl es i n t he dat a m em or y, t he \" .d a ta \" se g m e n t has t o be expor t ed t o dat am em _h. t xt th e s a m e w a y a s th e \" .te x t \" se g m e n t . N o t i c e t h a t , a f te r e x p o r tin g , th e dat am em _h. t xt file cont ai ns ma n y l i n e s . M a k e s u r e t h a t t h e f i l e h a s 6 4 l i n e s , a n d d e l e t e a l l l i n e s a f t e r t h a t . Ge n e r a t e t h e p r o g r a m m i n g f i l e i n Xi l i n x V i vado, pr ogr am t he FPG A and cont r ol t he s peed of t he cr aw l i ng sn a k e u si n g t h e sw i t c h e s. F i x a n y p ro b l e m s y o u m i g h t h a v e a n d sh o w y o u r re su l t s t o a n a ssi st a n t . S u mmar y of th e D e s i gn F l ow Th e f o l l o w i n g f i g u r e s u m m a r i z e s t h e s t e p s t o f o l l o w w h i l e b u i l d i n g t h e s y s t e m . Th e w o r k f l o w c a n b e d i v i d e d in to h a rd w a re a n d s o ftw a re s e c tio n s . T h e s o ftw a re s e c tio n c o n s is ts o f th e a s s e m b ly p ro g ra m th a t th e M IP S pr oces s or execut es . T he har dw ar e s ect i on co mp r i s e s t h e M I P S p r o c e s s o r a n d t h e p e r i p h e r a l s y s t e m i t s e l f . Th e a s s e m b l y c o d e i s w r i t t e n a n d v a l i d a t e d u s i n g t h e M A RS s i m u l a t o r e n v i r o n m e n t . A f t e r c h e c k i n g i f t h e code pr oduces t he des i r ed out put , t he dat a and i ns t r uct i on m em or i es ar e dum ped as hexadeci m a l v a lu e s . T h e tw o m e m o ry d u m p s re p re s e n t th e d a ta a n d o p c o d e s th a t a re u s e d b y th e M IP S p ro c e s s o r. T h e h a rd w a re ar chi t ect ur e i s cons t r uct ed i n V er i l og us i ng X i l i nx V i vado. T he Da t a M e mo r y . v and In stru c tio n M e m o ry . v file s u se th e file s d u m p e d b y M A R S to in sta nt i at e t he m em or y bl ocks . T he X D C f i l e i s m odi f i ed t o m ap t he ci r cui t t o t he F P G A boar d. F i nal l y, t he bi t f i l e us ed t o pr ogr am t he F P G A i s gener at ed. R em em ber t o f ol l ow th e s te p s w h e n y o u m a k e a n y c h a n g e s to th e file s . Th e C h al l e n ge We n o w h a v e a c o m p l e t e s ys t em cons i s t i ng of a M I P S pr oces s or t hat can r un our ow n pr ogr am s , accept in p u ts fro m th e onboar d sw i t c h e s, a n d d i sp l a y re su l t s o n t h e 7 - se g m e n t d i sp l a y . H e re a re so m e i d e a s fo r t h e chal l enge s eeker s . Ch a l l e n g e 1 : Ch a n g e t h e s n a k e c r a wl i n g pat t er n. For exam pl e, m odi f y t he as s em bl y code t o cr aw l t he s nake in a z ig - zag pat t er n , as s how n i n t he f i gur e bel ow . Ch a l l e n g e 2 : To g g l e t h e d i r e c t i o n o f t h e s n a k e . A d d a n a d d i t i o n a l s w i t c h i n p u t to cont r ol t he di r ect i on of t he sn a k e ' s mo v e me n t . F o r exam pl e, t he s nake m oves f or w ar d ( you can choos e t o ei t her l oop or zi g - zag) i f t he sw i t c h i s 0 a n d b a c k w a rd w h e n t h e sw i t c h i s 1 . T h i s i s m o re c h a l l e n g i n g b e c a u se o f t h e l i m i t e d n u m b e r o f in s tru c tio n s th a t c a n b e e x e c u te d in o u r M IP S p ro c e s s o r. Y o u w ill a ls o n e e d to m o d ify th e to p - le v e l h ie ra rc h y to a d d a re g is te r to tra n s fe r th e v a lu e o f th is n e w s w itc h . Las t Wor d s In th is e x e rc ise , w e h a v e re a liz e d a c o m p le te a n d w o rk in g m ic ro p ro c e sso r th a t is a b le to e x e c u te a sm a ll su b se t o f t h e M IP S i n st ru c t i o n se t . I t does n' t se e m t o b e t h a t c o m p l e x , d o e s i t ? T h e re a re t w o m a i n re a so n s wh y wr i t i n g t h e c o d e o f t h e p r o c e s s o r wa s ( r e l a t i v e l y ) e a s y . 1. Fi r s t , M I PS us e s a s i m pl e a r c hi t e c t ur e , and one of i t s pr i or i t i es i s a s i m pl e des i gn i m pl em ent at i on. 2. Se c ond, w e s t a r t e d f r om a w e l l - docum ent ed bl ock di agr am ( t aken f r om t he book) t hat had al r eady deci ded how t he pr oces s or w as par t i t i oned, w hat s i gnal s w er e us ed t o connect t hem , and how t he si g nal s w er e def i ned. A l l t hat w as l ef t w as t o conver t t he bl ock di agr am i nt o V er i l og s ynt ax. Ad d i t i o n a l l y , we a d d e d t h e c a p a b i l i t y t o i n t e r f a c e wi t h t h e r e s t o f t h e wo r l d s o t h a t we c a n t r a n s f e r t h e pr oces s or t o t he FPG A boar d and act ual l y s ee our pr ogr am s e xecut e. In th e fo llo w in g la b , w e w ill im p ro v e th e c u rre n t p ro c e sso r b y a d d in g n e w in stru c tio n s a n d sp e e d in g u p cal cul at i ons .","libVersion":"0.3.1","langs":""}