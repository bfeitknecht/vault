{"path":"sem4/DMDB/UE/slides/DMDB-s01relational-model.pdf","text":"@DS3Lab www.DS3Lab.com Anıl Eren Göçer & Maximilian Heer Data Modelling & Databases agoecer@student.ethz.ch maximilian.heer@inf.ethz.ch Exercise 1: Relational Model & Relational Algebra Spring 2025 General Informations ▪ Slides on Moodle after the second session. ▪ Exercises released one week before the session. ▪ Lecture slides: https://moodle- app2.let.ethz.ch/course/view.php?id=24995#section-1 ▪ Lectures will be recorded, but not live-streamed. ▪ Exercise sessions not recorded ▪ Exam on Moodle, same style as exercises. This Session ▪ Gain intuition about valid Relational Models. ▪ How to use Relational Algebra to query. ▪ Anıl Eren Göçer : agoecer@student.ethz.ch ▪ Maximilian Heer: maximilian.heer@inf.ethz.ch Question 1 Details: Relations are nothing but sets of tuples. Question 1 Details: Often false particularly after applying relational algebra operators. Question 1 Secondary key is a column or a set of columns in a table that uniquely identifies each row in a table that is not the primary key. Details: counter-example: A secondary key can have one attribute. Question 1 Details: Check the definition of a (candidate) key. Question 1 Details: Consider the following (FirstName, LastName, LegiNr) vs. (FirstName, LastName, LegiNr) Question 2 Problem: No two students with same first and last name allowed! Question 2 Details: There can exist two student with the same name, surname and age. Question 2 Details: Schemas ofter use some (partially) generated numbers as keys. LegiNr. is unique for every student. Question 3 Advice: Try to visualize the model (more on this later in the course). Question 3 Q: Two departments with the name \"Engineering\" could exist at the same time. A: Correct, dept_name is not a candidate key. Question 3 Q: An employee could be employed at two departments at the same time. A: Correct. departments 1 , HR, Zurich 2, Law, Zurıch dept_employee 1234, 1, 01-01-2014, 01-01-2020 1234, 2, 01-01-2014, 01-01-2020 Question 3 Q: No employee can work at a department and manage another one at the same time. A: Wrong. departments 1 , HR, Zurich 2, Law, Zurıch dept_employee 1234, 1, 01-01-2014, 01-01-2020 1234, 2, 01-01-2014, 01-01-2020 dept_manager 1234, 1, 01-01-2014, 01-01-2020 Question 3 Q: For the entries in the dept_manager relation the to_date cannot be before the from_date. A: Wrong. SPOILER: CHECK in SQL Question 3 Q: Given an employee we can identify exactly one department where (s)he works. A: Wrong. An employee can work at multiple departments. Question 3 Q: An employee could collect more than one salary at the same time. A: Correct. Hint: (emp_no) is not the primary key of relation “salaries”. Question 3 Q: Some entries in salaries could have no from_date and no employee associated to them. A: Wrong. Hint: (emp_no, from_date) is a foreign key refering to dept_employee. Question 3 Q: It is possible that an employee starts at the same department of different dates (independent of the to_date). A: True. dept_employee 1234, 1, 01-01-2014, 01-01-2020 1234, 1, 09-01-2016, 02-03-2021 Question 4 • Dangling tuple: a tuple in a relation that does not join with any tuple in other relation. • Dangling tuples can be omitted when we perform a join operation. Question 4Question 4 For more: https://www.cs.emory.edu/~cheung/Courses/554/Syllabus/9-parallel/semi-join1.html Question 4 Answer: Question 5 Correctly represents the operation in the previous question. Question 6 Q: A: True Question 6 Q: A: True Question 6 Q: A: False Candidate keys are column(s), which are minimal, uniquely describing each tuple ! Question 6 Q: A: False Q: A: True CourseRegistrations 12-34-567 | 252-0063-00L | Fall | 2024 12-34-567 | 252-0063-00L | Spring | 2025 12-34-567 | 252-0063-00L | Fall | 2025 Question 6 Q: A: Q: A: CourseRegistrations 12-34-567 | 252-0063-00L | Fall | 2024 12-34-567 | 252-0063-00L | Spring | 2025 12-34-567 | 252-0063-00L | Fall | 2025 Q: A: False, candidate keys should be minimal! False candidate keys should be minimal! True Question 7 Correct. SELECTION PROJECTION Question 7 Correct. SELECTION PROJECTION NATURAL JOIN Question 7 Wrong. 'Book' is not joined! Loan has no Author and Title attributes. Question 7 Wrong. Question 7 – Part 4 extd. ISBN Title A XZY B ABC C FGH Book: ISBN CategoryName A Alps B Switzerland A Others C Switzerland C Alps BookCategory: Looking for the book A. Question 7 – Part 4 extd. ISBN CategoryName Title A Alps XZY B Switzerland ABC A Others XYZ C Switzerland FGH C Alps FGH BookCategory ⨝ Book Question 7 – Part 4 extd. ISBN CategoryName Title A Alps XZY C Alps FGH 𝜎(BookCategory ⨝ Book) ISBN CategoryName A Alps B Switzerland A Others C Switzerland C Alps Question 7 – Part 4 extd. Correct query: Question 8 Q: We want to find winners for every distance. A winner has the shortest time for a given distance. Notation abuses: - Renaming of relation, not attribute - Theta-join on attribute short for: Run1.Distance = Run2.Distance THETA-JOINRENAMING Explanation: - Two copies of runs, renamed to run1, run2 - Joined on distance - From all runs remove all run1 for which there exists run2 that is faster Runs of non- winners Question 9 Q: All runs with a distance greater than 100m in which only runners from Switzerland participated. Two ways: 1) Parse the query 2) Parse expressions Advice: Parse expressions, and spot the differences. Question 9 Q: All runs with a distance greater than 100m in which only runners from Switzerland participated. Runs with distance > 100 Swiss runners Question 9 Q: All runs in which only runners from Switzerland participated. Run = Non-swiss runnersRuns in which at least one non- Swiss runner participated Runs in which only runners from Switzerland participated Question 10 Q: Which of the following relational algebra expressions finds all runners which only participated in 100m race distance runs? Runners can include people who have not done any race. Question 11 R × S A R.B S.B C D 1 x x 0 3 1 x y 2 1 1 x y 3 3 ... 9 a y 2 0 = 25 # tuples in R x S = # tuples in R . # tuples in S Question 12 Natural Join –> Join on the columns with the same name -> Join on B 1 + 3 + 0 + 1 + 0 = 5 Question 13 - R ⋊ S R ⨝ S A B C D 1 x 0 3 2 y 2 1 2 y 3 3 2 y 2 0 3 x 0 3 = 5 ΠB,C,D(R ⨝ S) B C D x 0 3 y 2 1 y 3 3 y 2 0 = 4 i.e. Result of R ⋊ S contains non-dangling tuples from S R ⋊ S = ΠB,C,D(R ⨝ S) Question 14 i.e. Result of R ⋉ S contains non-dangling tuples from S R ⋉ S = ΠA,B(R ⨝ S) Question 15 – R⋈A=CS R⋈A=CS A,C R.B S.B D 2 y y 1 2 y y 0 2 z y 1 2 z y 0 3 x y 3 3 x w 0 = 6 Question 16 = 2 C Question 17 = 3 {x,y,z,a} – {y,w} = {x,z,a} Question 18 = {1,2,3,9} = {3,1,0} ∩ = Invalid = {1,3} = 2 Question 19 D 3 1 0 2 matching tuple 1 matching tuple 2 matching tuple = 5 Questions 11 - 19 Expression Size of Result (# of tuples in Set) R×S R⋈S R ⋊ S R ⋉ S R⋈A=CS ρC←A(R)⋈S ΠB(R)−ΠB(σC>0(S)) ΠA(R)∩ρA←D(ΠD(S)) ΠD(S)⋈S 25 5 4 3 6 6 3 2 5 Question 20 P ⨝ Q P.A P.B Q.B Q.C Q.D 1 1 1 4 0 1 1 1 7 2 2 2 2 5 2 1 3 3 2 2 3 1 1 4 0 3 1 1 7 2 1 2 2 5 2 P.A B Q.C Q.D 1 1 4 0 1 1 7 2 2 2 5 2 1 3 2 2 3 1 4 0 3 1 7 2 1 2 5 2 Question 21 Recall: • ÷ stands for relational division • 𝑅 ÷ 𝑆 = 𝑇 ∶ 𝑇 is the largest relation such that 𝑆 × 𝑇 ⊆ 𝑅 • 𝑅 ÷ 𝑆 = ς𝑅−𝑆 𝑅 − ς𝑅−𝑆( (ς𝑅−𝑆 𝑅) × 𝑆 − 𝑅 ) i.e. R ÷ S includes all the tuples r from R such that r joins with all the tuples in S Question 22 Q: Is it possible to find all possible connections between two stations independent on the number of transfers? A: No. Relational algebra does not offer infinite recursion. Therefore, we can only find connections up to a specific maximum search depth. Question 23 Q: Is it possible to find all possible connections between two stations, with a specific number of transfers? A: Yes, it can be found using a relational algebra expression involving nested joins with a defined depth. Question 24 Query: Find all the direct connections from Zurich (any station) to Geneva (any station). selecting all stations in Genevarenaming as ToName selecting all stations in Zurichrenaming as FromName joining through Connections Question 25 Query: Find all the single-transfer connections from Zurich to Locarno. The transfer station can be any of the stations but the connecting trains should run on the same day. selecting all stations in Locarno renaming as ToName selecting all stations in Zurichrenaming as FromName joining through Connections joining through Connections Question 25 Query: Find all the single-transfer connections from Zurich to Locarno. The transfer station can be any of the stations but the connecting trains should run on the same day. - c1.ToStation = c2.FromStation AND - c1.Arrival < c2.Departure AND - DAY(c1.Arrival) = DAY(c2.Departure) AND - c1.ItNr <> c2.ItNr (in order to be a SINGLE-transfer) @DS3Lab www.DS3Lab.com Thanks.","libVersion":"0.5.0","langs":""}