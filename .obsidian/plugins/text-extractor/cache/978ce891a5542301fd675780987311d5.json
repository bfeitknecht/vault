{"path":"sem4/CN/UE/s/CN-u07-s.pdf","text":"Exercise 7: IP / BGP Question 1: Private IP Addresses IANA documented in RFC 1918 (written in February 1996) the “Address Allocation for Private Internets”. RFC 1918 specifies 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16 as private addresses suitable for unrestricted private internal use. Many home networks use the 192.168.1.0/24 address space and use NAT to a single public address. Question 1.1 Could 172.28.2.0/24 be used as the address space for an internal network? Explain your answer. Solution: Yes. 172.28.2.x falls under the /12 block. The range (RFC 1918) is 172.16.0.0 - 172.31.255.255 Question 1.2 Could 10.255.255.0/24 be used as the address space for an internal network? Explain your answer. Solution: Yes, that range is also within one of the blocks reserved for private networks. Question 1.3 Assume a technically illiterate user configures 8.8.8.0/24 as the internal address space on their home router. Assume that NAT is used at the router, and there is a public interface on that router with IP address 19.33.93.140. Briefly explain what happens if a user at a system with IP 8.8.8.2 attempts to establish a network connection with a system on the Internet at IP address 8.8.8.8 (Google’s public DNS). Can the two systems communicate? Briefly explain. Solution: Any internal machine trying to communicate with a computer outside the network with IP 8.8.8.8 would assume that 8.8.8.8 is on the same local network, thus would attempt to find the destination on the local network rather than doing NAT and forwarding to the Internet. Any connection would fail. Question 1.4 (optional) If you havent done it already find out your PC’s current IP address. (ifconfig command for linux and ipconfig /all command for windows). Is it a private address? Solution: Most likely you have a private IP address dynamically assigned to you by a local DHCP server since your network is hidden behind a NAT device. However other network setups exist as well. 1 Question 2: The Border Gateway Protocol Consider the AS-level topology in the picture below: Network Topology Say AS1 starts by announcing prefix 13.13.0.0/16 into the network at time 0. All routing messages exchanged in this problem pertain to the prefix 13.13.0.0/16. At time 1, each of AS1’s neighbors – AS2, AS5 and AS6 – propagate the route to their neighbors, and so on. Hint: Note that ASes only announce paths for traffic for which they can earn money and they prefer paths that increase their revenue. Your answers should follow the following format: • Prefix: 13.13.0.0/16 • Path: {AS1} • Send To: AS2, AS5, AS6 Question 2.1 State the path vector that AS5 sends out at time 1 and to which of its neighbors it is send. (following the format above) Solution: • Prefix: 13.13.0.0/16 • Path: {AS5, AS1} 2 • Send To: AS4, AS6, AS7 Question 2.2 State all path vectors that AS7 sends out at time 2 and to which of its neighbors it is send. Solution: AS7 receives announcements from AS5 and AS6. According to the BGP rules, it can extend both of them and forward them to selected neighbors as follows: • Path vector 1: – Prefix: 13.13.0.0/16 – Path: {AS7, AS5, AS1} – Send To: AS6, AS8 • Path vector 2: – Prefix: 13.13.0.0/16 – Path: {AS7, AS6, AS1} – Send To: AS5 Question 2.3 A valid AS-level path is one that is allowed by economic policies. 1. List all possible, valid, AS-level paths from AS8 to the prefix 13.13.0.0/16. 2. Argue why {AS8, AS7, AS6, AS1} is a valid (or invalid) AS-level path from AS 8 to the prefix 13.13.0.0/16? Solution: 1. Possible paths: • {AS8, AS4, AS5, AS1} • {AS8, AS7, AS5, AS1} 2. The path {AS8, AS7, AS6, AS1} is invalid since AS7 would not announce the prefix 13.13.0.0/16 via AS6 to AS8. AS7 would not earn money by forwarding packets from a peer to a peer. Question 2.4 Which path will AS8 use to route to the prefix 13.13.0.0/16? Why? Solution: AS8 will use the path through its customer AS4. The reasons are financial earnings since AS4 has to pay AS8 for traffic. If AS8 would have used the path through its peer AS7, it would not have made any money. Question 2.5 Assume that Link 5 − 7 is removed from the topology. Would AS7 announce the prefix 13.13.0.0/16 with {AS7, AS6, AS1} to AS8? Briefly explain. 3 Solution: No it would not. AS7 does still not earn money by forwarding packets from a peer to a peer. Question 3: BGP Convergence In this problem, we study the convergence of the BGP routing protocol. We will consider BGP routers that implement two policies: the route selection policy and the export policy. The route selection policy is used to select the preferred route to the destination, based on the routes learned from the neighboring routers. The export policy is used to select which routes would be announced to each neighboring router. Network Topology For this problem and the ASes in the figure above, we make the following assumptions: • All ASes in Figure 1 have the same route selection and export policies, as follows: – Route Selection Policy: The boxes with the dotted lines in the figure above show the preferred routes of each AS towards the desti- nation D. If there are two routes in the box, ASes prefer the upper route over the lower route. For example, AS 3 prefers route {321D} over route {34D} to reach AS D, and uses route {34D} only if route {321D} is not available. Moreover, if no preferred route is available, ASes do not select any route to the destination, and the corresponding routing table becomes empty. For example, if no preferred routes for AS 2 is available, then AS 2 keeps its routing table empty rather than using route {2D}. – Export Policy: Announce the route that has been selected by the route selection policy to all neighboring ASes. For example, AS 1 announces the route {1D} to AS 2. 4 • Each AS has one BGP router. When we refer to an AS, we refer to its BGP router. • All BGP announcements are received by ASes in a synchronized manner, and upon reception, ASes immediately run their route selection policies. You do not have to consider race conditions among the events of sending, receiving, and computing routes. Question 3.1 Initially, assume that the BGP routing tables at ASes 1, 2, 3, and 4 are empty. Then, AS D announces itself to its neighbors. What routes do ASes 1, 2, 3, 4 use to reach AS D? Solution: {1D}, None, None, {4D} Question 3.2 Then all ASes (i.e., ASes 1, 2, 3, 4, and D) simultaneously make BGP announce- ments based on the Export Policy. What routes do ASes 1, 2, 3, and 4 use to reach AS D? Solution: {1D}, {21D}, {34D}, {4D} Question 3.3 Again, all ASes simultaneously make BGP announcements based on the Export Policy. What routes do ASes 1, 2, 3, and 4 use to reach AS D? Solution: {1D}, {234D}, {321D}, {4D} Question 3.4 Again, all ASes simultaneously make BGP announcements based on the Export Policy. What routes do ASes 1, 2, 3, and 4 use to reach AS D? Solution: {1D}, {21D}, {34D}, {4D} Question 3.5 Again, all ASes simultaneously make BGP announcements based on the Export Policy. What routes do ASes 1, 2, 3, and 4 use to reach AS D? Solution: {1D}, {234D}, {321D}, {4D} Question 3.6 Do you see any pattern? Comment about BGP convergence. Solution: Routes for 2 and 3 keep oscillating indefinitely. This suggests that BGP does not converge under these circumstances. 5 Question 4: Distance-Vector Routing Poisoned Reverse is a method to prevent the “count to infinity” problem en- countered when a link fails by sending back a route cost of ∞ to the node that the route was learned from. However, depending on the topology of the network, poisoned reverse cannot always prevent the count to infinity problem. The following network is built in such a way. Broken Network Question 4.1: Poisoned Reverse The table below shows the costs to get from one node (src) to another (dst) as well as the next hop used to reach the destination. Src Dst Time 0 Time 1 Time 2 Time 3 Time 4 A B 1,B 1,B A C 1,C 1,C B C 1,C 1,C B D 2,A 2,A C D 2,A 2,A A D 1,D inf,- At Time 1 the link A-D breaks and therefore A knows that the cost of A-D is now ∞. 6 Give three timesteps after the link breaks to show how poisoned reverse doesn’t work. Assume that all updates are sent out simultaneously and the node then chooses the lowest cost using the information of all received updates. (e.g., A will announce its stored costs to all neighbours. Then it will receive the updates from all its neighbours and then decide which path is the best) Solution: Src Dst Time 0 Time 1 Time 2 Time 3 Time 4 A B 1,B 1,B 1,B 1,B 1,B A C 1,C 1,C 1,C 1,C 1,C B C 1,C 1,C 1,C 1,C 1,C B D 2,A 2,A 3,C inf,- inf,- / 5,A C D 2,A 2,A 3,B inf,- 5,A / inf,- A D 1,D inf,- inf,- 4,B / 4,C inf,- The values for A-B, A-C and B-C never change since that part of the network is unaffected. Hence, we only care about the costs with destination D. Time 2: • B and C previously learned the cost to D from node A and therefore they will both announce a cost of ∞ to A and the cost of node A will therefore still be ∞ • B and C will send each other a cost of 2 (to get to D) and therefore both will set there new cost to 3. (A has announced a cost of ∞ to both of them but since they chose the minimum of all updates they will ignore this path) Time 3: • B and C will update their costs (for D) to ∞ since they learned the route from each other and therefore they will send each other a cost of ∞ and also the cost announced by A will still be ∞. • A will now set its new cost to 4 since both B and C will announce a cost of 3 to A. Time 4: • A will now set its new cost to ∞ since both B and C will announce a cost of ∞ to A. • B and C will announce a cost of ∞ to each other. Since A previously learned its cost from either B or C, it will announce a cost of ∞ to this node and a cost of 4 to the other node. So one of A and B will have a cost of 5 and the other one a cost of ∞. 7","libVersion":"0.5.0","langs":""}