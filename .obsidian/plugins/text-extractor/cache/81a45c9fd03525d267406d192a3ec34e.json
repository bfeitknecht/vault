{"path":"sem4/DMDB/UE/slides/DMDB-s05-normal-form.pdf","text":"Marios Angelis & Jinsheng Ba Data Modeling & Databases mangelis@inf.ethz.ch jinsheng.ba@inf.ethz.ch Exercise 5 Normal forms Spring 25 4NF BCNF 3NF 2NF 1NF Normal forms2NF • 1NF • Each non-key attribute must depend on the entire key • No attribute depends on only part of the key • Eliminates redundant data Question 1 1. We need to show that L2 => L1 2. Prove that not(L1) => not(L2) 3. Construct an FD X → Y not in L1 : Y is non-key attribute and X is a strict subset of a key (not minimally dependent) 4. Then, show that X → Y not in L2: • L2 (a) False – Y is non-key, (then, Y is not a subset of X) • L2 (b) False – Y is a non-key attribute • L2 (c) False – X is a strict subset of a key therefore it is not a superkey • L2 (d) False – X is a strict subset of a key Question 2 Show using L2 that when R is 3NF or BCNF, then it is also 2NF Each set of conditions is a superset of the previous set of conditions. Questions 3-4 Candidate keys : {OrderNumber,ItemNumber} Normal form ? 1NF : Yes 2NF : No, Description depends on a subset of the key 3NF : No Question 5 Candidate keys : {Venue,Year,Artist} Normal form ? 1NF : Yes 2NF : No, Genre depends on a subset of the key 3NF : No Question 6 1NF ? ➢ Composite attributes, therefore no. Member : {Name, Associate, BusinessOwned}. Name Associates BusinessOwned Kim {Mat, Anna} {KKW Beauty, Kardashian Industries Khloé {Mat, John} {Good American, Nvidia} Question 7 (Normalize the relation to 1NF) Name Associates BusinessOwned Kim Mat KKW Beauty Kim Mat Kardashian Industries Kim Anna KKW Beauty Kim Anna Kardashian Industries Khloé Mat Good American Khloé Mat Nvidia Khloé John Good American Khloé John Nvidia Member : {Name, Associate, BusinessOwned}. Question 8 Member : {Name, Associate, BusinessOwned}. Name Associates BusinessOwned Kim {Mat, Anna} {KKW Beauty, Kardashian Industries Khloé {Mat, John} {Good American, Nvidia} BCNF ? Yes, because we do not have any functional dependencies Question 9 Name Associates BusinessOwned Kim Mat KKW Beauty Kim Mat Kardashian Industries Kim Anna KKW Beauty Kim Anna Kardashian Industries Khloé Mat Good American Khloé Mat Nvidia Khloé John Good American Khloé John Nvidia Member : {Name, Associate, BusinessOwned}. Issue ? ➢ INSERT anomaly : lot of redundancies Question 10 Candidate keys : {AB, AC} Normal form ? 1NF : Yes 2NF : No, D depends on a subset of the key 3NF : No Question 11 Candidate keys : {AB, AC} Apply the Synthesis Algorithm: R1: (A,D) with A->D R2: (A,B,C) with A,B->C R3: (A,C,B) with A,C->B Can we merge R2 and R3? R1: (A,D) with A->D R23: (A,B,C) with A,B->C Question 12 Candidate keys: S1 : {AC} S2 : {AB,BC} R : We need to find the minimal basis Question 12 A -> BE A -> D F -> A AC -> F BC -> E C -> A A -> B A -> E A -> D F -> A AC -> F BC -> E C -> A A -> B A -> E A -> D F -> A AC -> F C -> A Why? BC+={B,C,A,E} Expand Right Hand Side Eliminate FDs A -> B A -> E A -> D F -> A C -> F C -> A Eliminate Left-Hand Side Why? C+={C,A} A -> B A -> E A -> D F -> A AC -> F C -> A A -> B A -> E A -> D F -> A C -> F Eliminate FDs Why? C+={C,F,A} A -> BED F -> A C -> F Candidate keys: R1 : {A} R2 : {C} Question 13 Candidate keys: S1 : {AC} S2 : {AB,BC} R1 : {A} R2 : {C} Normal Forms: 1NF : All 2NF : R1, R2 , S2 3NF : R1, S2 BCNF : R1 R1 and R2 FDs: A -> BED F -> A C -> F Question 14: Transform those relations that are lower than 3NF to conform to 3NF. Apply the Synthesis Algorithm to S1 and R2: S11: (A,C,D) with AC->D S12: (A,B) with A->B ----------------------------------------------------------------------------------------------------------------- R21: (F,A) with F->A R22: (C,F) with C->F Question 15 : Candidate keys: {ShipName,Date} because {ShipName,Date}+ = {ShipName,Date,TripId,Port,ShipType,Cargo} {TripId,Date} because {TripId,Date}+ = {ShipName,Date,TripId,Port,ShipType,Cargo} Question 16 : Apply the synthesis algorithm R1: (ShipName, ShipType ) with ShipName -> ShipType R2: (TripId, ShipName,Cargo ) with TripId -> ShipName, Cargo R3: (ShipName,Date,TripId,Port ) with ShipName,Date -> TripId,Port and TripId -> ShipName Now, all of the relations are in 3NF Candidate keys for R3: {ShipName,Date}, {TridId,Date} Question 17 : Apply the decomposition algorithm to R3 R3: (ShipName,Date,TripId,Port ) with ShipName,Date -> TripId,Port and TripId -> ShipName Candidate keys for R3: {ShipName,Date}, {TridId,Date} ----------------------------------------------------------------------------------------------------------------- Pick the evil FD: TripId -> ShipName and create 2 relations: R31: (TripId, ShipName) with TripId -> ShipName R32: (Date, TripId, Port) with TripId,Date -> Port Now, all of the relations are in BCNF Question 17 : Apply the decomposition algorithm TO R3 In total, we have: R1: (ShipName, ShipType ) with ShipName -> ShipType R2: (TripId, ShipName,Cargo ) with TripId -> ShipName, Cargo R31: (TripId, ShipName) with TripId -> ShipName R32: (Date, TripId, Port) with TripId,Date -> Port Thus, we can merge R2 and R31 Questions ?","libVersion":"0.5.0","langs":""}