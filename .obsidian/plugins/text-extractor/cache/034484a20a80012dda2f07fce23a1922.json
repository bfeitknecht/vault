{"path":"sem4/DMDB/VRL/extra/slides/DMDB-s01-relational-algebra.pdf","text":"Data Modeling and Databases Spring Semester 2025 Relational Model And Algebra Relational Model and Algebra Gustavo Alonso Institute of Computing Platforms Department of Computer Science ETH ZÃ¼rich 1 From last lecture = Lessons learned â€¢ The history of the relational model contains several important lessons: â€¢ How you store, place in memory, and query data are three different things â€¢ If they are tied together, things become difficult (physical data independence) â€¢ Writing programs for extracting knowledge out of data is not efficient â€¢ Writing queries that involve knowing how the data is organized is not efficient â€¢ The relational model won because it provided physical (and logical) data independence, and adopted relational algebra to reason about how data is manipulated and combined. Relational Model and Algebra 2 This and Next Lecture â€¢ What is relational model? How to model your data with relational model? â€¢ Two ways of manipulate data in relational model: â€¢ Relational algebra: Set operations, imperative â€¢ Relational calculus: Logic, declarative â€¢ Know the difference between being imperative and being declarative Relational Model and Algebra 3 What is Data? â€¢ It is not really a sequence of 0s and 1s -- It is the knowledge we have about our world. â€¢ How can we represent our knowledge? â€¢ How can we infer new knowledge from old ones? â€¢ Different answers to the above two questions will lead to different database management system. â€¢ This course, we focus on a specific combinations â€“ we represent knowledge as a collection of facts, and doing inference using mathematical logic. â€¢ That gives us the Relational Model. Relational Model and Algebra 4 Relational Model Relational Model and Algebra 5 Relational Model - Schema â€¢ Relational Model - Schema â€¢ Database Schema: A Set of Relation Schemas â€¢ Relation Schema: â€¢ Name â€¢ A Set of Attributes/Fields/Columns â€¢ Field/Attribute: â€¢ Name â€¢ Domain/Type (e.g., Integer, String) Column Attributes, entities Row One instance of relationships between entities/attributes Table Students(sid: string, name: string, login: string, age: int, gpa: float) sid name login age gpa Students Note that â€œSchemaâ€ does not include the â€œContentâ€, it only contains the â€œHeaderâ€ Relational Model and Algebra 6 Relation = Table Relational Model and Algebra 7 Relational Model - Instance â€¢ Relational Model - Instance â€¢ For Relation ğ‘…(ğ‘“1: ğ·1, â€¦ , ğ‘“ğ‘›: ğ·ğ‘›), an instance ğ¼ğ‘… is a Set of tuples: ğ¼ğ‘… âŠ† ğ·1 Ã— â‹¯ Ã— ğ·ğ‘› â€¢ Intuitively, an instance is the â€œContentâ€ of a relation if you think about it as a â€œTableâ€ sid name login age gpa 0 A D 21 3.5 1 B E 32 4.2 2 C F 18 5.3 StudentsStudents(sid: string, name: string, login: string, age: int, gpa: float) Schema Instance Note that a Relation Instance is a Set â€“ (1) we cannot have duplicated tuples in a relation; (2) the order does not matter Engines are different (allow duplicate tuples but, in this course, we by default assume the Set Semantics for Relational Model) Relational Model and Algebra 8 Relational Model â€“ Primary Keys â€¢ Schema for Relation R â€¢ Candidate Key: minimal set of fields that identify each tuple uniquely â€¢ Primary Key: one candidate key; marked in Schema by underlining. â€¢ Every Relation must have a key â€¢ Always possible because a Relation is a set sid name login age gpa 0 A D 21 3.5 1 A E 32 4.2 2 C F 18 5.3 Students(sid: string, name: string, login: string, age: int, gpa: float) Schema Valid Instance Why? Cannot uniquely identify tuple sid name login age gpa 0 A D 21 3.5 0 A E 32 4.2 2 C F 18 5.3 Invalid Instance â–ª Formally, given a relation ğ‘…(ğ‘˜: ğ·ğ‘˜, ğ‘: ğ·ğ‘, ğ‘: ğ·ğ‘) â–ª All valid instances: ğ¼ âŠ† ğ·ğ‘˜ Ã— ğ·ğ‘ Ã— ğ·ğ‘ âˆ§ âˆ€ ğ‘˜, ğ‘, ğ‘ , ğ‘˜â€², ğ‘â€², ğ‘â€² âˆˆ ğ¼, ğ‘˜ = ğ‘˜â€² â‡’ ğ‘, ğ‘ = (ğ‘â€², ğ‘â€²) â–ª This is just one way to constrain the set of â€œValid Instancesâ€, we will see other ways of doing it later in the course Relational Model and Algebra 9 An example of a Relational Model Relational Model and Algebra 10 Relational Model â€¢ A database stores information for a University. â€¢ Professor â€“ has PersNr, Name, Level, Office â€¢ Student â€“ has PersNr, Name, current semester â€¢ Lecture â€“ has LectureID, Title, # Credit Points, who teaches the lecture â€¢ Some lectures are pre-requisites to other lectures â€¢ Students attend lectures â€¢ Some students take tests in lectures and get a Grade â€¢ How to store all this information in the relational model? â€¢ Q1: How to design the schema? â€¢ Q2: What are valid instances? â€¢ Note that the process of designing schemas will have a more principled (and intuitive) process in later lectures, this is just to illustrate the relational model. Relational Model and Algebra 11 Relational Model â€¢ A database stores information for University. Professor â€“ has PersNr, Name, Level, Room Relation: Professor Schema: â€¢ PersNr: Int â€¢ Name: String â€¢ Level: String â€¢ Room: Int => Professor(PersNr: Int, Name: String, Level: String, Room: Int) PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Instance: Set of (PersNr, Name, Level, Room) tuples PersNr Name Level Room 2125 John AP 226 2125 David FP 232 Violate Key Constraint Valid Instance Relational Model and Algebra 12 Relational Model Student â€“ has PersNr, Name, current semester Relation: Student Schema: â€¢ PersNr: Int â€¢ Name: String â€¢ Semester: Int => Student(PersNr: Int, Name: String, Semester: Int) PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Instance: Set of (PersNr, Name, Semester) tuples PersNr Name Semester 24002 Peter 8 24002 Peter 8 Invalid, Relations are SETs Valid Instance Relational Model and Algebra 13 LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 LectureID Title CP ProfNr 5001 Databases 4 2125 5002 Databases 4 2125 Relational Model â€¢ Lecture â€“ has LectureID, Title, # Credit Points, who teaches the lecture Relation: Lecture Schema: â€¢ LectureID: Int â€¢ Title: String â€¢ CP: Int â€¢ ProfNr: Int (Profâ€™s PersNr) => Lecture(LectureID: Int, Title: String, CP: Int, PersNr: Int) Instance: Set of (LectureID, Title, CP, PersNr) tuples Valid Instance (Though weird in real-world) Valid Instance Relational Model and Algebra 14 Prerequisite Follow-up 5001 5041 5001 5043 Relational Model â€¢ Some lectures are pre-requisites to other lectures Relation: Requires Schema: â€¢ Prerequisite: Int. (key?) â€¢ Follow-up: Int. (key?) What is the key? Option 1. (Prerequisite, Follow-up) Option 2. (Prerequisite, Follow-up) Option 3. (Prerequisite, Follow-up) Prerequisite Follow-up 5001 5041 5002 5041 Option 1: Invalid Option 2: Valid Option 3: Valid Option 1: Valid Option 2: Invalid Option 3: Valid Option 3 seems to be a more natural choice for the data we want to store. We have Requires(Prerequisite, Follow-up)Relational Model and Algebra 15 PersNr LectureID 26120 5001 27550 5001 Relational Model â€¢ Students attend lectures Relation: Attends Schema: â€¢ PersNr: Int. (key?) â€¢ LectureID: Int. (key?) What is key? Option 1. (PersNr, LectureID) Option 2. (PersNr, LectureID) Option 3. (PersNr, LectureID) PersNr LectureID 26120 5001 26120 5041 Option 1: Valid Option 2: Invalid Option 3: Valid Option 1: Invalid Option 2: Valid Option 3: Valid Option 3 seems to be a more natural choice for the data we want to store. We have Attends(PersNr, LectureID)Relational Model and Algebra 16 PersNr LectureID Grade 26120 5001 5.0 27550 5001 5.5 26120 5041 5.75 Relational Model â€¢ Some students take tests in lectures and get a Grade Relation: Tests Schema: â€¢ PersNr: Int. â€¢ LectureID: Int. â€¢ Grade: Float What is key? Tests(PersNr, LectureID, Grade) What is the underlying assumption we have on the data in this design? A student only takes the exam of a lecture once. Why? Otherwise, you will have (p, l, g1), (p, l, g2) in DB, violating the key constraints. What if this assumption is not true? Change the schemaRelational Model and Algebra 17 PersNr LectureID Grade 26120 5001 5.0 27550 5001 5.5 26120 5041 5.75 Relational Model â€¢ One Possible Design of the Schema: â€¢ Professor(PersNr: Int, Name: String, Level: String, Room: Int) â€¢ Student(PersNr: Int, Name: String, Semester: Int) â€¢ Lecture(LectureID: Int, Title: String, CP: Int, PersNr: Int) â€¢ Requires(Prerequisite, Follow-up) â€¢ Attends(PersNr, LectureID) â€¢ Tests(PersNr, LectureID, Grade) One Possible Instance: Tests PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Professor PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP PersNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture Prerequisite Follow-up 5001 5041 5001 5043 Requires PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Relational Model and Algebra 18 Relational Model -- Schemas â€¢ There are multiple ways to design a Schema â€¢ Different designs might have different pros and cons â€¢ We will see how to design a good schema later in the course. Relational Model and Algebra 19 TPC-C Real schemas are quite complex â€¦ Relational Model and Algebra 20 Lesson learned â€¢ Is it now clear why it is not a good idea to have to write code for every query and every possible way to organize the data? Relational Model and Algebra 21 Relational Algebra Relational Model and Algebra 22 PersNr LectureID Grade 26120 5001 5.0 27550 5001 5.5 26120 5041 5.75 One Instance: Tests PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Professor PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture Prerequisite Follow-up 5001 5041 5001 5043 Requires PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Query Q Query is a function that takes as input a DB instance, outputs a new relation. A Query Language consists of a set of functions that you can express in that language. Relational Model and Algebra 23 Relational Algebra: Operators â€¢ Relation Instances are Sets, letâ€™s query it using Set Operations. â€¢ Basic Operators: â€¢ Union: âˆª â€¢ Difference: âˆ’ â€¢ Selection: ğœ â€¢ Projection: Î  â€¢ Cartesian Product: Ã— â€¢ Renaming: ğœŒ â€¢ Join: â‹ˆ â€¢ â€¦ Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 Purchase pid cid store 0 0 A 0 1 B 1 1 C Customer cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Relational Model and Algebra 24 Relational Algebra: Union Product1 pid name price 0 iPhone 110 â–ª Union: âˆª Product2 pid name price 1 Blackberry 120 2 Android 130 â–ª Difference: âˆ’ ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡1 âˆª ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 = pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 ğ‘¥ âˆˆ ğ‘…1 âˆª ğ‘…2 âŸº ğ‘¥ âˆˆ ğ‘…1 âˆ¨ ğ‘¥ âˆˆ ğ‘…2 Product3 pid name price 1 Blackberry 120 0 iPhone 110 ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 âˆ’ ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡3 = pid name price 2 Android 130 ğ‘¥ âˆˆ ğ‘…1 âˆ’ ğ‘…2 âŸº ğ‘¥ âˆˆ ğ‘…1 âˆ§ Â¬(ğ‘¥ âˆˆ ğ‘…2) Not valid if the schema of the two relations does not match â€¢ R(pid, name) âˆª S(pid, title) : CANNOT UNION â€¢ R(pid, name) âˆª S(name, pid): OK â€“ Attributes are SETs (order doesnâ€™t matter) Relational Model and Algebra 25 Relational Algebra: Intersection â€¢ Intersection: âˆ© ğ‘…1 âˆ© ğ‘…2 = ğ‘…1 âˆ’ (ğ‘…1 âˆ’ ğ‘…2) Product1 pid name price 0 iPhone 110 Product2 pid name price 1 Blackberry 120 2 Android 130 ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 âˆ© ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡3 = pid name price 1 Blackberry 120 Product3 pid name price 1 Blackberry 120 0 iPhone 110 Relational Model and Algebra 26 Relational Algebra: Selection â€¢ Selection: ğœ â€¢ Return tuples which satisfy a given condition ğ‘¥ âˆˆ ğœğ‘ ğ‘… âŸº ğ‘¥ âˆˆ ğ‘… âˆ§ ğ‘ ğ‘¥ = ğ‘‡ğ‘Ÿğ‘¢ğ‘’ Product1 pid name price 0 iPhone 110 Product2 pid name price 1 Blackberry 120 2 Android 130 ğœğ‘ğ‘Ÿğ‘–ğ‘ğ‘’>125ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 = pid name price 2 Android 130 Product3 pid name price 1 Blackberry 120 0 iPhone 110 ğœğ‘›ğ‘ğ‘šğ‘’=â€œğµğ‘™ğ‘ğ‘ğ‘˜ğ‘ğ‘’ğ‘Ÿğ‘Ÿğ‘¦â€ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 = pid name price 1 Blackberry 120 ğœğ‘›ğ‘ğ‘šğ‘’=â€œğµğ‘™ğ‘ğ‘ğ‘˜ğ‘ğ‘’ğ‘Ÿğ‘Ÿğ‘¦â€âˆ§ğ‘ğ‘Ÿğ‘–ğ‘ğ‘’>125ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 = pid name price Relational Model and Algebra 27 Relational Algebra: Projection â€¢ Projection: Î ğ´1,â€¦,ğ´ğ‘›(ğ‘…) â€¢ Only keep a subset of columns Product1 pid name price 0 iPhone 110 Product2 pid name price 1 Blackberry 120 2 Android 130 Î ğ‘ğ‘–ğ‘‘,ğ‘›ğ‘ğ‘šğ‘’ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡2 = pid name 2 Android 1 Blackberry Product3 pid name price 1 Blackberry 120 0 iPhone 110 Recall that Relation is a SET. So there is no ordering between pid=1 and pid=2! Relational Model and Algebra 28 Relational Algebra: cartesian product â€¢ Cartesian Product: Ã— â€¢ Mainly used to express joins ğ‘¥, ğ‘¦ âˆˆ ğ‘…1 Ã— ğ‘…2 âŸº ğ‘¥ âˆˆ ğ‘…1 âˆ§ ğ‘¦ âˆˆ ğ‘…2 ğ¶ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘’ğ‘Ÿ Ã— ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’ = pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer cid1 name city pid cid2 store 0 John Zurich 0 0 A 1 Anna Munich 0 0 A 2 Kevin Geneva 0 0 A 0 John Zurich 0 1 B 1 Anna Munich 0 1 B 2 Kevin Geneva 0 1 BWhatâ€™s the key of the output relation? (cid1, pid, cid2) â€“ Why? Relational Model and Algebra 29 Relational Algebra: renaming â€¢ Renaming: ğœŒğµ1,â€¦,ğµğ‘›(ğ‘…) â€¢ Change the name of the attributes of ğ‘… to ğµ1, â€¦ , ğµğ‘› ğœŒğ‘,ğ‘,ğ‘ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’ = pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer a b c 0 0 A 0 1 B Only the names of the attributes changed! E.g., Can be used such that when you do Cartesian Product the name of the attributes donâ€™t repreat. Relational Model and Algebra 30 Relational Algebra: Natural join (inner) â€¢ Natural Join: â‹ˆ ğ‘…1(ğ´, ğµ) â‹ˆ ğ‘…2 (ğµ, ğ¶) = Î ğ´,ğµ,ğ¶(ğœğ‘…1.ğµ=ğ‘…2.ğµ ğ‘…1 Ã— ğ‘…2 ) â€¢ Step 1 Selection â€“ check equality on all common attributes â€¢ Step 2 Projection â€“ eliminate duplicated common attributes ğ¶ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘’ğ‘Ÿ â‹ˆ ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’ = pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer cid name city pid store 0 John Zurich 0 A 1 Anna Munich 0 B Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 (ğ¶ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘’ğ‘Ÿ â‹ˆ ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’) â‹ˆ ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡ = cid name city pid store name price 0 John Zurich 0 A iPhone 110 1 Anna Munich 0 B iPhone 110 Relational Model and Algebra 31 Relational Algebra: Natural join â€¢ Natural Join: â‹ˆ ğ‘…1(ğ´, ğµ) â‹ˆ ğ‘…2 (ğµ, ğ¶) = Î ğ´,ğµ,ğ¶(ğœğ‘…1.ğµ=ğ‘…2.ğµ ğ‘…1 Ã— ğ‘…2 ) â€¢ Corner Cases: â€¢ ğ‘… ğ´, ğµ, ğ¶ , ğ‘†(ğ·, ğ¸) [No shared attributes] ğ‘… â‹ˆ ğ‘† = ğ‘… Ã— ğ‘† â€¢ ğ‘… ğ´, ğµ, ğ¶ , ğ‘† ğ´, ğµ, ğ¶ [Share all attributes] ğ‘… â‹ˆ ğ‘† = ğ‘… âˆ© ğ‘† pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 Relational Model and Algebra 32 Relational Algebra: join variations â€¢ Theta Join: â‹ˆğœƒ: ğ‘…1 â‹ˆğœƒ ğ‘…2 = ğœğœƒ ğ‘…1 Ã— ğ‘…2 â€¢ Equi-Join: ğ‘…1 â‹ˆğ´=ğµ ğ‘…2 = ğœğ´=ğµ ğ‘…1 Ã— ğ‘…2 â€¢ There are moreâ€¦ â€¢ Outer-join â€¢ Left join â€¢ Right join â€¢ We will talk about them later! (We are missing some concepts to talk about them) pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 Relational Model and Algebra 33 pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 Relational Algebra: writing queries â€¢ Relational Algebra expression â€¢ Q: Cutomers who bought an iPhone â€¢ Î ğ‘ğ‘–ğ‘‘ğœğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡.ğ‘›ğ‘ğ‘šğ‘’=ğ‘–ğ‘ƒâ„ğ‘œğ‘›ğ‘’((ğ¶ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘’ğ‘Ÿ â‹ˆ ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’) â‹ˆ ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡) â‹ˆ ğ¶ğ‘¢ğ‘ ğ‘¡ğ‘œğ‘šğ‘’ğ‘Ÿ ğ‘ƒğ‘¢ğ‘Ÿğ‘â„ğ‘ğ‘ ğ‘’ â‹ˆ ğ‘ƒğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡ Î  The output of each intermediate node is a relation. Relational Model and Algebra 34 Relational Algebra: relational division â€¢ Q: Find students who take all lectures. â€¢ We can already express this query using what we already know. â€¢ ğ´ğ‘™ğ‘™ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ = Î ğ‘ ğ‘–ğ‘‘ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  â€¢ ğ‘€ğ‘–ğ‘ ğ‘ ğ‘–ğ‘›ğ‘”ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ = ğ´ğ‘™ğ‘™ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ Ã— ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ âˆ’ ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  â€¢ ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ğ‘€ğ‘–ğ‘ ğ‘ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ‘  = Î ğ‘ ğ‘–ğ‘‘ğ‘€ğ‘–ğ‘ ğ‘ ğ‘–ğ‘›ğ‘”ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ â€¢ ğ‘„ = ğ´ğ‘™ğ‘™ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ âˆ’ ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ğ‘€ğ‘–ğ‘ ğ‘ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ‘  â€¢ There is a shorter version of this: ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  Ã· ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ â€¢ We call this operator Relational Divison sid lecture 0 A 0 B 0 C 1 B 2 A 2 C lecture A B C Attends Lecture Relational Model and Algebra 35 Relational Algebra â€“ Relational division â€¢ We call this operator Relational Divison: ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  Ã· ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ â€¢ What is divison? Inverse of Multiplication. â€¢ ğ‘… Ã· ğ‘† = ğ‘‡: ğ‘‡ is the largest relation such that ğ‘† Ã— ğ‘‡ âŠ† ğ‘…. â€¢ ğ‘… Ã· ğ‘† = Î ğ‘…âˆ’ğ‘†ğ‘… âˆ’ Î ğ‘…âˆ’ğ‘† (Î ğ‘…âˆ’ğ‘†ğ‘… Ã— ğ‘† âˆ’ ğ‘…) sid lecture 0 A 0 B 0 C 1 B 2 A 2 C lecture A B C Attends Lecture Attends Ã· Lecture = all sid in â€œAttendsâ€ who have attended all lectures in â€œLectureâ€ Relational Model and Algebra 36 Relational Algebra: semi-join â€¢ Semi-Join: ğ‘…1 â‹‰ğ¶ ğ‘…2 (returns columns only from one side if there is a match in the join) â€¢ ğ‘…1 ğ´1, â€¦ , ğ´ğ‘› , ğ‘…2(ğµ1, â€¦ , ğµğ‘š) â€¢ ğ‘…1 â‹‰ğ¶ ğ‘…2 = Î ğ´1,â€¦,ğ´ğ‘›(ğ‘…1 â‹ˆğ¶ ğ‘…2) â€¢ One useful trick called â€œsemi-join reductionâ€, especially useful in distributed DB. â€¢ Join ğ‘…(ğ´, ğµ) with ğ‘† ğµ, ğ¶ on ğµ; R and S are on different machines. â€¢ ğ‘… â‹ˆ ğ‘† = (ğ‘… â‹‰ Î ğµğ‘†) â‹ˆ ğ‘† pid cid store 0 0 A 0 1 B cid name city 0 John Zurich 1 Anna Munich 2 Kevin Geneva Purchase Customer Product pid name price 0 iPhone 110 1 Blackberry 120 2 Android 130 Send what matters in S to R Send what matters in R to S Save communications between different machines, compared with sending the whole S to R or sending the whole R to S Relational Model and Algebra 37 PersNr LectureID Grade 26120 5001 5.0 27550 5001 5.5 26120 5041 5.75 DB Instance Tests PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Professor PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture Prerequisite Follow-up 5001 5041 5001 5043 Requires PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Q. All Students who take Databases Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿğœğ‘‡ğ‘–ğ‘¡ğ‘™ğ‘’=â€œğ·ğ‘ğ‘¡ğ‘ğ‘ğ‘ğ‘ ğ‘’â€( ) ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  â‹ˆ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’) ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  â‹ˆ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ PersNr Name Sem. LectureID 26120 Frey 2 5001 26120 Frey 2 5041 PersN r Name Se m. Lectur eID Title C P Prof Nr 26120 Frey 2 5001 Databases 4 2125 26120 Frey 2 5041 Networks 4 2126 PersNr 26120 Relational Model and Algebra 38 PersNr LectureID Grade 26120 5001 5.0 27550 5001 5.5 26120 5041 5.75 DB Instance Tests PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Professor PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture Prerequisite Follow-up 5001 5041 5001 5043 Requires PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Q. Profs who donâ€™t teach. Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿ ğ‘ƒğ‘Ÿğ‘œğ‘“ğ‘’ğ‘ ğ‘ ğ‘œğ‘Ÿ â‹ˆğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿ=ğ‘ƒğ‘Ÿğ‘œğ‘“ğ‘ğ‘Ÿ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ PersNr PersNr 2125 2126 2127 Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿğ‘ƒğ‘Ÿğ‘œğ‘“ğ‘’ğ‘ ğ‘ ğ‘œğ‘Ÿ âˆ’ Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿ ğ‘ƒğ‘Ÿğ‘œğ‘“ğ‘’ğ‘ ğ‘ ğ‘œğ‘Ÿ â‹ˆğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿ=ğ‘ƒğ‘Ÿğ‘œğ‘“ğ‘ğ‘Ÿ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ First get all profs who teach: Relational Model and Algebra 39 PersNr LectureID Grade 26120 5001 3.0 27550 5001 5.5 26120 5041 5.75 DB Instance Tests PersNr Name Level Room 2125 John AP 226 2126 David FP 232 2127 Anna FP 310 Professor PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture Prerequisite Follow-up 5001 5041 5001 5043 Requires PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿ,ğ¹ğ‘œğ‘™ğ‘™ğ‘œğ‘¤âˆ’ğ‘¢ğ‘(àµ« àµ¯ ğœğºğ‘Ÿğ‘ğ‘‘ğ‘’<4.0( ) ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ‘‡ğ‘’ğ‘ ğ‘¡ğ‘  â‹ˆğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ¼ğ·=ğ‘ƒğ‘Ÿğ‘’ğ‘Ÿğ‘’ğ‘ğ‘¢ğ‘–ğ‘ ğ‘–ğ‘¡ğ‘’ ğ‘…ğ‘’ğ‘ğ‘¢ğ‘–ğ‘Ÿğ‘’ğ‘ ) ğœğºğ‘Ÿğ‘ğ‘‘ğ‘’<4.0 ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ‘‡ğ‘’ğ‘ ğ‘¡ğ‘  PersNr Name Sem. LectureID Grade 26120 Frey 2 5001 3.0 àµ« àµ¯ ğœğºğ‘Ÿğ‘ğ‘‘ğ‘’<4.0( ) ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ‘‡ğ‘’ğ‘ ğ‘¡ğ‘  â‹ˆğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ¼ğ·=ğ‘ƒğ‘Ÿğ‘’ğ‘Ÿğ‘’ğ‘ğ‘¢ğ‘–ğ‘ ğ‘–ğ‘¡ğ‘’ ğ‘…ğ‘’ğ‘ğ‘¢ğ‘–ğ‘Ÿğ‘’ğ‘ ) PersN r Name Se m. LectureID Grade Follo w-up 26120 Frey 2 5001 3.0 5041 26120 Frey 2 5001 3.0 5043 PersNr Follow-up 26120 5041 26120 5043 Relational Model and Algebra 40 â–ª Not Declarative â¢ There are different ways to implement the same query Query Language 1: Relational Algebra Q. All Students who take Database. Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿğœğ‘‡ğ‘–ğ‘¡ğ‘™ğ‘’=â€œğ·ğ‘ğ‘¡ğ‘ğ‘ğ‘ğ‘ ğ‘’â€ ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ â‹ˆ ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘  â‹ˆ ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’) PersNr Name Semester 24002 Peter 8 25403 Mary 6 26120 Frey 2 Student LectureID Title CP ProfNr 5001 Databases 4 2125 5041 Networks 4 2126 5043 Theory 4 2127 Lecture PersNr LectureID 26120 5001 27550 5001 26120 5041 Attends Î ğ‘ƒğ‘’ğ‘Ÿğ‘ ğ‘ğ‘Ÿğœğ‘‡ğ‘–ğ‘¡ğ‘™ğ‘’=â€œğ·ğ‘ğ‘¡ğ‘ğ‘ğ‘ğ‘ ğ‘’â€ ğ‘†ğ‘¡ğ‘¢ğ‘‘ğ‘’ğ‘›ğ‘¡ Ã— ğ¿ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ â‹ˆ ğ´ğ‘¡ğ‘¡ğ‘’ğ‘›ğ‘‘ğ‘ ) Could be very large! â–ª In real-world DB systems, user does NOT write Relational Algebra â€“ We hope to have a query language in which the user does not need to worry about different ways of implementing the same thing â€“ We want the system to figure it out by itself. Relational Model and Algebra 41 Lessons learned â€¢ Relational model defines an abstract representation for the data (attributes, tuples, tables) â€¢ Tables are sets of tuples â€¢ In principle, it does not assign any structure among the tables â€¢ Relational algebra provides a mathematical basis for the operations performed â€¢ Establishes a basic query language with precise meaning â€¢ Enables optimization by reasoning about equivalence of queries Relational Model and Algebra 42","libVersion":"0.3.2","langs":""}