{"path":"sem4/CN/UE/slides/CN-u10-CDN.pdf","text":"Computer Networks - Exercise 10 CDN, Video, SCION ETH Zürich Slides by Ferdinand Brunne and Joël Vögtlin Based on the work of Janic Moser, Severin Obrist and Alice La Porta May 2025 - CDNs - Internet Video - SCION - Kahoot! - Exercise #10 2 Table of contents CDNs - CDN: Content delivery/distribution networks - Goal: Optimize web trafﬁc through: - Caching - Replication 4 CDNs, what are they? - Idea: Cache resources that have been fetched for a client in case they are requested later - How it works: - When a client requests a resource, fetch it and cache it - The resource does not have to be fetched again as long as it is cached - Similar to caching DNS records at the DNS resolvers - Advantages: Browsing speedup and decreased network load - However: Uncacheable content 5 CDNs - Caching - Dynamic data: Weather, stock prices, … - Script results: Can be based on parameters - Using Cookies: Content speciﬁc to a user/session - TLS/QUIC: Encrypted content only accessible by the endpoints - Advertising: Content provider wants to measure number of accesses 6 CDNs - Caching - Uncacheable content Caching can be done at different locations - Client: Browser cache - Close to the destination: - Reverse proxies - Close to the client: - Forward proxies - CDNs 7 CDNs - Caching - Caching locations - Idea: Distribute content across many servers around the world - Why? - Fault tolerance: Multiple points of failure, service works (partially) in case of failure - Load balancing: Distribute requests over multiple servers - Optimized latency: Requests directed to the “closest” server - Increased efﬁciency: No data transmission across the globe - How this works: - Spread the content servers globally - Create a network for all your servers and the origin - Direct the clients to the appropriate servers 8 CDNs - Replication - Where do you place the servers? → At Internet Exchange Points (where ISPs and CDNs connect with each other) - How do you connect the servers with each other? 1. Private network: Full control, predictable but very expensive 2. Internet: Simple, cheap but unpredictable (paths and bandwidth) - How do you redirect clients? 1. DNS-Based: CDNs’ DNS server returns different IP depending on the local resolver’s location + High control, quick changes - Complicated, issues if clients don’t use their local resolver 2. BGP-Anycast-Based: Advertise same IP from different locations, closest is found by BGP + Simple - Less precise control, longer reconﬁguration times 9 CDNs - Replication - In more detail - Problem: Internet routing is unpredictable and governed by economic incentives, not performance 10 CDNs - Replication - Overlay routing - Possible solution: Overlay routing - Find intermediate location x and forward trafﬁc through there - Can achieve lower latency and loss Internet Video - 82% of all network trafﬁc - Goal: Maximal video quality without re-buffering - Common solution: - Encode video in multiple bitrates - Replicate using a CDN - Video player picks bitrate adaptively: 1. Estimate the available bandwidth 2. Pick a bitrate ≤ available bandwidth 12 Internet Video - Videos are encoded at multiple bitrates and split into chunks 13 Internet Video - Chunks and adaptation - Buffer based adaptation: - If buffer is close to empty: Choose low bitrate - If buffer is close to full: Choose high bitrate SCION - Stateless packet forwarding (no inconsistent forwarding state) - “Instant convergence” routing - Path-aware networking (Source knows that path of the packet) - Multi-path networking - Formal veriﬁcation => High security - Sovereignty and transparency for trust root 15 SCION Architecture Principles 16 SCION Architecture Principles - Fault Isolation Domain(ISD): grouping of ASes - ISD core: ASes that manage the ISD - Core AS: AS that is part of the ISD core - TRC: Trust Root Conﬁguration (Deﬁnes cryptographic root keys for an ISD) 17 Overview: Fault Isolation Domain (ISD) - Core ASes sends PCBs (Pathsegment Construction Beacons) that traverse the ISD as a ﬂood and collect information on their way. - Each AS receives multiple PCBs representing a path segment to a core AS - Down-path segment From core AS to AS (e.g. L -> S) Path segments can be reversed - Up-path segment From As to core AS (e.g. S -> L) 18 Up-Path and Down-Path Segments - Request path segment to <ISD, AS> from local path server - If the path segments are not locally cached, the local path server sends a request to core path server - If the core path server does not have path segments cached, it will contact a remote core path server - Local path server replies: Up-path segments to local ISD core ASes Down-path segments to <ISD,AS> Core-path segments as needed 19 Path Lookup: Local ISD 20 Example: FS22, Question 43 10 Up-path segment 9 Down-path segment 8 Core-path segment 7 Provider-customer link 6 Core link 5 Peering link 4 Non-core AS 3 Core AS 2 ISD Core 1 ISD KahootExercise #10 Question 1: CDNs 23 1) Anycast-based CDNs have greater ﬂexibility in load management than DNS-based ones. FALSE. Using a DNS-based CDNs allows the operator to choose which IP address to serve back to a requester of a hostname (and thus has greater ﬂexibility). DNS-based CDNs work by conﬁguring different DNS records at different DNS servers for the same IP address. When a user requests a ﬁle by resolving a URL with the speciﬁc domain name the different DNS records direct the user to the desired hosts. Load balancing of Anycast-based CDNs is at the mercy of the (BGP) routing at ISP-level. This works by multiple hosts announcing the same IP preﬁx and hoping for good load balancing by the BGP longest preﬁx matching. Question 1: CDNs 24 2) Exclusively-anycast-based services may resolve the same domain name to different IP addresses for different clients. FALSE. DNS-based CDNs enable the freedom to choose for each client which IP address the name request resolves to. Anycast-based means that all the client get the same IP address, and that the routing from the client using this IP address then potentially will lead to another host. Question 1: CDNs 25 3) For DNS-based CDNs, the content provider must dynamically rewrite URLs for each client request. FALSE. The rewriting is not done dynamically for each client request, but statically at the server. Each client is served the same HTML with URLs for CDN-hosted objects already rewritten. Question 2: Video Streaming 26 Assume you are watching a video on Netﬂix, and your buffer contains 30s of unplayed video when the player starts to download chunk X. Assume chunk X to be 1.4MB and 4s long, your link bandwidth to be 1Mbps and the RTT between you and Netﬂix CDN to be of 50ms. Assume that downloading chunk X contains sending a request (with tiny size) and receiving the data. All other delays are negligible. Assume that the player is using a single persistent TCP connection to download the segments. 1.a) Do you experience rebuffering? 1.b) If not, how many seconds of unplayed video will your buffer contain after the download of chunk X? Question 2: Video Streaming 27 Buffer contains 30s Assume chunk X to be 1.4MB and 4s long, your link bandwidth to be 1Mbps and the RTT between you and Netﬂix CDN to be of 50ms. 1.a) Do you experience rebuffering? We experience no rebuffering. Question 2: Video Streaming 28 Buffer contains 30s Assume chunk X to be 1.4MB and 4s long, your link bandwidth to be 1Mbps and the RTT between you and Netﬂix CDN to be of 50ms. 1.b) If not, how many seconds of unplayed video will your buffer contain after the download of chunk X? Question 2: Video Streaming 29 Assume now that the chunk size of segment X in KB is ∼ Poisson(3700KB), meaning that the chunk size follows a discrete distribution with granularity of 1KB. 2) What is the probability of rebuffering? Question 3: Video Streaming 30 1) Video resolution is a synonym of video bitrate. FALSE. The bitrate is the amount of encoded video data sent from the server to the client. The resulting resolution is determined by the quality of encoding and the device context (i.e. screen size, DPI). Question 3: Video Streaming 31 2) In video streaming, the entire content is usually provided as a single continuous ﬂow of bytes at once. FALSE. Usually the video is divided into video segments (\"chunks\") that are provided separately. Question 3: Video Streaming 32 3) Adaptation algorithms may vary depending on users' devices. TRUE. Video buffer size can vary across devices. A device with a large buffer may beneﬁt from a different algorithm (or at least a differently tuned algorithm) than one with a very small buffer. Different network patterns occur in different environments, for example a mobile environment is different from a home TV. Depending on the device, there might be different requirements in terms of the so called Quality of Experience (e.g. HDTV users might need a higher video quality in comparison to mobile users for the same QoE). Question 3: Video Streaming 33 4) Usually, all chunks of a particular video content are stored exclusively on a single server. FALSE. To enable load balancing, redundancy and fault tolerance, video content is replicated across multiple servers. Question 3: Video Streaming 34 5) Video chunks duration is typically in the order of seconds. True. The video is divided into chunks to allow bitrate adaptation. Network condition changes, and the ability to detect and respond to them, happen on the granularity of seconds. Question 3: Video Streaming 35 6) Video providers usually geographically replicate their video content. True. By means of CDNs, providers aim to reduce the end to end latency within end users and to be more fault-tolerant. Question 4: Video Chunk Size 36 1) In VOD (Video-On-Demand) video streaming, video is divided into chunks of equal length. Discuss brieﬂy what is the tradeoff between short and long video chunks. Too short video chunks: ● might overload the server with tons of HTTP requests ● Might also increase the frequency of key frames, increasing the chunk size in bytes and becoming then less efﬁcient. ● one can make ﬁne-grained decisions as the bandwidth ﬂuctuates, being quicker in adapting its rate Question 4: Video Chunk Size 37 1) In VOD (Video-On-Demand) video streaming, video is divided into chunks of equal length. Discuss brieﬂy what is the tradeoff between short and long video chunks. Too long video chunks: ● reduce the risk of frequent quality switches ● having less reactivity to bandwidth ﬂuctuations and higher risk of rebuffering. ● In fact, in the DASH architecture, a chunk is playable once it has been completely downloaded. Imagine a corner case, i.e. we use a single chunk for the whole video: we would have to wait until the whole video is downloaded before playing it! Question 5: Adapting Video Quality 38 1) You are starting your brand new video streaming service. Should you deploy the logic for adapting video quality over time on the client or on the server? Discuss pros and cons. Client-side: ● The client player has direct access to its state variable (e.g. buffer) and it can easily estimate it's current download bandwidth. Server-side: ● If a server would have to take care by itself of these decisions for all of its clients (potentially millions), the amount of resources allocated for this purpose would be non-negligible. ● The proprietary logic of the provider is more protected and can't be easily reverse engineered.","libVersion":"0.5.0","langs":""}