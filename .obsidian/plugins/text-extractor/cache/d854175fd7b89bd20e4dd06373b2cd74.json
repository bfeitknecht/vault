{"path":"sem2/DDCA/VRL/slides/DDCA-L23a-memory-organization.pdf","text":"Digital Design & Computer Arch. Lecture 23a: Memory Organization & Technology Mohammad Sadrosadati Frank K. Gürkaynak (Lecture by Ataberk Olgun) ETH Zürich Spring 2024 23 May 2024 Memory Is Critical for Computing (Recall) Memory Is Critical for Computing n Performance n Energy n Reliability n Security & Safety n Cost n Form Factor n Quality of Service & Predictability n Sustainability n … 3 (Recall) Ideal Memory n Zero access time (latency) n Infinite capacity n Zero cost n Infinite bandwidth (to support multiple accesses in parallel) n Zero energy 4 (Recall) How Can We Store Data? n Flip-Flops (or Latches) q Very fast q Very expensive (one bit costs tens of transistors) n Static RAM (SRAM) q Relatively fast q Expensive (one bit costs 6+ transistors) n Dynamic RAM (DRAM) q Slower, reading and charge leakage destroys content (refresh), needs special process for manufacturing (due to capacitor) q Cheap (one bit costs only one transistor plus one capacitor) n Other storage technology (flash memory, hard disk, tape) q Much slower, special manufacturing needed, non-volatile q Very cheap (one transistor stores many bits or no transistors involved) 5 Array Organization of Memories n Goal: Efficiently store large amounts of data q A memory array (stores data) q Address selection logic (selects one row of the array) q Readout circuitry (reads data out) n An M-bit value can be read or written at each unique N-bit address q All values can be accessed, but only M-bits at a time q Access restriction allows more compact organization Address Data Array N M 6 (Recall) Building Larger Memories n Requires larger memory arrays n Large à slow n How do we make the memory large without making it too slow? n Idea: Divide the memory into smaller arrays and interconnect the arrays to input/output buses q Large memories are hierarchical array structures q DRAM: Channel à Rank à Bank à Subarrays à Mats 7 (Recall) Generalized Memory Structure 8 (Recall) Generalized Memory Structure 9 Kim+, “A Case for Exploiting Subarray-Level Parallelism in DRAM,” ISCA 2012. Lee+, “Decoupled Direct Memory Access,” PACT 2015. Cutting Edge: 3D-Stacking of Memory & Logic 10 Logic Memory Other “True 3D” technologies under development The DRAM Subsystem A Top-Down View DRAM Subsystem Organization n Channel n DIMM n Rank n Chip n Bank n Row/Column 12 The DRAM Subsystem Memory channel Memory channel DIMM (Dual in-line memory module) Processor “Channel” 13 Breaking down a DIMM (module) DIMM (Dual in-line memory module) Side view Front of DIMM Back of DIMM 14 Breaking down a DIMM (module) DIMM (Dual in-line memory module) Side view Front of DIMM Back of DIMM Rank 0: collection of 8 chips Rank 1 15 Rank Rank 0 (Front) Rank 1 (Back) Data <0:63>CS <0:1>Addr/Cmd <0:63><0:63> Memory channel 16 Breaking down a Rank Rank 0 <0:63>Chip 0Chip 1Chip 7. . .<0:7><8:15><56:63> Data <0:63> 17 Breaking down a ChipChip 0<0:7>8 banks Bank 0 <0:7> <0:7> <0:7> ...<0:7> 18 Breaking down a Bank Bank 0<0:7>row 0 row 32k-1... 2kB 1B 1B (column) 1B Row-buffer 1B ...<0:7> 19 Digging Deeper: DRAM Bank Operation 20 Row Buffer (Row 0, Column 0)Row decoder Column mux Row address 0 Column address 0 Data Row 0Empty (Row 0, Column 1) Column address 1 (Row 0, Column 85) Column address 85 (Row 1, Column 0) HITHIT Row address 1 Row 1 Column address 0 CONFLICT ! ColumnsRows Access Address: This view of a bank is an abstraction. Internally, a bank consists of many cells (transistors & capacitors) and other structures that enable access to cells A DRAM Bank Internally Has Sub-Banks 21Kim et al., “A Case for Exploiting Subarray-Level Parallelism in DRAM,” ISCA 2012. Another View of a DRAM Bank 22Seshadri+, “In-DRAM Bulk Bitwise Execution Engine,” ADCOM 2020. Logical Abstraction Physical View More on DRAM Basics & Organization n Vivek Seshadri and Onur Mutlu, \"In-DRAM Bulk Bitwise Execution Engine\" Invited Book Chapter in Advances in Computers, 2020. [Preliminary arXiv version] 23 See Section 2 for comprehensive DRAM Background https://arxiv.org/pdf/1905.09822.pdf DRAM Subsystem Organization n Channel n DIMM n Rank n Chip n Bank n Row/Column 24 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Channel 0 DIMM 0 Rank 0 Mapped to 25 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> . . . 26 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> Row 0 Col 0 . . . 27 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> 8B Row 0 Col 0 . . . 8B 28 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> 8B Row 0 Col 1 . . . 29 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> 8B 8B Row 0 Col 1 . . . 8B 30 Example: Transferring a cache block 0xFFFF…F 0x00 0x40... 64B cache block Physical memory space Rank 0 Chip 0 Chip 1 Chip 7<0:7><8:15><56:63> Data <0:63> 8B 8B Row 0 Col 1 A 64B cache block takes 8 I/O cycles to transfer. During the process, 8 columns are read sequentially. . . . 31 Memory Technology: DRAM and SRAM Memory Technology: DRAM n Dynamic random access memory n Capacitor charge state indicates stored value q Whether the capacitor is charged or discharged indicates storage of 1 or 0 q 1 capacitor q 1 access transistor n Capacitor leaks through the RC path q DRAM cell loses charge over time q DRAM cell needs to be refreshed 33 row enablebitline Accessing a DRAM Cell Sense\t Ampenable bitline wordline capacitor access\t transistor bitline [Seshadri+\tMICRO’17] Accessing a DRAM Cell ½\tVDD\t+\tδ enable bitline wordline capacitor access\t transistor ½\tVDDVDD enable\t wordline enable\t sense\tamp connects\tcell\t to\tbitline cell\tloses\tcharge\t to\tbitline cell\tcharge\t restored Sense\t Amp deviation\tin\t bitline\tvoltage ½\tVDD0 bitline [Seshadri+\tMICRO’17] 1 2 3 4 5 6 n Static random access memory n Two cross coupled inverters store a single bit q Feedback path enables the stored value to stay in the “cell” (as long as powered on) q 4 transistors for storage q 2 transistors for access Memory Technology: SRAM 36 row enablebitline_bitline Memory Bank Organization and Operation n Read access sequence: 1. Decode row address & drive word-lines 2. Selected bits drive bit-lines • Entire row read 3. Amplify row data 4. Decode column address & select subset of row • Send to output 5. Precharge bit-lines • For next access 37 SRAM (Static Random Access Memory) 38 bit-cell array 2n row x 2m-col (n»m to minimize overall latency) sense amp and mux 2m diff pairs 2n n m 1 row enablebitline_bitline n+m Read Sequence 1. address decode 2. drive row enable 3. selected bit-cells drive bitlines (entire row is read together) 4. differential sensing and column select (data is ready) 5. precharge all bitlines (for next read or write) Access latency dominated by steps 2 and 3 Cycling time dominated by steps 2, 3 and 5 - step 2 proportional to 2m - step 3 and 5 proportional to 2n DRAM (Dynamic Random Access Memory) 39 row enable_bitline bit-cell array 2n row x 2m-col (n»m to minimize overall latency) sense amp and mux 2m 2n n m 1 RAS CAS A DRAM die comprises of multiple such arrays Bit stored as charge on node capacitor (non-restorative) - bit cell loses charge when read - bit cell loses charge over time Read Sequence 1~3 same as SRAM 4. a “flip-flopping” sense amp amplifies and regenerates the bitline, data bit is mux’ed out 5. precharge all bitlines Destructive reads Charge loss over time Refresh: A DRAM controller must periodically read each row within the allowed refresh time (10s of ms) such that charge is restored DRAM vs. SRAM n DRAM q Slower access (capacitor) q Higher density (1T 1C cell) q Lower cost q Requires refresh (power, performance, circuitry) q Manufacturing requires putting capacitor and logic together n SRAM q Faster access (no capacitor) q Lower density (6T cell) q Higher cost q No need for refresh q Manufacturing compatible with logic process (no capacitor) 40 An Aside: Phase Change Memory n Phase change material (chalcogenide glass) exists in two states: q Amorphous: Low optical reflexivity and high electrical resistivity q Crystalline: High optical reflexivity and low electrical resistivity 41 PCM is resistive memory: High resistance (0), Low resistance (1) Lee, Ipek, Mutlu, Burger, “Architecting Phase Change Memory as a Scalable DRAM Alternative,” ISCA 2009. DRAM vs. PCM n DRAM q Faster access (capacitor) q Lower density (capacitor less scalable) à higher cost q Requires refresh (power, performance, circuitry) q Manufacturing requires putting capacitor and logic together q Volatile (loses data at loss of power) q No endurance problems q Lower access energy n PCM q Slower access (heating and cooling based ”phase change” operation) q Higher density (phase change material more scalable) à lower cost q No need for refresh q Manufacturing requires less conventional processes – less mature q Non-volatile (does not lose data at loss of power) q Endurance problems (a cell cannot be used after N writes to it) q Higher access energy 42 PCM-based Main Memory n How should PCM-based (main) memory be organized? n Pure PCM main memory [Lee et al., ISCA’09, Top Picks’10] q How to redesign the system to tolerate PCM shortcomings n Hybrid PCM+DRAM [Qureshi+ ISCA’09, Dhiman+ DAC’09] q How to partition/migrate data between PCM and DRAM 43 Reading: PCM as Main Memory: Idea in 2009 n Benjamin C. Lee, Engin Ipek, Onur Mutlu, and Doug Burger, \"Architecting Phase Change Memory as a Scalable DRAM Alternative\" Proceedings of the 36th International Symposium on Computer Architecture (ISCA), pages 2-13, Austin, TX, June 2009. Slides (pdf) One of the 13 computer architecture papers of 2009 selected as Top Picks by IEEE Micro. Selected as a CACM Research Highlight. 2022 Persistent Impact Prize. 44 Reading: More on PCM As Main Memory n Benjamin C. Lee, Ping Zhou, Jun Yang, Youtao Zhang, Bo Zhao, Engin Ipek, Onur Mutlu, and Doug Burger, \"Phase Change Technology and the Future of Main Memory\" IEEE Micro, Special Issue: Micro's Top Picks from 2009 Computer Architecture Conferences (MICRO TOP PICKS), Vol. 30, No. 1, pages 60-70, January/February 2010. 45 Intel Optane Persistent Memory (2019) n Non-volatile main memory n Based on 3D-XPoint Technology 46 https://www.storagereview.com/intel_optane_dc_persistent_memory_module_pmm Charge vs. Resistive Memories n Charge Memory (e.g., DRAM, Flash) q Write data by capturing charge Q q Read data by detecting voltage V n Resistive Memory (e.g., PCM, STT-MRAM, memristors) q Write data by pulsing current dQ/dt q Read data by detecting resistance R 48 Promising Resistive Memory Technologies n PCM q Inject current to change material phase q Resistance determined by phase n STT-MRAM q Inject current to change magnet polarity q Resistance determined by polarity n Memristors/RRAM/ReRAM q Inject current to change atomic structure q Resistance determined by atom distance 49 More on Emerging Memory Technologies 50https://www.youtube.com/watch?v=AlE1rD9G_YU&list=PL5Q2soXY2Zi9xidyIgBxUz7xRPS-wisBN&index=28 More on Emerging Memory Technologies 51https://www.youtube.com/watch?v=pmLszWGmMGQ&list=PL5Q2soXY2Zi9xidyIgBxUz7xRPS-wisBN&index=29 More on Memory Technologies 52https://www.youtube.com/watch?v=pmLszWGmMGQ&list=PL5Q2soXY2Zi9xidyIgBxUz7xRPS-wisBN&index=29 A Bit on Flash Memory & SSDs n Flash memory was a very “doubtful” emerging technology q for at least two decades 53 Proceedings of the IEEE, Sept. 2017 https://arxiv.org/pdf/1711.11427.pdf A Flash Memory SSD Controller 54 Cai+, “Error Characterization, Mitigation, and Recovery in Flash Memory Based Solid State Drives,” Proc. IEEE 2017. https://arxiv.org/pdf/1711.11427.pdf Lecture on Flash Memory & SSDs 55https://www.youtube.com/watch?v=rninK6KWBeM&list=PL5Q2soXY2Zi9xidyIgBxUz7xRPS-wisBN&index=47 SSD Course (Spring 2023) n Spring 2023 Edition: q https://safari.ethz.ch/projects_and_seminars/spring2023/ doku.php?id=modern_ssds n Fall 2022 Edition: q https://safari.ethz.ch/projects_and_seminars/fall2022/do ku.php?id=modern_ssds n Youtube Livestream (Spring 2023): q https://www.youtube.com/watch?v=4VTwOMmsnJY&list =PL5Q2soXY2Zi_8qOM5Icpp8hB2SHtm4z57&pp=iAQB n Youtube Livestream (Fall 2022): q https://www.youtube.com/watch?v=hqLrd- Uj0aU&list=PL5Q2soXY2Zi9BJhenUq4JI5bwhAMpAp13&p p=iAQB n Project course q Taken by Bachelor’s/Master’s students q SSD Basics and Advanced Topics q Hands-on research exploration q Many research readings 56https://www.youtube.com/onurmutlulectures Lectures on Memory Technologies n Computer Architecture, Fall 2020, Lecture 15 q Emerging Memory Technologies (ETH, Fall 2020) q https://www.youtube.com/watch?v=AlE1rD9G_YU&list=PL5Q2soXY2Zi9xidyIgBxUz 7xRPS-wisBN&index=28 n Computer Architecture, Fall 2020, Lecture 16a q Opportunities & Challenges of Emerging Memory Tech (ETH, Fall 2020) q https://www.youtube.com/watch?v=pmLszWGmMGQ&list=PL5Q2soXY2Zi9xidyIgBx Uz7xRPS-wisBN&index=29 n Computer Architecture, Fall 2020, Lecture 3b q Memory Systems: Challenges & Opportunities (ETH, Fall 2020) q https://www.youtube.com/watch?v=Q2FbUxD7GHs&list=PL5Q2soXY2Zi9xidyIgBxU z7xRPS-wisBN&index=6 57https://www.youtube.com/onurmutlulectures Tutorial on Processing in Memory 58https://www.youtube.com/onurmutlulectures https://www.youtube.com/watch?v=4x9nujJtqjM Processing in Memory Review and Open Problems 59 Onur Mutlu, Saugata Ghose, Juan Gomez-Luna, and Rachata Ausavarungnirun, \"A Modern Primer on Processing in Memory\" Invited Book Chapter in Emerging Computing: From Devices to Systems - Looking Beyond Moore and Von Neumann, Springer, to be published in 2021. https://arxiv.org/pdf/2012.03112.pdf PIM Course (Fall 2022) n Fall 2022 Edition: q https://safari.ethz.ch/projects_and_seminars/fall2022 /doku.php?id=processing_in_memory n Spring 2022 Edition: q https://safari.ethz.ch/projects_and_seminars/spring2 022/doku.php?id=processing_in_memory n Youtube Livestream (Fall 2022): q https://www.youtube.com/watch?v=QLL0wQ9I4Dw& list=PL5Q2soXY2Zi8KzG2CQYRNQOVD0GOBrnKy n Youtube Livestream (Spring 2022): q https://www.youtube.com/watch?v=9e4Chnwdovo&li st=PL5Q2soXY2Zi-841fUYYUK9EsXKhQKRPyX n Project course q Taken by Bachelor’s/Master’s students q Processing-in-Memory lectures q Hands-on research exploration q Many research readings 60 https://www.youtube.com/onurmutlulectures Digital Design & Computer Arch. Lecture 23a: Memory Organization & Technology Mohammad Sadrosadati Frank K. Gürkaynak (Lecture by Ataberk Olgun) ETH Zürich Spring 2024 23 May 2024 Goal: Processing Inside Memory n Many questions … How do we design the: q compute-capable memory & controllers? q processors & communication units? q software & hardware interfaces? q system software, compilers, languages? q algorithms & theoretical foundations? Cache Processor Core Interconnect Memory Database Graphs Media Query Results Micro-architecture SW/HW Interface Program/Language Algorithm Problem Logic Devices System Software Electrons Backup Slides: Inside A DRAM Chip 63 DRAM Module and Chip 64 Goals in DRAM Design • Cost • Latency • Bandwidth • Parallelism • Power • Energy • Reliability • Security • … 65 DRAM Chip 66 Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Sense Amplifier 67 enable top bottom Inverter Sense Amplifier – Two Stable States 68 1 1 0 0VDD VDD Logical “1” Logical “0” Sense Amplifier Operation 69 0 VT VB VT > VB1 0 VDD DRAM Cell – Capacitor 70 Empty State Fully Charged State Logical “0” Logical “1” 1 2 Small – Cannot drive circuits Reading destroys the state Capacitor to Sense Amplifier 71 1 0 VDD 1 VDD 0 DRAM Cell Operation 72 ½VDD ½VDD 01 0 VDD½VDD+δ DRAM Subarray – Building Block for DRAM Chip 73Row DecoderCell Array Cell Array Array of Sense Amplifiers (Row Buffer) 8Kb DRAM Bank 74Row Decoder Array of Sense Amplifiers (8Kb) Cell Array Cell ArrayRow Decoder Array of Sense Amplifiers Cell Array Cell Array Bank I/O (64b)Address Address Data DRAM Chip 75 Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Row DecoderArray of Sense AmplifiersCell ArrayCell Array Row DecoderArray of Sense AmplifiersCell ArrayCell ArrayBank I/O Shared internal bus Memory channel - 8bits DRAM Operation 76Row DecoderRow Decoder Array of Sense Amplifiers Cell Array Cell Array Bank I/O Data 1 2 ACTIVATE Row READ/WRITE Column 3 PRECHARGERow Address Column Address More on DRAM Operation: Section 2 n Vivek Seshadri and Onur Mutlu, \"In-DRAM Bulk Bitwise Execution Engine\" Invited Book Chapter in Advances in Computers, to appear in 2020. [Preliminary arXiv version] 77 https://arxiv.org/pdf/1905.09822.pdf See Section 2 for comprehensive DRAM Background","libVersion":"0.3.2","langs":""}